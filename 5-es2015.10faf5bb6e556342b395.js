(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"0ERz":function(module,exports,__webpack_require__){var QRCode;module.exports=function(){function QR8bitByte(data){this.mode=QRMode.MODE_8BIT_BYTE,this.data=data,this.parsedData=[];for(var i=0,l=this.data.length;i<l;i++){var byteArray=[],code=this.data.charCodeAt(i);code>65536?(byteArray[0]=240|(1835008&code)>>>18,byteArray[1]=128|(258048&code)>>>12,byteArray[2]=128|(4032&code)>>>6,byteArray[3]=128|63&code):code>2048?(byteArray[0]=224|(61440&code)>>>12,byteArray[1]=128|(4032&code)>>>6,byteArray[2]=128|63&code):code>128?(byteArray[0]=192|(1984&code)>>>6,byteArray[1]=128|63&code):byteArray[0]=code,this.parsedData.push(byteArray)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function QRCodeModel(typeNumber,errorCorrectLevel){this.typeNumber=typeNumber,this.errorCorrectLevel=errorCorrectLevel,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}QR8bitByte.prototype={getLength:function(buffer){return this.parsedData.length},write:function(buffer){for(var i=0,l=this.parsedData.length;i<l;i++)buffer.put(this.parsedData[i],8)}},QRCodeModel.prototype={addData:function(data){var newData=new QR8bitByte(data);this.dataList.push(newData),this.dataCache=null},isDark:function(row,col){if(row<0||this.moduleCount<=row||col<0||this.moduleCount<=col)throw new Error(row+","+col);return this.modules[row][col]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(test,maskPattern){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var row=0;row<this.moduleCount;row++){this.modules[row]=new Array(this.moduleCount);for(var col=0;col<this.moduleCount;col++)this.modules[row][col]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(test,maskPattern),this.typeNumber>=7&&this.setupTypeNumber(test),null==this.dataCache&&(this.dataCache=QRCodeModel.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,maskPattern)},setupPositionProbePattern:function(row,col){for(var r=-1;r<=7;r++)if(!(row+r<=-1||this.moduleCount<=row+r))for(var c=-1;c<=7;c++)col+c<=-1||this.moduleCount<=col+c||(this.modules[row+r][col+c]=0<=r&&r<=6&&(0==c||6==c)||0<=c&&c<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=c&&c<=4)},getBestMaskPattern:function(){for(var minLostPoint=0,pattern=0,i=0;i<8;i++){this.makeImpl(!0,i);var lostPoint=QRUtil.getLostPoint(this);(0==i||minLostPoint>lostPoint)&&(minLostPoint=lostPoint,pattern=i)}return pattern},createMovieClip:function(target_mc,instance_name,depth){var qr_mc=target_mc.createEmptyMovieClip(instance_name,depth);this.make();for(var row=0;row<this.modules.length;row++)for(var y=1*row,col=0;col<this.modules[row].length;col++){var x=1*col;this.modules[row][col]&&(qr_mc.beginFill(0,100),qr_mc.moveTo(x,y),qr_mc.lineTo(x+1,y),qr_mc.lineTo(x+1,y+1),qr_mc.lineTo(x,y+1),qr_mc.endFill())}return qr_mc},setupTimingPattern:function(){for(var r=8;r<this.moduleCount-8;r++)null==this.modules[r][6]&&(this.modules[r][6]=r%2==0);for(var c=8;c<this.moduleCount-8;c++)null==this.modules[6][c]&&(this.modules[6][c]=c%2==0)},setupPositionAdjustPattern:function(){for(var pos=QRUtil.getPatternPosition(this.typeNumber),i=0;i<pos.length;i++)for(var j=0;j<pos.length;j++){var row=pos[i],col=pos[j];if(null==this.modules[row][col])for(var r=-2;r<=2;r++)for(var c=-2;c<=2;c++)this.modules[row+r][col+c]=-2==r||2==r||-2==c||2==c||0==r&&0==c}},setupTypeNumber:function(test){for(var bits=QRUtil.getBCHTypeNumber(this.typeNumber),i=0;i<18;i++){var mod=!test&&1==(bits>>i&1);this.modules[Math.floor(i/3)][i%3+this.moduleCount-8-3]=mod}for(i=0;i<18;i++)mod=!test&&1==(bits>>i&1),this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=mod},setupTypeInfo:function(test,maskPattern){for(var bits=QRUtil.getBCHTypeInfo(this.errorCorrectLevel<<3|maskPattern),i=0;i<15;i++){var mod=!test&&1==(bits>>i&1);i<6?this.modules[i][8]=mod:i<8?this.modules[i+1][8]=mod:this.modules[this.moduleCount-15+i][8]=mod}for(i=0;i<15;i++)mod=!test&&1==(bits>>i&1),i<8?this.modules[8][this.moduleCount-i-1]=mod:i<9?this.modules[8][15-i-1+1]=mod:this.modules[8][15-i-1]=mod;this.modules[this.moduleCount-8][8]=!test},mapData:function(data,maskPattern){for(var inc=-1,row=this.moduleCount-1,bitIndex=7,byteIndex=0,col=this.moduleCount-1;col>0;col-=2)for(6==col&&col--;;){for(var c=0;c<2;c++)if(null==this.modules[row][col-c]){var dark=!1;byteIndex<data.length&&(dark=1==(data[byteIndex]>>>bitIndex&1)),QRUtil.getMask(maskPattern,row,col-c)&&(dark=!dark),this.modules[row][col-c]=dark,-1==--bitIndex&&(byteIndex++,bitIndex=7)}if((row+=inc)<0||this.moduleCount<=row){row-=inc,inc=-inc;break}}}},QRCodeModel.PAD0=236,QRCodeModel.PAD1=17,QRCodeModel.createData=function(typeNumber,errorCorrectLevel,dataList){for(var rsBlocks=QRRSBlock.getRSBlocks(typeNumber,errorCorrectLevel),buffer=new QRBitBuffer,i=0;i<dataList.length;i++){var data=dataList[i];buffer.put(data.mode,4),buffer.put(data.getLength(),QRUtil.getLengthInBits(data.mode,typeNumber)),data.write(buffer)}var totalDataCount=0;for(i=0;i<rsBlocks.length;i++)totalDataCount+=rsBlocks[i].dataCount;if(buffer.getLengthInBits()>8*totalDataCount)throw new Error("code length overflow. ("+buffer.getLengthInBits()+">"+8*totalDataCount+")");for(buffer.getLengthInBits()+4<=8*totalDataCount&&buffer.put(0,4);buffer.getLengthInBits()%8!=0;)buffer.putBit(!1);for(;!(buffer.getLengthInBits()>=8*totalDataCount||(buffer.put(QRCodeModel.PAD0,8),buffer.getLengthInBits()>=8*totalDataCount));)buffer.put(QRCodeModel.PAD1,8);return QRCodeModel.createBytes(buffer,rsBlocks)},QRCodeModel.createBytes=function(buffer,rsBlocks){for(var offset=0,maxDcCount=0,maxEcCount=0,dcdata=new Array(rsBlocks.length),ecdata=new Array(rsBlocks.length),r=0;r<rsBlocks.length;r++){var dcCount=rsBlocks[r].dataCount,ecCount=rsBlocks[r].totalCount-dcCount;maxDcCount=Math.max(maxDcCount,dcCount),maxEcCount=Math.max(maxEcCount,ecCount),dcdata[r]=new Array(dcCount);for(var i=0;i<dcdata[r].length;i++)dcdata[r][i]=255&buffer.buffer[i+offset];offset+=dcCount;var rsPoly=QRUtil.getErrorCorrectPolynomial(ecCount),modPoly=new QRPolynomial(dcdata[r],rsPoly.getLength()-1).mod(rsPoly);for(ecdata[r]=new Array(rsPoly.getLength()-1),i=0;i<ecdata[r].length;i++){var modIndex=i+modPoly.getLength()-ecdata[r].length;ecdata[r][i]=modIndex>=0?modPoly.get(modIndex):0}}var totalCodeCount=0;for(i=0;i<rsBlocks.length;i++)totalCodeCount+=rsBlocks[i].totalCount;var data=new Array(totalCodeCount),index=0;for(i=0;i<maxDcCount;i++)for(r=0;r<rsBlocks.length;r++)i<dcdata[r].length&&(data[index++]=dcdata[r][i]);for(i=0;i<maxEcCount;i++)for(r=0;r<rsBlocks.length;r++)i<ecdata[r].length&&(data[index++]=ecdata[r][i]);return data};for(var QRMode={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},QRErrorCorrectLevel={L:1,M:0,Q:3,H:2},QRUtil={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(data){for(var d=data<<10;QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G15)>=0;)d^=QRUtil.G15<<QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G15);return(data<<10|d)^QRUtil.G15_MASK},getBCHTypeNumber:function(data){for(var d=data<<12;QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G18)>=0;)d^=QRUtil.G18<<QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G18);return data<<12|d},getBCHDigit:function(data){for(var digit=0;0!=data;)digit++,data>>>=1;return digit},getPatternPosition:function(typeNumber){return QRUtil.PATTERN_POSITION_TABLE[typeNumber-1]},getMask:function(maskPattern,i,j){switch(maskPattern){case 0:return(i+j)%2==0;case 1:return i%2==0;case 2:return j%3==0;case 3:return(i+j)%3==0;case 4:return(Math.floor(i/2)+Math.floor(j/3))%2==0;case 5:return i*j%2+i*j%3==0;case 6:return(i*j%2+i*j%3)%2==0;case 7:return(i*j%3+(i+j)%2)%2==0;default:throw new Error("bad maskPattern:"+maskPattern)}},getErrorCorrectPolynomial:function(errorCorrectLength){for(var a=new QRPolynomial([1],0),i=0;i<errorCorrectLength;i++)a=a.multiply(new QRPolynomial([1,QRMath.gexp(i)],0));return a},getLengthInBits:function(mode,type){if(1<=type&&type<10)switch(mode){case QRMode.MODE_NUMBER:return 10;case QRMode.MODE_ALPHA_NUM:return 9;case QRMode.MODE_8BIT_BYTE:case QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+mode)}else if(type<27)switch(mode){case QRMode.MODE_NUMBER:return 12;case QRMode.MODE_ALPHA_NUM:return 11;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+mode)}else{if(!(type<41))throw new Error("type:"+type);switch(mode){case QRMode.MODE_NUMBER:return 14;case QRMode.MODE_ALPHA_NUM:return 13;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+mode)}}},getLostPoint:function(qrCode){for(var moduleCount=qrCode.getModuleCount(),lostPoint=0,row=0;row<moduleCount;row++)for(var col=0;col<moduleCount;col++){for(var sameCount=0,dark=qrCode.isDark(row,col),r=-1;r<=1;r++)if(!(row+r<0||moduleCount<=row+r))for(var c=-1;c<=1;c++)col+c<0||moduleCount<=col+c||0==r&&0==c||dark==qrCode.isDark(row+r,col+c)&&sameCount++;sameCount>5&&(lostPoint+=3+sameCount-5)}for(row=0;row<moduleCount-1;row++)for(col=0;col<moduleCount-1;col++){var count=0;qrCode.isDark(row,col)&&count++,qrCode.isDark(row+1,col)&&count++,qrCode.isDark(row,col+1)&&count++,qrCode.isDark(row+1,col+1)&&count++,0!=count&&4!=count||(lostPoint+=3)}for(row=0;row<moduleCount;row++)for(col=0;col<moduleCount-6;col++)qrCode.isDark(row,col)&&!qrCode.isDark(row,col+1)&&qrCode.isDark(row,col+2)&&qrCode.isDark(row,col+3)&&qrCode.isDark(row,col+4)&&!qrCode.isDark(row,col+5)&&qrCode.isDark(row,col+6)&&(lostPoint+=40);for(col=0;col<moduleCount;col++)for(row=0;row<moduleCount-6;row++)qrCode.isDark(row,col)&&!qrCode.isDark(row+1,col)&&qrCode.isDark(row+2,col)&&qrCode.isDark(row+3,col)&&qrCode.isDark(row+4,col)&&!qrCode.isDark(row+5,col)&&qrCode.isDark(row+6,col)&&(lostPoint+=40);var darkCount=0;for(col=0;col<moduleCount;col++)for(row=0;row<moduleCount;row++)qrCode.isDark(row,col)&&darkCount++;return lostPoint+Math.abs(100*darkCount/moduleCount/moduleCount-50)/5*10}},QRMath={glog:function(n){if(n<1)throw new Error("glog("+n+")");return QRMath.LOG_TABLE[n]},gexp:function(n){for(;n<0;)n+=255;for(;n>=256;)n-=255;return QRMath.EXP_TABLE[n]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},i=0;i<8;i++)QRMath.EXP_TABLE[i]=1<<i;for(i=8;i<256;i++)QRMath.EXP_TABLE[i]=QRMath.EXP_TABLE[i-4]^QRMath.EXP_TABLE[i-5]^QRMath.EXP_TABLE[i-6]^QRMath.EXP_TABLE[i-8];for(i=0;i<255;i++)QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]]=i;function QRPolynomial(num,shift){if(null==num.length)throw new Error(num.length+"/"+shift);for(var offset=0;offset<num.length&&0==num[offset];)offset++;this.num=new Array(num.length-offset+shift);for(var i=0;i<num.length-offset;i++)this.num[i]=num[i+offset]}function QRRSBlock(totalCount,dataCount){this.totalCount=totalCount,this.dataCount=dataCount}function QRBitBuffer(){this.buffer=[],this.length=0}QRPolynomial.prototype={get:function(index){return this.num[index]},getLength:function(){return this.num.length},multiply:function(e){for(var num=new Array(this.getLength()+e.getLength()-1),i=0;i<this.getLength();i++)for(var j=0;j<e.getLength();j++)num[i+j]^=QRMath.gexp(QRMath.glog(this.get(i))+QRMath.glog(e.get(j)));return new QRPolynomial(num,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var ratio=QRMath.glog(this.get(0))-QRMath.glog(e.get(0)),num=new Array(this.getLength()),i=0;i<this.getLength();i++)num[i]=this.get(i);for(i=0;i<e.getLength();i++)num[i]^=QRMath.gexp(QRMath.glog(e.get(i))+ratio);return new QRPolynomial(num,0).mod(e)}},QRRSBlock.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],QRRSBlock.getRSBlocks=function(typeNumber,errorCorrectLevel){var rsBlock=QRRSBlock.getRsBlockTable(typeNumber,errorCorrectLevel);if(null==rsBlock)throw new Error("bad rs block @ typeNumber:"+typeNumber+"/errorCorrectLevel:"+errorCorrectLevel);for(var length=rsBlock.length/3,list=[],i=0;i<length;i++)for(var count=rsBlock[3*i+0],totalCount=rsBlock[3*i+1],dataCount=rsBlock[3*i+2],j=0;j<count;j++)list.push(new QRRSBlock(totalCount,dataCount));return list},QRRSBlock.getRsBlockTable=function(typeNumber,errorCorrectLevel){switch(errorCorrectLevel){case QRErrorCorrectLevel.L:return QRRSBlock.RS_BLOCK_TABLE[4*(typeNumber-1)+0];case QRErrorCorrectLevel.M:return QRRSBlock.RS_BLOCK_TABLE[4*(typeNumber-1)+1];case QRErrorCorrectLevel.Q:return QRRSBlock.RS_BLOCK_TABLE[4*(typeNumber-1)+2];case QRErrorCorrectLevel.H:return QRRSBlock.RS_BLOCK_TABLE[4*(typeNumber-1)+3];default:return}},QRBitBuffer.prototype={get:function(index){var bufIndex=Math.floor(index/8);return 1==(this.buffer[bufIndex]>>>7-index%8&1)},put:function(num,length){for(var i=0;i<length;i++)this.putBit(1==(num>>>length-i-1&1))},getLengthInBits:function(){return this.length},putBit:function(bit){var bufIndex=Math.floor(this.length/8);this.buffer.length<=bufIndex&&this.buffer.push(0),bit&&(this.buffer[bufIndex]|=128>>>this.length%8),this.length++}};var QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];function _getAndroid(){var android=!1,sAgent=navigator.userAgent;if(/android/i.test(sAgent)){android=!0;var aMat=sAgent.toString().match(/android ([0-9]\.[0-9])/i);aMat&&aMat[1]&&(android=parseFloat(aMat[1]))}return android}var svgDrawer=function(){var Drawing=function(el,htOption){this._el=el,this._htOption=htOption};return Drawing.prototype.draw=function(oQRCode){var _htOption=this._htOption,_el=this._el,nCount=oQRCode.getModuleCount();function makeSVG(tag,attrs){var el=document.createElementNS("http://www.w3.org/2000/svg",tag);for(var k in attrs)attrs.hasOwnProperty(k)&&el.setAttribute(k,attrs[k]);return el}Math.floor(_htOption.width/nCount),Math.floor(_htOption.height/nCount),this.clear();var svg=makeSVG("svg",{viewBox:"0 0 "+String(nCount)+" "+String(nCount),width:"100%",height:"100%",fill:_htOption.colorLight});svg.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),_el.appendChild(svg),svg.appendChild(makeSVG("rect",{fill:_htOption.colorLight,width:"100%",height:"100%"})),svg.appendChild(makeSVG("rect",{fill:_htOption.colorDark,width:"1",height:"1",id:"template"}));for(var row=0;row<nCount;row++)for(var col=0;col<nCount;col++)if(oQRCode.isDark(row,col)){var child=makeSVG("use",{x:String(col),y:String(row)});child.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),svg.appendChild(child)}},Drawing.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},Drawing}(),Drawing="svg"===document.documentElement.tagName.toLowerCase()?svgDrawer:"undefined"==typeof CanvasRenderingContext2D?function(){var Drawing=function(el,htOption){this._el=el,this._htOption=htOption};return Drawing.prototype.draw=function(oQRCode){for(var _htOption=this._htOption,_el=this._el,nCount=oQRCode.getModuleCount(),nWidth=Math.floor(_htOption.width/nCount),nHeight=Math.floor(_htOption.height/nCount),aHTML=['<table style="border:0;border-collapse:collapse;">'],row=0;row<nCount;row++){aHTML.push("<tr>");for(var col=0;col<nCount;col++)aHTML.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+nWidth+"px;height:"+nHeight+"px;background-color:"+(oQRCode.isDark(row,col)?_htOption.colorDark:_htOption.colorLight)+';"></td>');aHTML.push("</tr>")}aHTML.push("</table>"),_el.innerHTML=aHTML.join("");var elTable=_el.childNodes[0],nLeftMarginTable=(_htOption.width-elTable.offsetWidth)/2,nTopMarginTable=(_htOption.height-elTable.offsetHeight)/2;nLeftMarginTable>0&&nTopMarginTable>0&&(elTable.style.margin=nTopMarginTable+"px "+nLeftMarginTable+"px")},Drawing.prototype.clear=function(){this._el.innerHTML=""},Drawing}():function(){function _onMakeImage(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}if(this._android&&this._android<=2.1){var factor=1/window.devicePixelRatio,drawImage=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(image,sx,sy,sw,sh,dx,dy,dw,dh){if("nodeName"in image&&/img/i.test(image.nodeName))for(var i=arguments.length-1;i>=1;i--)arguments[i]=arguments[i]*factor;else void 0===dw&&(arguments[1]*=factor,arguments[2]*=factor,arguments[3]*=factor,arguments[4]*=factor);drawImage.apply(this,arguments)}}function _safeSetDataURI(fSuccess,fFail){var self=this;if(self._fFail=fFail,self._fSuccess=fSuccess,null===self._bSupportDataURI){var el=document.createElement("img"),fOnError=function(){self._bSupportDataURI=!1,self._fFail&&self._fFail.call(self)};return el.onabort=fOnError,el.onerror=fOnError,el.onload=function(){self._bSupportDataURI=!0,self._fSuccess&&self._fSuccess.call(self)},void(el.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}!0===self._bSupportDataURI&&self._fSuccess?self._fSuccess.call(self):!1===self._bSupportDataURI&&self._fFail&&self._fFail.call(self)}var Drawing=function(el,htOption){this._bIsPainted=!1,this._android=_getAndroid(),this._htOption=htOption,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=htOption.width,this._elCanvas.height=htOption.height,el.appendChild(this._elCanvas),this._el=el,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return Drawing.prototype.draw=function(oQRCode){var _elImage=this._elImage,_oContext=this._oContext,_htOption=this._htOption,nCount=oQRCode.getModuleCount(),nWidth=_htOption.width/nCount,nHeight=_htOption.height/nCount,nRoundedWidth=Math.round(nWidth),nRoundedHeight=Math.round(nHeight);_elImage.style.display="none",this.clear();for(var row=0;row<nCount;row++)for(var col=0;col<nCount;col++){var bIsDark=oQRCode.isDark(row,col),nLeft=col*nWidth,nTop=row*nHeight;_oContext.strokeStyle=bIsDark?_htOption.colorDark:_htOption.colorLight,_oContext.lineWidth=1,_oContext.fillStyle=bIsDark?_htOption.colorDark:_htOption.colorLight,_oContext.fillRect(nLeft,nTop,nWidth,nHeight),_oContext.strokeRect(Math.floor(nLeft)+.5,Math.floor(nTop)+.5,nRoundedWidth,nRoundedHeight),_oContext.strokeRect(Math.ceil(nLeft)-.5,Math.ceil(nTop)-.5,nRoundedWidth,nRoundedHeight)}this._bIsPainted=!0},Drawing.prototype.makeImage=function(){this._bIsPainted&&_safeSetDataURI.call(this,_onMakeImage)},Drawing.prototype.isPainted=function(){return this._bIsPainted},Drawing.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},Drawing.prototype.round=function(nNumber){return nNumber?Math.floor(1e3*nNumber)/1e3:nNumber},Drawing}();return(QRCode=function(el,vOption){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRErrorCorrectLevel.H},"string"==typeof vOption&&(vOption={text:vOption}),vOption)for(var i in vOption)this._htOption[i]=vOption[i];"string"==typeof el&&(el=document.getElementById(el)),this._htOption.useSVG&&(Drawing=svgDrawer),this._android=_getAndroid(),this._el=el,this._oQRCode=null,this._oDrawing=new Drawing(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)}).prototype.makeCode=function(sText){this._oQRCode=new QRCodeModel(function(sText,nCorrectLevel){for(var nType=1,length=function(sText){var replacedText=encodeURI(sText).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return replacedText.length+(replacedText.length!=sText?3:0)}(sText),i=0,len=QRCodeLimitLength.length;i<=len;i++){var nLimit=0;switch(nCorrectLevel){case QRErrorCorrectLevel.L:nLimit=QRCodeLimitLength[i][0];break;case QRErrorCorrectLevel.M:nLimit=QRCodeLimitLength[i][1];break;case QRErrorCorrectLevel.Q:nLimit=QRCodeLimitLength[i][2];break;case QRErrorCorrectLevel.H:nLimit=QRCodeLimitLength[i][3]}if(length<=nLimit)break;nType++}if(nType>QRCodeLimitLength.length)throw new Error("Too long data");return nType}(sText,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(sText),this._oQRCode.make(),this._el.title=sText,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=QRErrorCorrectLevel,QRCode}()},INa4:function(module,exports){var t,e;t=window,e=document,L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(t,e){this._map=t,this._container=t._container,this._overlayPane=t._panes.overlayPane,this._popupPane=t._panes.popupPane,e&&e.shapeOptions&&(e.shapeOptions=L.Util.extend({},this.options.shapeOptions,e.shapeOptions)),L.setOptions(this,e);var i=L.version.split(".");1===parseInt(i[0],10)&&parseInt(i[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(L.DomUtil.disableTextSelection(),t.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(t){L.setOptions(this,t)},_fireCreatedEvent:function(t){this._map.fire(L.Draw.Event.CREATED,{layer:t,layerType:this.type})},_cancelDrawing:function(t){27===t.keyCode&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(t,e){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var t=this._markers.pop(),e=this._poly,i=e.getLatLngs(),o=i.splice(-1,1)[0];this._poly.setLatLngs(i),this._markerGroup.removeLayer(t),e.getLatLngs().length<2&&this._map.removeLayer(e),this._vertexChanged(o,!1)}},addVertex:function(t){this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(t)?this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(t)),this._poly.addLatLng(t),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._vertexChanged(t,!0))},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var t=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),e=this._poly.newLatLngIntersects(t[t.length-1]);!this.options.allowIntersection&&e||!this._shapeIsValid()?this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent),i=this._map.layerPointToLatLng(e);this._currentLatLng=i,this._updateTooltip(i),this._updateGuide(e),this._mouseMarker.setLatLng(i),L.DomEvent.preventDefault(t.originalEvent)},_vertexChanged:function(t,e){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(t,e),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(t){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(t),this._clickHandled=!0,this._disableNewMarkers();var e=t.originalEvent;this._startPoint.call(this,e.clientX,e.clientY)}},_startPoint:function(t,e){this._mouseDownOrigin=L.point(t,e)},_onMouseUp:function(t){var e=t.originalEvent;this._endPoint.call(this,e.clientX,e.clientY,t),this._clickHandled=null},_endPoint:function(e,i,o){if(this._mouseDownOrigin){var a=L.point(e,i).distanceTo(this._mouseDownOrigin),n=this._calculateFinishDistance(o.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(o.latlng),this._finishShape()):n<10&&L.Browser.touch?this._finishShape():Math.abs(a)<9*(t.devicePixelRatio||1)&&this.addVertex(o.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(t){var e,i,o=t.originalEvent;!o.touches||!o.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(e=o.touches[0].clientX,i=o.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,e,i),this._endPoint.call(this,e,i,t),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(t){var e;if(this._markers.length>0){var i;if(this.type===L.Draw.Polyline.TYPE)i=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;i=this._markers[0]}var o=this._map.latLngToContainerPoint(i.getLatLng()),a=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),n=this._map.latLngToContainerPoint(a.getLatLng());e=o.distanceTo(n)}else e=1/0;return e},_updateFinishHandler:function(){var t=this._markers.length;t>1&&this._markers[t-1].on("click",this._finishShape,this),t>2&&this._markers[t-2].off("click",this._finishShape,this)},_createMarker:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(e),e},_updateGuide:function(t){var e=this._markers?this._markers.length:0;e>0&&(t=t||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[e-1].getLatLng()),t))},_updateTooltip:function(t){var e=this._getTooltipText();t&&this._tooltip.updatePosition(t),this._errorShown||this._tooltip.updateContent(e)},_drawGuide:function(t,e){var i,o,a,n=Math.floor(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),r=this.options.maxGuideLineLength,l=n>r?n-r:this.options.guidelineDistance;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));l<n;l+=this.options.guidelineDistance)i=l/n,o={x:Math.floor(t.x*(1-i)+i*e.x),y:Math.floor(t.y*(1-i)+i*e.y)},(a=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer)).style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(a,o)},_updateGuideColor:function(t){if(this._guidesContainer)for(var e=0,i=this._guidesContainer.childNodes.length;e<i;e++)this._guidesContainer.childNodes[e].style.backgroundColor=t},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var t,e;return 0===this._markers.length?t={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(e=this.options.showLength?this._getMeasurementString():"",t=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:e}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:e}),t},_updateRunningMeasure:function(t,e){var i,o,a=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(i=a-(e?2:1),o=L.GeometryUtil.isVersion07x()?t.distanceTo(this._markers[i].getLatLng())*(this.options.factor||1):this._map.distance(t,this._markers[i].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=o*(e?1:-1))},_getMeasurementString:function(){var t,e=this._currentLatLng,i=this._markers[this._markers.length-1].getLatLng();return t=L.GeometryUtil.isVersion07x()?i&&e&&e.distanceTo?this._measurementRunningTotal+e.distanceTo(i)*(this.options.factor||1):this._measurementRunningTotal||0:i&&e?this._measurementRunningTotal+this._map.distance(e,i)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(t,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(t,e){L.Draw.Polyline.prototype.initialize.call(this,t,e),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;1===t&&this._markers[0].on("click",this._finishShape,this),t>2&&(this._markers[t-1].on("dblclick",this._finishShape,this),t>3&&this._markers[t-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var t,e;return 0===this._markers.length?t=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(t=L.drawLocal.draw.handlers.polygon.tooltip.cont,e=this._getMeasurementString()):(t=L.drawLocal.draw.handlers.polygon.tooltip.end,e=this._getMeasurementString()),{text:t,subtext:e}},_getMeasurementString:function(){var t=this._area,e="";return t||this.options.showLength?(this.options.showLength&&(e=L.Draw.Polyline.prototype._getMeasurementString.call(this)),t&&(e+="<br>"+L.GeometryUtil.readableArea(t,this.options.metric,this.options.precision)),e):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(t,e){var i;!this.options.allowIntersection&&this.options.showArea&&(i=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(i)),L.Draw.Polyline.prototype._vertexChanged.call(this,t,e)},_cleanUpShape:function(){var t=this._markers.length;t>0&&(this._markers[0].off("click",this._finishShape,this),t>2&&this._markers[t-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(t,e){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),e.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),L.DomEvent.off(e,"touchend",this._onMouseUp,this),e.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(t){this._isDrawing=!0,this._startLatLng=t.latlng,L.DomEvent.on(e,"mouseup",this._onMouseUp,this).on(e,"touchend",this._onMouseUp,this).preventDefault(t.originalEvent)},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(e))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(t,e){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(t){this._shape||this._isCurrentlyTwoClickDrawing?this._isCurrentlyTwoClickDrawing&&!function(t,e){for(;(t=t.parentElement)&&!t.classList.contains("leaflet-pane"););return t}(t.target)||L.Draw.SimpleShape.prototype._onMouseUp.call(this):this._isCurrentlyTwoClickDrawing=!0},_drawShape:function(t){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,t)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_getTooltipText:function(){var t,e,i,o=L.Draw.SimpleShape.prototype._getTooltipText.call(this),n=this.options.showArea;return this._shape&&(t=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),e=L.GeometryUtil.geodesicArea(t),i=n?L.GeometryUtil.readableArea(e,this.options.metric):""),{text:o.text,subtext:i}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._mouseMarker.setLatLng(e),this._marker?(e=this._mouseMarker.getLatLng(),this._marker.setLatLng(e)):(this._marker=this._createMarker(e),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(t){return new L.Marker(t,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(t){this._onMouseMove(t),this._onClick()},_fireCreatedEvent:function(){var t=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},_fireCreatedEvent:function(){var t=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)},_createMarker:function(t){return new L.CircleMarker(t,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(t,e){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){if(L.GeometryUtil.isVersion07x())var e=this._startLatLng.distanceTo(t);else e=this._map.distance(this._startLatLng,t);this._shape?this._shape.setRadius(e):(this._shape=new L.Circle(this._startLatLng,e,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_onMouseMove:function(t){var e,i=t.latlng,o=this.options.showRadius,a=this.options.metric;if(this._tooltip.updatePosition(i),this._isDrawing){this._drawShape(i),e=this._shape.getRadius().toFixed(1);var n="";o&&(n=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(e,a,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:n})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(t,e){this._marker=t,L.setOptions(this,e)},addHooks:function(){var t=this._marker;t.dragging.enable(),t.on("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},removeHooks:function(){var t=this._marker;t.dragging.disable(),t.off("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},_onDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:e})},_toggleMarkerHighlight:function(){var t=this._marker._icon;t&&(t.style.display="none",L.DomUtil.hasClass(t,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,-4)):(L.DomUtil.addClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,4)),t.style.display="")},_offsetMarker:function(t,e){var i=parseInt(t.style.marginTop,10)-e,o=parseInt(t.style.marginLeft,10)-e;t.style.marginTop=i+"px",t.style.marginLeft=o+"px"}}),L.Marker.addInitHook((function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())})),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(t){this.latlngs=[t._latlngs],t._holes&&(this.latlngs=this.latlngs.concat(t._holes)),this._poly=t,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(t){for(var e=0;e<this._verticesHandlers.length;e++)t(this._verticesHandlers[e])},addHooks:function(){this._initHandlers(),this._eachVertexHandler((function(t){t.addHooks()}))},removeHooks:function(){this._eachVertexHandler((function(t){t.removeHooks()}))},updateMarkers:function(){this._eachVertexHandler((function(t){t.updateMarkers()}))},_initHandlers:function(){this._verticesHandlers=[];for(var t=0;t<this.latlngs.length;t++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[t],this._poly.options.poly))},_updateLatLngs:function(t){this.latlngs=[t.layer._latlngs],t.layer._holes&&(this.latlngs=this.latlngs.concat(t.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(t,e,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=t,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this._latlngs=e,L.setOptions(this,i)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var t=this._poly,e=t._path;t instanceof L.Polygon||(t.options.fill=!1,t.options.editing&&(t.options.editing.fill=!1)),e&&t.options.editing&&t.options.editing.className&&(t.options.original.className&&t.options.original.className.split(" ").forEach((function(t){L.DomUtil.removeClass(e,t)})),t.options.editing.className.split(" ").forEach((function(t){L.DomUtil.addClass(e,t)}))),t.setStyle(t.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var t=this._poly,e=t._path;e&&t.options.editing&&t.options.editing.className&&(t.options.editing.className.split(" ").forEach((function(t){L.DomUtil.removeClass(e,t)})),t.options.original.className&&t.options.original.className.split(" ").forEach((function(t){L.DomUtil.addClass(e,t)}))),t.setStyle(t.options.original),t._map&&(t._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var t,e,i,o,n,s,a=this._defaultShape();for(t=0,i=a.length;t<i;t++)(o=this._createMarker(a[t],t)).on("click",this._onMarkerClick,this),o.on("contextmenu",this._onContextMenu,this),this._markers.push(o);for(t=0,e=i-1;t<i;e=t++)(0!==t||L.Polygon&&this._poly instanceof L.Polygon)&&(this._createMiddleMarker(n=this._markers[e],s=this._markers[t]),this._updatePrevNext(n,s))},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:this.options.icon});return i._origLatLng=t,i._index=e,i.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(i),i},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var t=this._defaultShape(),e=[].splice.apply(t,arguments);return this._poly._convertLatLngs(t,!0),this._poly.redraw(),e},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(t){var e=t.target,i=this._poly,o=L.LatLngUtil.cloneLatLng(e._origLatLng);if(L.extend(e._origLatLng,e._latlng),i.options.poly){var a=i._map._editTooltip;if(!i.options.poly.allowIntersection&&i.intersects()){L.extend(e._origLatLng,o),e.setLatLng(o);var n=i.options.color;i.setStyle({color:this.options.drawError.color}),a&&a.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout((function(){i.setStyle({color:n}),a&&a.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})}),1e3)}}e._middleLeft&&e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&&e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var s=this._poly.getLatLngs();this._poly._convertLatLngs(s,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(t){var e=L.Polygon&&this._poly instanceof L.Polygon?4:3,i=t.target;this._defaultShape().length<e||(this._removeMarker(i),this._updatePrevNext(i._prev,i._next),i._middleLeft&&this._markerGroup.removeLayer(i._middleLeft),i._middleRight&&this._markerGroup.removeLayer(i._middleRight),i._prev&&i._next?this._createMiddleMarker(i._prev,i._next):i._prev?i._next||(i._prev._middleRight=null):i._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(t){this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:t.target,layers:this._markerGroup,poly:this._poly}),L},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e),o=t.target;L.extend(o._origLatLng,i),o._middleLeft&&o._middleLeft.setLatLng(this._getMiddleLatLng(o._prev,o)),o._middleRight&&o._middleRight.setLatLng(this._getMiddleLatLng(o,o._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(t,e){this._markerGroup.eachLayer((function(i){i._index>t&&(i._index+=e)}))},_createMiddleMarker:function(t,e){var i,o,a,n=this._getMiddleLatLng(t,e),s=this._createMarker(n);s.setOpacity(.6),t._middleRight=e._middleLeft=s,o=function(){s.off("touchmove",o,this);var a=e._index;s._index=a,s.off("click",i,this).on("click",this._onMarkerClick,this),n.lat=s.getLatLng().lat,n.lng=s.getLatLng().lng,this._spliceLatLngs(a,0,n),this._markers.splice(a,0,s),s.setOpacity(1),this._updateIndexes(a,1),e._index++,this._updatePrevNext(t,s),this._updatePrevNext(s,e),this._poly.fire("editstart")},a=function(){s.off("dragstart",o,this),s.off("dragend",a,this),s.off("touchmove",o,this),this._createMiddleMarker(t,s),this._createMiddleMarker(s,e)},s.on("click",i=function(){o.call(this),a.call(this),this._fireEdit()},this).on("dragstart",o,this).on("dragend",a,this).on("touchmove",o,this),this._markerGroup.addLayer(s)},_updatePrevNext:function(t,e){t&&(t._next=e),e&&(e._prev=t)},_getMiddleLatLng:function(t,e){var i=this._poly._map,o=i.project(t.getLatLng()),a=i.project(e.getLatLng());return i.unproject(o._add(a)._divideBy(2))}}),L.Polyline.addInitHook((function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",(function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()})),this.on("remove",(function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})))})),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(t,e){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=t,L.Util.setOptions(this,e)},addHooks:function(){var t=this._shape;this._shape._map&&(this._map=this._shape._map,t.setStyle(t.options.editing),t._map&&(this._map=t._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var t=this._shape;if(t.setStyle(t.options.original),t._map){this._unbindMarker(this._moveMarker);for(var e=0,i=this._resizeMarkers.length;e<i;e++)this._unbindMarker(this._resizeMarkers[e]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:e,zIndexOffset:10});return this._bindMarker(i),this._markerGroup.addLayer(i),i},_bindMarker:function(t){t.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(t){t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(t){t.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(t){var e=t.target,i=e.getLatLng();e===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(t){t.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(t){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t),"function"==typeof this._getCorners){var e=this._getCorners(),i=t.target,o=i._cornerIndex;i.setOpacity(0),this._oppositeCorner=e[(o+2)%4],this._toggleCornerMarkers(0,o)}this._shape.fire("editstart")},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e);return t.target===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),!1},_onTouchEnd:function(t){t.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var e=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(e,this.options.moveIcon)},_createResizeMarker:function(){var t=this._getCorners();this._resizeMarkers=[];for(var e=0,i=t.length;e<i;e++)this._resizeMarkers.push(this._createMarker(t[e],this.options.resizeIcon)),this._resizeMarkers[e]._cornerIndex=e},_onMarkerDragStart:function(t){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t);var e=this._getCorners(),o=t.target._cornerIndex;this._oppositeCorner=e[(o+2)%4],this._toggleCornerMarkers(0,o)},_onMarkerDragEnd:function(t){var i,o=t.target;o===this._moveMarker&&(i=this._shape.getBounds().getCenter(),o.setLatLng(i)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,t)},_move:function(t){for(var e,i=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),a=this._shape.getBounds().getCenter(),n=[],s=0,r=i.length;s<r;s++)n.push([t.lat+(e=[i[s].lat-a.lat,i[s].lng-a.lng])[0],t.lng+e[1]]);this._shape.setLatLngs(n),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(t){var e;this._shape.setBounds(L.latLngBounds(t,this._oppositeCorner)),e=this._shape.getBounds(),this._moveMarker.setLatLng(e.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var t=this._shape.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]},_toggleCornerMarkers:function(t){for(var e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setOpacity(t)},_repositionCornerMarkers:function(){for(var t=this._getCorners(),e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setLatLng(t[e])}}),L.Rectangle.addInitHook((function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())})),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getLatLng();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(t){if(this._resizeMarkers.length){var e=this._getResizeMarkerPoint(t);this._resizeMarkers[0].setLatLng(e)}this._shape.setLatLng(t),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook((function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",(function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()})),this.on("remove",(function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))})),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var t=this._shape.getLatLng(),e=this._getResizeMarkerPoint(t);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(e,this.options.resizeIcon))},_getResizeMarkerPoint:function(t){var e=this._shape._radius*Math.cos(Math.PI/4),i=this._map.project(t);return this._map.unproject([i.x+e,i.y-e])},_resize:function(t){var e=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=e.distanceTo(t):radius=this._map.distance(e,t),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook((function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())})),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(t,e){var i={};if(void 0!==t.touches){if(!t.touches.length)return;i=t.touches[0]}else{if("touch"!==t.pointerType)return;if(i=t,!this._filterClick(t))return}var o=this._map.mouseEventToContainerPoint(i),a=this._map.mouseEventToLayerPoint(i),n=this._map.layerPointToLatLng(a);this._map.fire(e,{latlng:n,layerPoint:a,containerPoint:o,pageX:i.pageX,pageY:i.pageY,originalEvent:t})},_filterClick:function(t){var e=t.timeStamp||t.originalEvent.timeStamp,i=L.DomEvent._lastClick&&e-L.DomEvent._lastClick;return i&&i>100&&i<500||t.target._simulatedClick&&!t._simulated?(L.DomEvent.stop(t),!1):(L.DomEvent._lastClick=e,!0)},_onTouchStart:function(t){this._map._loaded&&this._touchEvent(t,"touchstart")},_onTouchEnd:function(t){this._map._loaded&&this._touchEvent(t,"touchend")},_onTouchCancel:function(t){if(this._map._loaded){var e="touchcancel";this._detectIE()&&(e="pointercancel"),this._touchEvent(t,e)}},_onTouchLeave:function(t){this._map._loaded&&this._touchEvent(t,"touchleave")},_onTouchMove:function(t){this._map._loaded&&this._touchEvent(t,"touchmove")},_detectIE:function(){var e=t.navigator.userAgent,i=e.indexOf("MSIE ");if(i>0)return parseInt(e.substring(i+5,e.indexOf(".",i)),10);if(e.indexOf("Trident/")>0){var o=e.indexOf("rv:");return parseInt(e.substring(o+3,e.indexOf(".",o)),10)}var a=e.indexOf("Edge/");return a>0&&parseInt(e.substring(a+5,e.indexOf(".",a)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];e.concat(this._detectIE?["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]:["touchcancel"]),L.DomUtil.addClass(t,"leaflet-clickable"),L.DomEvent.on(t,"click",this._onMouseClick,this),L.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var i=0;i<e.length;i++)L.DomEvent.on(t,e[i],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var e=t.navigator.userAgent,i=e.indexOf("MSIE ");if(i>0)return parseInt(e.substring(i+5,e.indexOf(".",i)),10);if(e.indexOf("Trident/")>0){var o=e.indexOf("rv:");return parseInt(e.substring(o+3,e.indexOf(".",o)),10)}var a=e.indexOf("Edge/");return a>0&&parseInt(e.substring(a+5,e.indexOf(".",a)),10)}}),L.LatLngUtil={cloneLatLngs:function(t){for(var e=[],i=0,o=t.length;i<o;i++)Array.isArray(t[i])?e.push(L.LatLngUtil.cloneLatLngs(t[i])):e.push(this.cloneLatLng(t[i]));return e},cloneLatLng:function(t){return L.latLng(t.lat,t.lng)}},function(){var t={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(t){var e,i,o=t.length,a=0,n=Math.PI/180;if(o>2){for(var s=0;s<o;s++)a+=((i=t[(s+1)%o]).lng-(e=t[s]).lng)*n*(2+Math.sin(e.lat*n)+Math.sin(i.lat*n));a=6378137*a*6378137/2}return Math.abs(a)},formattedNumber:function(t,e){var i=parseFloat(t).toFixed(e),o=L.drawLocal.format&&L.drawLocal.format.numeric,a=o&&o.delimiters,n=a&&a.thousands,s=a&&a.decimal;if(n||s){var r=i.split(".");i=n?r[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+n):r[0],s=s||".",r.length>1&&(i=i+s+r[1])}return i},readableArea:function(e,i,o){var a,n;return o=L.Util.extend({},t,o),i?(n=["ha","m"],type=typeof i,"string"===type?n=[i]:"boolean"!==type&&(n=i),a=e>=1e6&&-1!==n.indexOf("km")?L.GeometryUtil.formattedNumber(1e-6*e,o.km)+" km\xb2":e>=1e4&&-1!==n.indexOf("ha")?L.GeometryUtil.formattedNumber(1e-4*e,o.ha)+" ha":L.GeometryUtil.formattedNumber(e,o.m)+" m\xb2"):a=(e/=.836127)>=3097600?L.GeometryUtil.formattedNumber(e/3097600,o.mi)+" mi\xb2":e>=4840?L.GeometryUtil.formattedNumber(e/4840,o.ac)+" acres":L.GeometryUtil.formattedNumber(e,o.yd)+" yd\xb2",a},readableDistance:function(e,i,o,a,n){var s;switch(n=L.Util.extend({},t,n),i?"string"==typeof i?i:"metric":o?"feet":a?"nauticalMile":"yards"){case"metric":s=e>1e3?L.GeometryUtil.formattedNumber(e/1e3,n.km)+" km":L.GeometryUtil.formattedNumber(e,n.m)+" m";break;case"feet":e*=3.28083,s=L.GeometryUtil.formattedNumber(e,n.ft)+" ft";break;case"nauticalMile":e*=.53996,s=L.GeometryUtil.formattedNumber(e/1e3,n.nm)+" nm";break;case"yards":default:s=(e*=1.09361)>1760?L.GeometryUtil.formattedNumber(e/1760,n.mi)+" miles":L.GeometryUtil.formattedNumber(e,n.yd)+" yd"}return s},isVersion07x:function(){var t=L.version.split(".");return 0===parseInt(t[0],10)&&7===parseInt(t[1],10)}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(t,e,i,o){return this._checkCounterclockwise(t,i,o)!==this._checkCounterclockwise(e,i,o)&&this._checkCounterclockwise(t,e,i)!==this._checkCounterclockwise(t,e,o)},_checkCounterclockwise:function(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}}),L.Polyline.include({intersects:function(){var t,o=this._getProjectedPoints(),a=o?o.length:0;if(this._tooFewPointsForIntersection())return!1;for(t=a-1;t>=3;t--)if(this._lineSegmentsIntersectsRange(o[t-1],o[t],t-2))return!0;return!1},newLatLngIntersects:function(t,e){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(t),e)},newPointIntersects:function(t,e){var i=this._getProjectedPoints(),o=i?i.length:0,a=i?i[o-1]:null,n=o-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(a,t,n,e?1:0)},_tooFewPointsForIntersection:function(t){var e=this._getProjectedPoints(),i=e?e.length:0;return!e||(i+=t||0)<=3},_lineSegmentsIntersectsRange:function(t,e,i,o){var s=this._getProjectedPoints();o=o||0;for(var r=i;r>o;r--)if(L.LineUtil.segmentsIntersect(t,e,s[r-1],s[r]))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var t=[],e=this._defaultShape(),i=0;i<e.length;i++)t.push(this._map.latLngToLayerPoint(e[i]));return t}}),L.Polygon.include({intersects:function(){var t,a=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||this._lineSegmentsIntersectsRange(a[(t=a.length)-1],a[0],t-2,1))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(t){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");var e;L.Control.prototype.initialize.call(this,t),this._toolbars={},L.DrawToolbar&&this.options.draw&&(e=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=e,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(e=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=e,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(t){var e,i=L.DomUtil.create("div","leaflet-draw"),o=!1;for(var a in this._toolbars)this._toolbars.hasOwnProperty(a)&&(e=this._toolbars[a].addToolbar(t))&&(o||(L.DomUtil.hasClass(e,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(e.childNodes[0],"leaflet-draw-toolbar-top"),o=!0),i.appendChild(e));return i},onRemove:function(){for(var t in this._toolbars)this._toolbars.hasOwnProperty(t)&&this._toolbars[t].removeToolbar()},setDrawingOptions:function(t){for(var e in this._toolbars)this._toolbars[e]instanceof L.DrawToolbar&&this._toolbars[e].setOptions(t)},_toolbarEnabled:function(t){var e=t.target;for(var i in this._toolbars)this._toolbars[i]!==e&&this._toolbars[i].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook((function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))})),L.Toolbar=L.Class.extend({initialize:function(t){L.setOptions(this,t),this._modes={},this._actionButtons=[],this._activeMode=null;var e=L.version.split(".");1===parseInt(e[0],10)&&parseInt(e[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(t){var e,i=L.DomUtil.create("div","leaflet-draw-section"),o=0,a=this._toolbarClass||"",n=this.getModeHandlers(t);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=t,e=0;e<n.length;e++)n[e].enabled&&this._initModeHandler(n[e].handler,this._toolbarContainer,o++,a,n[e].title);if(o)return this._lastButtonIndex=--o,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),i.appendChild(this._toolbarContainer),i.appendChild(this._actionsContainer),i},removeToolbar:function(){for(var t in this._modes)this._modes.hasOwnProperty(t)&&(this._disposeButton(this._modes[t].button,this._modes[t].handler.enable,this._modes[t].handler),this._modes[t].handler.disable(),this._modes[t].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var e=0,i=this._actionButtons.length;e<i;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(t,e,i,o,a){var n=t.type;this._modes[n]={},this._modes[n].handler=t,this._modes[n].button=this._createButton({type:n,title:a,className:o+"-"+n,container:e,callback:this._modes[n].handler.enable,context:this._modes[n].handler}),this._modes[n].buttonIndex=i,this._modes[n].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!t.MSStream},_createButton:function(t){var e=L.DomUtil.create("a",t.className||"",t.container),i=L.DomUtil.create("span","sr-only",t.container);e.href="#",e.appendChild(i),t.title&&(e.title=t.title,i.innerHTML=t.title),t.text&&(e.innerHTML=t.text,i.innerHTML=t.text);var o=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"mousedown",L.DomEvent.stopPropagation).on(e,"dblclick",L.DomEvent.stopPropagation).on(e,"touchstart",L.DomEvent.stopPropagation).on(e,"click",L.DomEvent.preventDefault).on(e,o,t.callback,t.context),e},_disposeButton:function(t,e){var i=this._detectIOS()?"touchstart":"click";L.DomEvent.off(t,"click",L.DomEvent.stopPropagation).off(t,"mousedown",L.DomEvent.stopPropagation).off(t,"dblclick",L.DomEvent.stopPropagation).off(t,"touchstart",L.DomEvent.stopPropagation).off(t,"click",L.DomEvent.preventDefault).off(t,i,e)},_handlerActivated:function(t){this.disable(),this._activeMode=this._modes[t.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(t){var e,i,o,a,n=this._actionsContainer,s=this.getActions(t),r=s.length;for(i=0,o=this._actionButtons.length;i<o;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback);for(this._actionButtons=[];n.firstChild;)n.removeChild(n.firstChild);for(var l=0;l<r;l++)"enabled"in s[l]&&!s[l].enabled||(e=L.DomUtil.create("li","",n),a=this._createButton({title:s[l].title,text:s[l].text,container:e,callback:s[l].callback,context:s[l].context}),this._actionButtons.push({button:a,callback:s[l].callback}))},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,e=this._lastButtonIndex,i=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=i+"px",0===t&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),t===e&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(t){this._map=t,this._popupPane=t._panes.popupPane,this._visible=!1,this._container=t.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(t){return this._container?(t.subtext=t.subtext||"",0!==t.subtext.length||this._singleLineLabel?t.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(t.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+t.subtext+"</span><br />":"")+"<span>"+t.text+"</span>",t.text||t.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(t){var e=this._map.latLngToLayerPoint(t),i=this._container;return this._container&&(this._visible&&(i.style.visibility="inherit"),L.DomUtil.setPosition(i,e)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(t){for(var e in this.options)this.options.hasOwnProperty(e)&&t[e]&&(t[e]=L.extend({},this.options[e],t[e]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,t)},getModeHandlers:function(t){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(t,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(t,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(t,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(t,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(t,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(t,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(t){return[{enabled:t.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:t.completeShape,context:t},{enabled:t.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:t.deleteLastVertex,context:t},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(t){for(var e in L.setOptions(this,t),this._modes)this._modes.hasOwnProperty(e)&&t.hasOwnProperty(e)&&this._modes[e].handler.setOptions(t[e])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(t){t.edit&&(void 0===t.edit.selectedPathOptions&&(t.edit.selectedPathOptions=this.options.edit.selectedPathOptions),t.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,t.edit.selectedPathOptions)),t.remove&&(t.remove=L.extend({},this.options.remove,t.remove)),t.poly&&(t.poly=L.extend({},this.options.poly,t.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,t),this._selectedFeatureCount=0},getModeHandlers:function(t){var e=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(t,{featureGroup:e,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(t,{featureGroup:e}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(t){var e=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return t.removeAllLayers&&e.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),e},addToolbar:function(t){var e=L.Toolbar.prototype.addToolbar.call(this,t);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),e},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var t,i=0!==this.options.featureGroup.getLayers().length;this.options.edit&&(t=this._modes[L.EditToolbar.Edit.TYPE].button,i?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",i?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(t=this._modes[L.EditToolbar.Delete.TYPE].button,i?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",i?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.setOptions(this,e),this._featureGroup=e.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var i=L.version.split(".");1===parseInt(i[0],10)&&parseInt(i[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),t._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer((function(t){this._revertLayer(t)}),this)},save:function(){var t=new L.LayerGroup;this._featureGroup.eachLayer((function(e){e.edited&&(t.addLayer(e),e.edited=!1)})),this._map.fire(L.Draw.Event.EDITED,{layers:t})},_backupLayer:function(t){var e=L.Util.stamp(t);this._uneditedLayerProps[e]||(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?this._uneditedLayerProps[e]={latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}:t instanceof L.Circle?this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}:(t instanceof L.Marker||t instanceof L.CircleMarker)&&(this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1,this._uneditedLayerProps.hasOwnProperty(e)&&(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?t.setLatLngs(this._uneditedLayerProps[e].latlngs):t instanceof L.Circle?(t.setLatLng(this._uneditedLayerProps[e].latlng),t.setRadius(this._uneditedLayerProps[e].radius)):(t instanceof L.Marker||t instanceof L.CircleMarker)&&t.setLatLng(this._uneditedLayerProps[e].latlng),t.fire("revert-edited",{layer:t}))},_enableLayerEdit:function(t){var e,i,o=t.layer||t.target||t;this._backupLayer(o),this.options.poly&&(i=L.Util.extend({},this.options.poly),o.options.poly=i),this.options.selectedPathOptions&&((e=L.Util.extend({},this.options.selectedPathOptions)).maintainColor&&(e.color=o.options.color,e.fillColor=o.options.fillColor),o.options.original=L.extend({},o.options),o.options.editing=e),o instanceof L.Marker?(o.editing&&o.editing.enable(),o.dragging.enable(),o.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):o.editing.enable()},_disableLayerEdit:function(t){var e=t.layer||t.target||t;e.edited=!1,e.editing&&e.editing.disable(),delete e.options.editing,delete e.options.original,this._selectedPathOptions&&(e instanceof L.Marker?this._toggleMarkerHighlight(e):(e.setStyle(e.options.previousOptions),delete e.options.previousOptions)),e instanceof L.Marker?(e.dragging.disable(),e.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):e.editing.disable()},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_onMarkerDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:e})},_onTouchMove:function(t){var i=this._map.mouseEventToLayerPoint(t.originalEvent.changedTouches[0]),o=this._map.layerPointToLatLng(i);t.target.setLatLng(o)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.Util.setOptions(this,e),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var i=L.version.split(".");1===parseInt(i[0],10)&&parseInt(i[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer((function(t){this._deletableLayers.addLayer(t),t.fire("revert-deleted",{layer:t})}),this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer((function(t){this._removeLayer({layer:t})}),this),this.save()},_enableLayerDelete:function(t){(t.layer||t.target||t).on("click",this._removeLayer,this)},_disableLayerDelete:function(t){var e=t.layer||t.target||t;e.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(e)},_removeLayer:function(t){var e=t.layer||t.target||t;this._deletableLayers.removeLayer(e),this._deletedLayers.addLayer(e),e.fire("deleted")},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})},XuQL:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var core=__webpack_require__("8Y7J");class PlayerModule{}var router_ngfactory=__webpack_require__("pMnS"),common=__webpack_require__("SVse");class HostDirective{constructor(viewContainerRef){this.viewContainerRef=viewContainerRef}}const registry=new Map;function RegisterPreviewComponent(type){return mixinConstructor=>{registry.set(type.name,mixinConstructor)}}class dynamic_loader_component_DynamicLoaderComponent{constructor(componentFactoryResolver){this.componentFactoryResolver=componentFactoryResolver}set screen(data){if(data){const mixinConstructor=registry.get(data.constructor.name),componentFactory=this.componentFactoryResolver.resolveComponentFactory(mixinConstructor),viewContainerRef=this.host.viewContainerRef;viewContainerRef.clear(),viewContainerRef.createComponent(componentFactory).instance.data=data}else this.host.viewContainerRef.clear()}}var RenderType_DynamicLoaderComponent=core.ob({encapsulation:0,styles:[[""]],data:{}});function View_DynamicLoaderComponent_1(_l){return core.Lb(0,[(_l()(),core.fb(0,null,null,0))],null,null)}function View_DynamicLoaderComponent_0(_l){return core.Lb(0,[core.Hb(402653184,1,{host:0}),(_l()(),core.fb(16777216,null,null,1,null,View_DynamicLoaderComponent_1)),core.pb(2,16384,[[1,4]],0,HostDirective,[core.N],null,null)],null,null)}var BehaviorSubject=__webpack_require__("2Vo4"),Subject=__webpack_require__("XNiG"),PlayerState=function(PlayerState){return PlayerState.PLAYING="playing",PlayerState.PAUSED="paused",PlayerState.DISABLED="disabled",PlayerState}({});class player_service_PlayerService{constructor(experienceService){this.experienceService=experienceService,this.playbackSubject=new BehaviorSubject.a(PlayerState.PLAYING),this.playbackEndedSubject=new Subject.a,this.playbackChanged=this.playbackSubject.asObservable(),this.playbackEnded=this.playbackEndedSubject.asObservable(),this.evaluateConditions=!0,this.mediaAutoplayIsBlockedMonitor=new BehaviorSubject.a(!1),this.mediaAutoplayIsBlocked=this.mediaAutoplayIsBlockedMonitor.asObservable(),this.screenWrapperIsOverflownMonitor=new BehaviorSubject.a(!1),this.screenWrapperIsOverflown=this.screenWrapperIsOverflownMonitor.asObservable(),this.mediaIsLoadingMonitor=new BehaviorSubject.a(!1),this.mediaLoading=this.mediaIsLoadingMonitor.asObservable()}get storyModel(){return this.experienceService.getSelectedStoryModel()}setPlayerState(playerState){this.playbackSubject.next(playerState)}getPlayerState(){return this.playbackSubject.getValue()}setPlaybackEnded(branch){this.playbackEndedSubject.next(branch)}setPlayBackPreviewState(newState){this.state=newState}getPlayBackPreviewState(){return this.state}setPlayBackPreviewPartId(partId){this.currentPreviewPartId=partId}getPlayBackPreviewPartId(){return this.currentPreviewPartId}validateBranch(branchId){if(this.evaluateConditions){const branch=this.storyModel.getPartOutBranches(this.currentPreviewPartId).find(elem=>elem.data.id===branchId);if(!branch||branch.data.showOnce&&this.state.branchesVisited.has(branch.data.id))return!1;if(branch.data.ifTags)for(const ifTag of branch.data.ifTags)if(!this.state.tagsPassed.has(ifTag))return!1;if(branch.data.ifNotTags)for(const ifNotTag of branch.data.ifNotTags)if(this.state.tagsPassed.has(ifNotTag))return!1}return!0}validateBranchList(branchList){const validBranches=new Map;return branchList&&branchList.forEach(branch=>{validBranches.set(branch.target,this.validateBranch(branch.target))}),validBranches}setMediaAutoplayIsBlocked(disabled){this.mediaAutoplayIsBlockedMonitor.next(disabled)}setScreenWrapperIsOverflown(isOverflown){this.screenWrapperIsOverflownMonitor.next(isOverflown)}setMediaIsLoading(loading){this.mediaIsLoadingMonitor.next(loading)}}var experience_service=__webpack_require__("3bqb");class Stack{constructor(){this.data=[]}push(val){this.data.push(val)}pop(){return this.data.pop()}top(){return this.data[this.data.length-1]}empty(){return 0===this.data.length}size(){return this.data.length}trace(val){const index=this.data.indexOf(val);return-1!==index&&(this.data=this.data.slice(0,index),!0)}has(val){return-1!==this.data.indexOf(val)}}class PreviewState{constructor(){this.tagsPassed=new Set,this.partsVisited=new Set,this.branchesVisited=new Set}copyState(other){this.tagsPassed=new Set(other.tagsPassed),this.partsVisited=new Set(other.partsVisited),this.branchesVisited=new Set(other.branchesVisited)}addPartVisited(partId){this.partsVisited.add(partId)}addBranchVisited(branchId){this.branchesVisited.add(branchId)}addTagPassed(tag){this.tagsPassed.add(tag)}addTagsPassed(tags){for(const tag of tags)this.tagsPassed.add(tag)}}var templates=__webpack_require__("bVoE"),KeyCode=function(KeyCode){return KeyCode[KeyCode.RIGHT_ARROW=39]="RIGHT_ARROW",KeyCode[KeyCode.LEFT_ARROW=37]="LEFT_ARROW",KeyCode[KeyCode.SPACE=32]="SPACE",KeyCode}({});class player_component_PlayerComponent{constructor(experienceService,playerService,selectedPartDetectorService,modalService){this.experienceService=experienceService,this.playerService=playerService,this.selectedPartDetectorService=selectedPartDetectorService,this.modalService=modalService,this.index=0,this.showFinishBtn=!1,this.finished=new core.m,this.inFullScreen=!1,this.showCheckMark=!1,this.PlayerState=PlayerState,this.stack=new Stack,this.screensMap=new Map,this.experienceTitle="",this.playerState=PlayerState.PLAYING,this.autoplay=link=>{if(link||this.screen.autoProceed)try{this.getNext(link)}catch(e){console.error("no content",e),this.playerState=PlayerState.PAUSED,this.playerService.setPlayerState(this.playerState),setTimeout(()=>this.onFinish(),2e3)}else this.playerState=PlayerState.PAUSED,this.playerService.setPlayerState(this.playerState)}}get currentPartId(){return this._currentPartId}set currentPartId(newPartId){this._currentPartId=newPartId,this.playerService.setPlayBackPreviewPartId(this._currentPartId)}get currentPreviewState(){return this._currentPreviewState}set currentPreviewState(newPreviewState){this._currentPreviewState=newPreviewState,this.playerService.setPlayBackPreviewState(this._currentPreviewState)}get screen(){return this.screens?this.screens[this.index]:null}get screens(){return this.screensMap.get(this.currentPartId)}onFinish(){this.finished.emit()}ngOnInit(){const selectedExperience=this.experienceService.getSelectedExperience();this.screensMap=selectedExperience.production.content,this.experienceTitle=selectedExperience.title,this.subscription=this.playerService.mediaLoading.subscribe(isLoading=>{isLoading!==this.mediaIsLoading&&(this.mediaIsLoading=isLoading)}),this.subscription.add(this.selectedPartDetectorService.partId$.subscribe(partId=>{this.currentPartId=partId,this.currentPreviewState=new PreviewState,this.currentPreviewState.addPartVisited(this.currentPartId),this.currentPreviewState.addTagsPassed(this.experienceService.getSelectedStoryModel().getPartData(this.currentPartId).tags)})),this.playerService.playbackEnded.subscribe(this.autoplay),this.playerService.playbackChanged.subscribe(playbackState=>{setTimeout(()=>{this.playerState=playbackState,playbackState===PlayerState.DISABLED&&(this.autoplayIsBlocked=!1)})}),this.subscription.add(this.playerService.mediaAutoplayIsBlocked.subscribe(isBlocked=>this.autoplayIsBlocked=isBlocked&&this.playerState!==PlayerState.DISABLED)),this.screen instanceof templates.AbstractJump&&(this.getNext(this.playerService.validateBranch(this.screen.target)?this.screen:null),this.firstValidIndex=this.index),this.showCheckMark=this.hasEnded()}openModal(){this.modalService.open(this.modalFullScreen,{centered:!0})}reqFullScreen(){window.document.fullscreenElement?(window.document.exitFullscreen(),this.inFullScreen=!1):(window.document.documentElement.requestFullscreen(),this.inFullScreen=!0)}ngOnDestroy(){this.subscription.unsubscribe()}updateIsOverflown(){this.screenWrapper&&this.playerService.setScreenWrapperIsOverflown(this.screenWrapper.nativeElement.scrollHeight>this.screenWrapper.nativeElement.offsetHeight)}scrollToTop(){this.screenWrapper&&this.screenWrapper.nativeElement.scroll(0,0,{behavior:"smooth"})}getNext(link){const next=this.getNextInternal(link);return this.showCheckMark=this.hasEnded(),this.playerService.setScreenWrapperIsOverflown(!1),this.scrollToTop(),next}getNextInternal(link){if(link&&this.followLink(link),this.hasEnded()){if(link){const previousState=this.stack.pop();this.currentPartId=previousState.currentPartId,this.currentPreviewState=previousState.state,this.index=previousState.index}throw new Error("no such element")}const screen=this.screens[++this.index];return screen instanceof templates.AbstractJump?this.getNextInternal(this.playerService.validateBranch(screen.target)?screen:null):screen}hasPrevious(){return(this.stack.size()>0||this.index>0)&&this.index!==this.firstValidIndex}getPrevious(){try{const previous=this.getPreviousInternal();return this.showCheckMark=this.hasEnded(),this.scrollToTop(),previous}catch(e){return this.getNext()}}getPreviousInternal(){if(!this.hasPrevious())throw new Error("no such element");if(this.index>0)--this.index;else{const previousState=this.stack.pop();this.currentPartId=previousState.currentPartId,this.currentPreviewState=previousState.state,this.index=previousState.index}const screen=this.screens[this.index];return screen instanceof templates.AbstractJump?this.getPreviousInternal():screen}isLastScreenOfPart(){return this.index+1===this.screens.length}hasNext(){return!this.isLastScreenOfPart()||this.hasEnded()}followLink(link){this.stack.push({index:this.index,currentPartId:this.currentPartId,state:this.currentPreviewState});const targetBranch=this.experienceService.getSelectedStoryModel().getPartOutBranch(this.currentPartId,link.target);this.currentPartId=targetBranch.targetID,this.currentPreviewState=new PreviewState,this.currentPreviewState.copyState(this.stack.top().state),this.index=-1,this.currentPreviewState.addPartVisited(this.currentPartId),this.currentPreviewState.addBranchVisited(link.target),this.currentPreviewState.addTagsPassed(this.experienceService.getSelectedStoryModel().getPartData(this.currentPartId).tags),this.currentPreviewState.addTagsPassed(targetBranch.data.tags)}linkHasNext(link){if(this.playerService.validateBranch(link.target)){this.followLink(link);const linkHasNext=!this.hasEnded(),previousState=this.stack.pop();return this.currentPartId=previousState.currentPartId,this.currentPreviewState=previousState.state,this.index=previousState.index,linkHasNext}return!1}hasEnded(){if(!this.screens||0===this.screens.length)return!0;if(this.index+1<this.screens.length){const next=this.screens[this.index+1];if(!(next instanceof templates.AbstractJump)||this.linkHasNext(next))return!1;if(this.index+2<this.screens.length){++this.index;const hasEnded=this.hasEnded();return--this.index,hasEnded}}else if(this.screen instanceof templates.AbstractBranchingPoint)for(const branch of this.screen.getBranches())if(this.linkHasNext(branch))return!1;return!0}togglePlayback(){switch(this.playerState){case PlayerState.PLAYING:this.playerState=PlayerState.PAUSED,this.playerService.setPlayerState(this.playerState);break;case PlayerState.PAUSED:this.playerState=PlayerState.PLAYING,this.playerService.setPlayerState(this.playerState)}}keyEvent(event){switch(document.getElementsByClassName("btn-next"),document.getElementsByClassName("btn-previous"),event.keyCode){case KeyCode.RIGHT_ARROW:this.isLastScreenOfPart()||this.hasEnded()||this.getNext();break;case KeyCode.LEFT_ARROW:this.hasPrevious()&&this.getPrevious();break;case KeyCode.SPACE:const toggleBtn=document.getElementsByClassName("btn-toggle")[0];document.activeElement!==toggleBtn&&(event.preventDefault(),event.stopPropagation(),this.playerState!==PlayerState.DISABLED&&(this.togglePlayback(),toggleBtn.focus()))}}}var selected_part_detector_service=__webpack_require__("kAi9"),ng_bootstrap=__webpack_require__("G0yt"),RenderType_PlayerComponent=core.ob({encapsulation:0,styles:[["@media (min-height:100px){.lg-logo-title-wrapper[_ngcontent-%COMP%], .sm-logo-title-wrapper[_ngcontent-%COMP%]{display:none!important}}@media (min-height:500px){.sm-logo-title-wrapper[_ngcontent-%COMP%]{display:flex!important}.lg-logo-title-wrapper[_ngcontent-%COMP%]{display:block!important}}@media (min-width:200px){.lg-logo-img[_ngcontent-%COMP%]{display:block!important;margin-right:0;margin-bottom:10px}.lg-logo-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:90%}.lg-logo-experience-title[_ngcontent-%COMP%]{display:block!important;text-align:start!important}.experience-title[_ngcontent-%COMP%]{font-size:1.2rem;text-align:center}.header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.1rem}}@media (min-width:768px){.lg-logo-img[_ngcontent-%COMP%]{display:inline-block!important;margin-right:10px;margin-bottom:0;vertical-align:middle}.lg-logo-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:unset}.lg-logo-experience-title[_ngcontent-%COMP%]{display:inline-block!important}.experience-title[_ngcontent-%COMP%]{font-size:1.3rem;text-align:start}.header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.2rem}}@media (min-width:992px){.lg-logo-img[_ngcontent-%COMP%]{display:inline-block!important;margin-right:20px;margin-bottom:0}.lg-logo-experience-title[_ngcontent-%COMP%]{display:inline-block!important}.experience-title[_ngcontent-%COMP%]{font-size:1.4rem;text-align:start}.header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.3rem}}.experience-title[_ngcontent-%COMP%]{vertical-align:text-top}.dynamic-screen-wrapper[_ngcontent-%COMP%]{overflow-y:auto;padding:1rem}.btn-wrapper[_ngcontent-%COMP%]{width:200px}.btn-control[_ngcontent-%COMP%]{color:#fff;width:50px;height:50px;font-size:25px;line-height:25px;border-radius:2px;margin:4px;box-shadow:2px 2px 20px #000}.btn-close[_ngcontent-%COMP%]{background-color:#dc3545}.fa.fa-bug[_ngcontent-%COMP%]{font-size:10rem;display:block;color:#f44336;text-align:center}.header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{text-align:center}.shadow-on-top-effect[_ngcontent-%COMP%]{box-shadow:4px 0 20px rgba(0,0,0,.4);z-index:1000!important}.hidden-img[_ngcontent-%COMP%]{width:22px;height:22px}.hidden-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:none}.full-screen-btn[_ngcontent-%COMP%]{left:5px}"]],data:{}});function View_PlayerComponent_3(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(_l()(),core.Jb(1,null,[" ",""]))],null,(function(_ck,_v){var _co=_v.component;_ck(_v,1,0,(_co.screen.showTitle&&_co.screen.title?" - ":"")+_co.screen.prompt)}))}function View_PlayerComponent_2(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","title"]],null,null,null,null,null)),(_l()(),core.Jb(1,null,[" "," "])),(_l()(),core.fb(16777216,null,null,1,null,View_PlayerComponent_3)),core.pb(3,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,3,0,"Interactive Image"===_co.screen.templateName&&_co.screen.prompt)}),(function(_ck,_v){var _co=_v.component;_ck(_v,1,0,_co.screen.showTitle&&_co.screen.title||"")}))}function View_PlayerComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,2,"div",[["class","header p-3"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_PlayerComponent_2)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){_ck(_v,2,0,_v.component.screen)}),null)}function View_PlayerComponent_4(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-dynamic-loader",[["class","h-100 w-100"]],null,null,null,View_DynamicLoaderComponent_0,RenderType_DynamicLoaderComponent)),core.pb(1,49152,null,0,dynamic_loader_component_DynamicLoaderComponent,[core.j],{screen:[0,"screen"]},null)],(function(_ck,_v){_ck(_v,1,0,_v.component.screen)}),null)}function View_PlayerComponent_5(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,0,"i",[["class","fa fa-bug"]],null,null,null,null,null)),(_l()(),core.qb(2,0,null,null,1,"p",[],null,null,null,null,null)),(_l()(),core.Jb(-1,null,["Oh snap! You found a bug. Please note down your actions and contact the developers (screen is null)"]))],null,null)}function View_PlayerComponent_6(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,":svg:svg",[["class","bi bi-arrows-fullscreen"],["fill","currentColor"],["height","22"],["viewBox","0 0 16 16"],["width","22"],["xmlns","http://www.w3.org/2000/svg"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,0,":svg:path",[["d","M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"],["fill-rule","evenodd"]],null,null,null,null,null))],null,null)}function View_PlayerComponent_7(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,":svg:svg",[["class","bi bi-arrows-angle-contract"],["fill","currentColor"],["height","22"],["viewBox","0 0 16 16"],["width","22"],["xmlns","http://www.w3.org/2000/svg"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,0,":svg:path",[["d","M.172 15.828a.5.5 0 0 0 .707 0l4.096-4.096V14.5a.5.5 0 1 0 1 0v-3.975a.5.5 0 0 0-.5-.5H1.5a.5.5 0 0 0 0 1h2.768L.172 15.121a.5.5 0 0 0 0 .707zM15.828.172a.5.5 0 0 0-.707 0l-4.096 4.096V1.5a.5.5 0 1 0-1 0v3.975a.5.5 0 0 0 .5.5H14.5a.5.5 0 0 0 0-1h-2.768L15.828.879a.5.5 0 0 0 0-.707z"],["fill-rule","evenodd"]],null,null,null,null,null))],null,null)}function View_PlayerComponent_8(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,0,"img",[["alt","Resume playback"],["height","22"],["src","assets/icons/Play_Mob_button_black.svg"]],null,null,null,null,null))],null,null)}function View_PlayerComponent_9(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,0,"img",[["alt","Pause playback"],["height","22"],["src","assets/icons/Pause_Mob_button_black.svg"]],null,null,null,null,null))],null,null)}function View_PlayerComponent_10(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"button",[["class","btn btn-sm"],["title","Dismiss"],["type","button"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.onFinish()&&ad),ad}),null,null)),(_l()(),core.qb(1,0,null,null,0,"img",[["height","22"],["src","assets/icons/X_Mob_button_black.svg"]],null,null,null,null,null))],null,null)}function View_PlayerComponent_11(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,4,"div",[["class","modal-header"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,1,"h4",[["class","modal-title"],["id","modal-full-screen"]],null,null,null,null,null)),(_l()(),core.Jb(-1,null,["Fullscreen Mode"])),(_l()(),core.qb(3,0,null,null,1,"button",[["aria-label","Close"],["class","btn btn-link text-default p-0 my-auto"],["type","button"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.context.$implicit.dismiss("Cross click")&&ad),ad}),null,null)),(_l()(),core.qb(4,0,null,null,0,"img",[["src","assets/icons/X_Mob_button_black.svg"],["width","20"]],null,null,null,null,null)),(_l()(),core.qb(5,0,null,null,2,"div",[["class","modal-body"]],null,null,null,null,null)),(_l()(),core.qb(6,0,null,null,1,"div",[],null,null,null,null,null)),(_l()(),core.Jb(-1,null,["This experience looks better in fullscreen mode!"])),(_l()(),core.qb(8,0,null,null,4,"div",[["class","modal-footer"]],null,null,null,null,null)),(_l()(),core.qb(9,0,null,null,1,"button",[["class","btn btn-outline-dark"],["type","button"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.context.$implicit.dismiss()&&ad),ad}),null,null)),(_l()(),core.Jb(-1,null,["Cancel"])),(_l()(),core.qb(11,0,null,null,1,"button",[["class","btn btn-outline-dark"],["type","button"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(_v.component.reqFullScreen(),ad=!1!==_v.context.$implicit.dismiss()&&ad),ad}),null,null)),(_l()(),core.Jb(-1,null,["Enter full screen"]))],null,null)}function View_PlayerComponent_0(_l){return core.Lb(0,[core.Hb(671088640,1,{screenWrapper:0}),core.Hb(402653184,2,{modalFullScreen:0}),(_l()(),core.qb(2,0,null,null,35,"div",[["class","d-flex flex-column w-100 h-100 p-0 m-0"]],null,null,null,null,null)),(_l()(),core.qb(3,0,null,null,5,"div",[["class","player-top-bar p-3 m-0 sm-logo-title-wrapper"]],null,null,null,null,null)),(_l()(),core.qb(4,0,null,null,1,"div",[["class","my-auto mr-3"]],null,null,null,null,null)),(_l()(),core.qb(5,0,null,null,0,"img",[["alt",""],["src","assets/images/PPM_logo.jpg"],["width","100"]],null,null,null,null,null)),(_l()(),core.qb(6,0,null,null,2,"div",[["class","my-auto"]],null,null,null,null,null)),(_l()(),core.qb(7,0,null,null,1,"span",[["class","experience-title"]],null,null,null,null,null)),(_l()(),core.Jb(8,null,["",""])),(_l()(),core.fb(16777216,null,null,1,null,View_PlayerComponent_1)),core.pb(10,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(11,0,[[1,0],["screenWrapper",1]],null,6,"div",[["class","d-flex h-100 w-100 m-0 p-0 justify-content-around dynamic-screen-wrapper"]],null,null,null,null,null)),(_l()(),core.qb(12,0,null,null,5,null,null,null,null,null,null,null)),core.pb(13,16384,null,0,common.p,[],{ngSwitch:[0,"ngSwitch"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_PlayerComponent_4)),core.pb(15,278528,null,0,common.q,[core.N,core.K,common.p],{ngSwitchCase:[0,"ngSwitchCase"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_PlayerComponent_5)),core.pb(17,278528,null,0,common.q,[core.N,core.K,common.p],{ngSwitchCase:[0,"ngSwitchCase"]},null),(_l()(),core.qb(18,0,null,null,19,"div",[["class","p-3 player-footer"]],[[2,"shadow-on-top-effect",null]],null,null,null,null)),core.Db(131072,common.b,[core.h]),(_l()(),core.qb(20,0,null,null,4,"div",[["class","my-auto position-absolute full-screen-btn"]],null,null,null,null,null)),(_l()(),core.qb(21,0,null,null,3,"button",[["class","btn btn-link text-dark"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.reqFullScreen()&&ad),ad}),null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_PlayerComponent_6)),core.pb(23,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(_l()(),core.fb(0,[["exitFullScreen",2]],null,0,null,View_PlayerComponent_7)),(_l()(),core.qb(25,0,null,null,12,"div",[["class","d-flex justify-content-center"]],null,null,null,null,null)),(_l()(),core.qb(26,0,null,null,11,"div",[["class","btn-wrapper d-flex justify-content-between align-items-stretch"]],null,null,null,null,null)),(_l()(),core.qb(27,0,null,null,1,"button",[["class","btn btn-sm btn-previous"],["title","Previous Screen"],["type","button"]],[[8,"disabled",0]],[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.getPrevious()&&ad),ad}),null,null)),(_l()(),core.qb(28,0,null,null,0,"img",[["alt","Previous Screen button"],["height","22"],["src","assets/icons/Arrow-Left_Mob_button_black.png"]],null,null,null,null,null)),(_l()(),core.qb(29,0,null,null,4,"button",[["class","btn btn-sm btn-toggle"],["title","Toggle Media Playback"],["type","button"]],[[8,"hidden",0]],[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.togglePlayback()&&ad),ad}),null,null)),(_l()(),core.qb(30,0,null,null,3,"div",[],[[2,"spinner-border",null],[2,"hidden-img",null]],null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_PlayerComponent_8)),core.pb(32,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(_l()(),core.fb(0,[["pauseIcon",2]],null,0,null,View_PlayerComponent_9)),(_l()(),core.qb(34,0,null,null,1,"button",[["class","btn btn-sm btn-next"],["type","button"]],[[8,"disabled",0]],[[null,"click"]],(function(_v,en,$event){var ad=!0,_co=_v.component;return"click"===en&&(ad=!1!==(_co.showCheckMark?_co.onFinish():_co.getNext())&&ad),ad}),null,null)),(_l()(),core.qb(35,0,null,null,0,"img",[["height","22"],["src","assets/icons/Arrow-Right_Mob_button_black.png"]],[[8,"title",0],[8,"alt",0]],null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_PlayerComponent_10)),core.pb(37,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(0,[[2,2],["modalFullScreen",2]],null,0,null,View_PlayerComponent_11))],(function(_ck,_v){var _co=_v.component;_ck(_v,10,0,_co.screen.showTitle&&_co.screen.title||"Interactive Image"===_co.screen.templateName&&_co.screen.prompt),_ck(_v,13,0,!!_co.screen),_ck(_v,15,0,!0),_ck(_v,17,0,!1),_ck(_v,23,0,!_co.inFullScreen,core.Cb(_v,24)),_ck(_v,32,0,_co.playerState===_co.PlayerState.PAUSED||_co.playerState===_co.PlayerState.DISABLED,core.Cb(_v,33)),_ck(_v,37,0,_co.showFinishBtn)}),(function(_ck,_v){var _co=_v.component;_ck(_v,8,0,_co.experienceTitle),_ck(_v,18,0,core.Kb(_v,18,0,core.Cb(_v,19).transform(_co.playerService.screenWrapperIsOverflown))),_ck(_v,27,0,!_co.hasPrevious()),_ck(_v,29,0,_co.playerState===_co.PlayerState.DISABLED),_ck(_v,30,0,_co.mediaIsLoading,_co.mediaIsLoading),_ck(_v,34,0,!_co.hasNext()||_co.showCheckMark),_ck(_v,35,0,core.ub(1,"",_co.showCheckMark?"The experience is finished":"Next Screen",""),core.ub(1,"",_co.showCheckMark?"The experience is finished":"Next Screen",""))}))}function View_PlayerComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,2,"app-player",[],null,[["window","keyup"]],(function(_v,en,$event){var ad=!0;return"window:keyup"===en&&(ad=!1!==core.Cb(_v,2).keyEvent($event)&&ad),ad}),View_PlayerComponent_0,RenderType_PlayerComponent)),core.Gb(512,null,player_service_PlayerService,player_service_PlayerService,[experience_service.a]),core.pb(2,245760,null,0,player_component_PlayerComponent,[experience_service.a,player_service_PlayerService,selected_part_detector_service.a,ng_bootstrap.t],null,null)],(function(_ck,_v){_ck(_v,2,0)}),null)}var PlayerComponentNgFactory=core.mb("app-player",player_component_PlayerComponent,View_PlayerComponent_Host_0,{index:"index",showFinishBtn:"showFinishBtn"},{finished:"finished"},[]),ng_bootstrap_ngfactory=__webpack_require__("9AJC"),of=__webpack_require__("LRne"),operators_map=__webpack_require__("lJxs");class secure_img_src_pipe_SecureImgSrcPipe{constructor(http,sanitizer,appConfig){this.http=http,this.sanitizer=sanitizer,this.appConfig=appConfig}transform(src){return"string"==typeof src&&src.startsWith("http")?this.http.get(src,{responseType:"blob",headers:{Authorization:this.appConfig.authHeader.Authorization}}).pipe(Object(operators_map.a)(val=>this.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(val)))):Object(of.a)(src)}}var http=__webpack_require__("IheW"),platform_browser=__webpack_require__("cUpR"),couch_api_service=__webpack_require__("zEDg"),tslib_es6=__webpack_require__("mrSG");class CharacterQuote{constructor(character,quote){character&&(this.name=character.name,this.image=character.image),quote&&(this.text=quote.text,this.audio=quote.audio)}}let dialogue_component_DialogueComponent=(()=>{let DialogueComponent=class{constructor(assetManager,playerService,changeDetectorRef){this.assetManager=assetManager,this.playerService=playerService,this.changeDetectorRef=changeDetectorRef,this.characterQuotes=[],this.currentQuoteIndex=0,this.onQuotePlaybackEnd=()=>{this.audioRef&&(this.audioRef.nativeElement.removeEventListener("ended",this.onQuotePlaybackEnd),this.nextQuote())},this.togglePlayback=playerState=>{switch(playerState){case PlayerState.PLAYING:if(this.data.quotes){const restartPlayback=this.currentQuoteIndex===this.data.quotes.length;this.currentQuote&&!restartPlayback||(restartPlayback&&(this.currentQuoteIndex=0,this.characterQuotes=[]),this.nextQuote())}else isNaN(this.timeRemaining)&&(this.timeRemaining=3e3);this.audioRef?this.audioRef.nativeElement.play().then(()=>{this.playerService.setMediaAutoplayIsBlocked(!1),this.playerService.setMediaIsLoading(!1)}).catch(e=>{this.playerService.setMediaAutoplayIsBlocked(!0),this.playerService.setMediaIsLoading(!1),this.playerService.setPlayerState(PlayerState.PAUSED)}):(this.timerStart=Date.now(),this.nextQuoteTimer=setTimeout(this.nextQuote,this.timeRemaining));break;case PlayerState.PAUSED:this.audioRef?this.audioRef.nativeElement.pause():isNaN(this.timeRemaining)||(clearTimeout(this.nextQuoteTimer),this.timeRemaining-=Date.now()-this.timerStart)}},this.nextQuote=()=>{if(this.data.quotes&&this.currentQuoteIndex<this.data.quotes.length){const quote=this.data.quotes[this.currentQuoteIndex++],character=this.data.characters.find(other=>other.id===quote.id);this.currentQuote=new CharacterQuote(character,quote),this.characterQuotes.push(this.currentQuote),this.changeDetectorRef.detectChanges(),this.audioRef?(this.audioRef.nativeElement.addEventListener("ended",this.onQuotePlaybackEnd),this.audioRef.nativeElement.play().then(()=>{this.playerService.setMediaAutoplayIsBlocked(!1),this.playerService.setMediaIsLoading(!1)}).catch(e=>{this.playerService.setMediaAutoplayIsBlocked(!0),this.playerService.setMediaIsLoading(!1),this.playerService.setPlayerState(PlayerState.PAUSED)})):(this.timerStart=Date.now(),this.nextQuoteTimer=setTimeout(this.nextQuote,this.timeRemaining=3e3))}else this.onPlaybackEnd()},this.onPlaybackEnd=()=>{this.playerService.setPlaybackEnded()}}set content(audioRef){this.audioRef=audioRef}ngOnInit(){this.data.quotes&&this.data.quotes.length>0&&this.data.quotes[0].audio&&this.playerService.setMediaIsLoading(!0)}ngAfterViewInit(){this.subscription=this.playerService.playbackChanged.subscribe(this.togglePlayback)}imageLoaded(){this.imageWasLoaded=!0}ngOnDestroy(){this.nextQuoteTimer&&clearTimeout(this.nextQuoteTimer),this.subscription.unsubscribe()}};return DialogueComponent=tslib_es6.a([RegisterPreviewComponent(templates.DialogueScreen)],DialogueComponent),DialogueComponent})();var asset_manager_service=__webpack_require__("J13u"),RenderType_DialogueComponent=core.ob({encapsulation:0,styles:[["@media (min-width:200px){.inner-html-font[_ngcontent-%COMP%]{font-size:1.1rem}.custom-p[_ngcontent-%COMP%]{padding:10px}.wrapped-img[_ngcontent-%COMP%]{height:auto;width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;max-height:50vh;-o-object-fit:contain;object-fit:contain}}@media (min-width:768px){.custom-p[_ngcontent-%COMP%]{padding:45px}}@media (min-width:992px){.custom-h[_ngcontent-%COMP%]{height:100%}.wrapped-img[_ngcontent-%COMP%]{height:auto;width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;max-height:100%;-o-object-fit:contain;object-fit:contain}}.image-wrapper[_ngcontent-%COMP%]{text-align:center}.image-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:500px}.quotes-wrapper[_ngcontent-%COMP%]   .quote[_ngcontent-%COMP%]   .avatar-wrapper[_ngcontent-%COMP%]{padding-right:0;padding-top:15px}.quotes-wrapper[_ngcontent-%COMP%]   .quote[_ngcontent-%COMP%]   .avatar-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:38px;height:38px;-o-object-fit:cover;object-fit:cover;padding-left:2px}.quotes-wrapper[_ngcontent-%COMP%]   .quote[_ngcontent-%COMP%]   .text-wrapper[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{color:#747474;display:block;font-size:.8rem}.quotes-wrapper[_ngcontent-%COMP%]   .quote[_ngcontent-%COMP%]   .text-wrapper[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:inline-block;padding:5px 10px;color:#646464;background:#fafafa;border-radius:3px;word-wrap:break-word}"]],data:{}});function View_DialogueComponent_2(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,0,"div",[["class","spinner-border d-flex align-self-center position-absolute"],["role","status"],["style","width: 3rem; height: 3rem;"]],null,null,null,null,null))],null,null)}function View_DialogueComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,5,"div",[["class","custom-h w-100 p-0 d-flex justify-content-around align-self-center"],["style","min-height: 50px;"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_DialogueComponent_2)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(3,0,null,null,2,"img",[["class","wrapped-img"]],[[1,"src",4]],[[null,"load"]],(function(_v,en,$event){var ad=!0;return"load"===en&&(ad=!1!==_v.component.imageLoaded()&&ad),ad}),null,null)),core.Fb(4,1),core.Db(131072,common.b,[core.h])],(function(_ck,_v){_ck(_v,2,0,!_v.component.imageWasLoaded)}),(function(_ck,_v){var _co=_v.component,currVal_1=core.Kb(_v,3,0,core.Cb(_v,5).transform(core.Kb(_v,3,0,_ck(_v,4,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.image)))));_ck(_v,3,0,currVal_1)}))}function View_DialogueComponent_4(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","avatar-wrapper col-auto"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,2,"img",[["class","img-fluid rounded-circle"]],[[1,"src",4]],null,null,null,null)),core.Fb(2,1),core.Db(131072,common.b,[core.h])],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,1,0,core.Cb(_v,3).transform(core.Kb(_v,1,0,_ck(_v,2,0,core.Cb(_v.parent.parent,0),_co.assetManager.getAssetURL(_v.parent.context.$implicit.image)))));_ck(_v,1,0,currVal_0)}))}function View_DialogueComponent_3(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,7,"div",[["class","quote row m-0"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_DialogueComponent_4)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(3,0,null,null,4,"div",[["class","text-wrapper col"]],null,null,null,null,null)),(_l()(),core.qb(4,0,null,null,1,"span",[["class","name"]],null,null,null,null,null)),(_l()(),core.Jb(5,null,["",""])),(_l()(),core.qb(6,0,null,null,1,"p",[["class","text"]],null,null,null,null,null)),(_l()(),core.Jb(7,null,["",""]))],(function(_ck,_v){_ck(_v,2,0,_v.context.$implicit.image)}),(function(_ck,_v){_ck(_v,5,0,_v.context.$implicit.name),_ck(_v,7,0,_v.context.$implicit.text)}))}function View_DialogueComponent_5(_l){return core.Lb(0,[(_l()(),core.qb(0,0,[[1,0],["audioRef",1]],null,3,"audio",[["autoplay",""],["controls",""],["hidden",""],["preload","auto"]],[[1,"src",4]],null,null,null,null)),core.Fb(1,1),core.Db(131072,common.b,[core.h]),(_l()(),core.Jb(-1,null,[" Sorry, your browser does not support HTML5 audio.\n"]))],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,0,0,core.Cb(_v,2).transform(core.Kb(_v,0,0,_ck(_v,1,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.currentQuote.audio)))));_ck(_v,0,0,currVal_0)}))}function View_DialogueComponent_0(_l){return core.Lb(0,[core.Db(0,secure_img_src_pipe_SecureImgSrcPipe,[http.c,platform_browser.b,couch_api_service.a]),core.Hb(671088640,1,{content:0}),(_l()(),core.qb(2,0,[["cont",1]],null,7,"div",[["class","h-100 w-100 d-flex justify-content-around"],["style","overflow-y: auto;"]],[[8,"scrollTop",0]],null,null,null,null)),(_l()(),core.qb(3,0,null,null,6,"div",[["class","h-100 w-100 d-flex justify-content-around row row-cols-lg-2 row-cols-md-1"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_DialogueComponent_1)),core.pb(5,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(6,0,[["dialogueWrapper",1]],null,3,"div",[["class","custom-h custom-p d-flex justify-content-start align-items-start"],["style","overflow-y: auto;"]],[[8,"scrollTop",0]],null,null,null,null)),(_l()(),core.qb(7,0,null,null,2,"div",[["class","quotes-wrapper"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_DialogueComponent_3)),core.pb(9,278528,null,0,common.k,[core.N,core.K,core.r],{ngForOf:[0,"ngForOf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_DialogueComponent_5)),core.pb(11,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,5,0,_co.data.image),_ck(_v,9,0,_co.characterQuotes),_ck(_v,11,0,_co.currentQuote&&_co.currentQuote.audio)}),(function(_ck,_v){_ck(_v,2,0,core.Cb(_v,2).scrollHeight),_ck(_v,6,0,core.Cb(_v,6).scrollHeight)}))}function View_DialogueComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-screen-dialogue",[],null,null,null,View_DialogueComponent_0,RenderType_DialogueComponent)),core.pb(1,4440064,null,0,dialogue_component_DialogueComponent,[asset_manager_service.a,player_service_PlayerService,core.h],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var DialogueComponentNgFactory=core.mb("app-screen-dialogue",dialogue_component_DialogueComponent,View_DialogueComponent_Host_0,{data:"data"},{},[]),leaflet_src=__webpack_require__("4R65"),LeafletUtil=function(){function LeafletUtil(){}return LeafletUtil.mapToArray=function(map){var toReturn=[];for(var k in map)map.hasOwnProperty(k)&&toReturn.push(map[k]);return toReturn},LeafletUtil.handleEvent=function(zone,eventEmitter,event){0<eventEmitter.observers.length&&zone.run((function(){eventEmitter.emit(event)}))},LeafletUtil}(),leaflet_directive_LeafletDirective=function(){function LeafletDirective(element,zone){this.element=element,this.zone=zone,this.DEFAULT_ZOOM=1,this.DEFAULT_CENTER=Object(leaflet_src.latLng)(38.907192,-77.036871),this.DEFAULT_FPZ_OPTIONS={},this.fitBoundsOptions=this.DEFAULT_FPZ_OPTIONS,this.panOptions=this.DEFAULT_FPZ_OPTIONS,this.zoomOptions=this.DEFAULT_FPZ_OPTIONS,this.zoomPanOptions=this.DEFAULT_FPZ_OPTIONS,this.options={},this.mapReady=new core.m,this.zoomChange=new core.m,this.centerChange=new core.m,this.onClick=new core.m,this.onDoubleClick=new core.m,this.onMouseDown=new core.m,this.onMouseUp=new core.m,this.onMouseMove=new core.m,this.onMouseOver=new core.m,this.onMouseOut=new core.m,this.onMapMove=new core.m,this.onMapMoveStart=new core.m,this.onMapMoveEnd=new core.m,this.onMapZoom=new core.m,this.onMapZoomStart=new core.m,this.onMapZoomEnd=new core.m}return LeafletDirective.prototype.ngOnInit=function(){var _this=this;this.zone.runOutsideAngular((function(){_this.map=Object(leaflet_src.map)(_this.element.nativeElement,_this.options),_this.addMapEventListeners()})),null!=this.center&&null!=this.zoom&&this.setView(this.center,this.zoom),null!=this.fitBounds&&this.setFitBounds(this.fitBounds),null!=this.maxBounds&&this.setMaxBounds(this.maxBounds),null!=this.minZoom&&this.setMinZoom(this.minZoom),null!=this.maxZoom&&this.setMaxZoom(this.maxZoom),this.doResize(),this.mapReady.emit(this.map)},LeafletDirective.prototype.ngOnChanges=function(changes){changes.zoom&&changes.center&&null!=this.zoom&&null!=this.center?this.setView(changes.center.currentValue,changes.zoom.currentValue):changes.zoom?this.setZoom(changes.zoom.currentValue):changes.center&&this.setCenter(changes.center.currentValue),changes.fitBounds&&this.setFitBounds(changes.fitBounds.currentValue),changes.maxBounds&&this.setMaxBounds(changes.maxBounds.currentValue),changes.minZoom&&this.setMinZoom(changes.minZoom.currentValue),changes.maxZoom&&this.setMaxZoom(changes.maxZoom.currentValue)},LeafletDirective.prototype.getMap=function(){return this.map},LeafletDirective.prototype.onResize=function(){this.delayResize()},LeafletDirective.prototype.addMapEventListeners=function(){var _this=this;this.map.on("click",(function(e){return LeafletUtil.handleEvent(_this.zone,_this.onClick,e)})),this.map.on("dblclick",(function(e){return LeafletUtil.handleEvent(_this.zone,_this.onDoubleClick,e)})),this.map.on("mousedown",(function(e){return LeafletUtil.handleEvent(_this.zone,_this.onMouseDown,e)})),this.map.on("mouseup",(function(e){return LeafletUtil.handleEvent(_this.zone,_this.onMouseUp,e)})),this.map.on("mouseover",(function(e){return LeafletUtil.handleEvent(_this.zone,_this.onMouseOver,e)})),this.map.on("mouseout",(function(e){return LeafletUtil.handleEvent(_this.zone,_this.onMouseOut,e)})),this.map.on("mousemove",(function(e){return LeafletUtil.handleEvent(_this.zone,_this.onMouseMove,e)})),this.map.on("zoomstart",(function(e){return LeafletUtil.handleEvent(_this.zone,_this.onMapZoomStart,e)})),this.map.on("zoom",(function(e){return LeafletUtil.handleEvent(_this.zone,_this.onMapZoom,e)})),this.map.on("zoomend",(function(e){return LeafletUtil.handleEvent(_this.zone,_this.onMapZoomEnd,e)})),this.map.on("movestart",(function(e){return LeafletUtil.handleEvent(_this.zone,_this.onMapMoveStart,e)})),this.map.on("move",(function(e){return LeafletUtil.handleEvent(_this.zone,_this.onMapMove,e)})),this.map.on("moveend",(function(e){return LeafletUtil.handleEvent(_this.zone,_this.onMapMoveEnd,e)})),this.map.on("zoomend moveend",(function(){var zoom=_this.map.getZoom();zoom!==_this.zoom&&(_this.zoom=zoom,LeafletUtil.handleEvent(_this.zone,_this.zoomChange,zoom));var center=_this.map.getCenter();null==center&&null==_this.center||(null!=center&&null!=_this.center||center===_this.center)&&center.lat===_this.center.lat&&center.lng===_this.center.lng||(_this.center=center,LeafletUtil.handleEvent(_this.zone,_this.centerChange,center))}))},LeafletDirective.prototype.doResize=function(){var _this=this;this.zone.runOutsideAngular((function(){_this.map.invalidateSize({})}))},LeafletDirective.prototype.delayResize=function(){null!=this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(this.doResize.bind(this),200)},LeafletDirective.prototype.setView=function(center,zoom){this.map&&null!=center&&null!=zoom&&this.map.setView(center,zoom,this.zoomPanOptions)},LeafletDirective.prototype.setZoom=function(zoom){this.map&&null!=zoom&&this.map.setZoom(zoom,this.zoomOptions)},LeafletDirective.prototype.setCenter=function(center){this.map&&null!=center&&this.map.panTo(center,this.panOptions)},LeafletDirective.prototype.setFitBounds=function(latLngBounds){this.map&&null!=latLngBounds&&this.map.fitBounds(latLngBounds,this.fitBoundsOptions)},LeafletDirective.prototype.setMaxBounds=function(latLngBounds){this.map&&null!=latLngBounds&&this.map.setMaxBounds(latLngBounds)},LeafletDirective.prototype.setMinZoom=function(zoom){this.map&&null!=zoom&&this.map.setMinZoom(zoom)},LeafletDirective.prototype.setMaxZoom=function(zoom){this.map&&null!=zoom&&this.map.setMaxZoom(zoom)},LeafletDirective}(),LeafletDirectiveWrapper=function(){function LeafletDirectiveWrapper(leafletDirective){this.leafletDirective=leafletDirective}return LeafletDirectiveWrapper.prototype.init=function(){},LeafletDirectiveWrapper.prototype.getMap=function(){return this.leafletDirective.getMap()},LeafletDirectiveWrapper}(),leaflet_layers_directive_LeafletLayersDirective=function(){function LeafletLayersDirective(leafletDirective,differs,zone){this.differs=differs,this.zone=zone,this.leafletDirective=new LeafletDirectiveWrapper(leafletDirective),this.layersDiffer=this.differs.find([]).create()}return Object.defineProperty(LeafletLayersDirective.prototype,"layers",{get:function(){return this.layersValue},set:function(v){this.layersValue=v,this.updateLayers()},enumerable:!0,configurable:!0}),LeafletLayersDirective.prototype.ngDoCheck=function(){this.updateLayers()},LeafletLayersDirective.prototype.ngOnInit=function(){this.leafletDirective.init(),this.updateLayers()},LeafletLayersDirective.prototype.ngOnDestroy=function(){this.layers=[]},LeafletLayersDirective.prototype.updateLayers=function(){var map=this.leafletDirective.getMap();if(null!=map&&null!=this.layersDiffer){var changes_1=this.layersDiffer.diff(this.layersValue);null!=changes_1&&this.zone.runOutsideAngular((function(){changes_1.forEachRemovedItem((function(c){map.removeLayer(c.item)})),changes_1.forEachAddedItem((function(c){map.addLayer(c.item)}))}))}},LeafletLayersDirective}();let guide_me_component_GuideMeComponent=(()=>{let GuideMeComponent=class{constructor(playerService){this.playerService=playerService,this.leafletOptions={layers:[leaflet_src.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:20,attribution:'&copy; <a href="https://www.openstreetmap.copyright">OpenStreetMap</a> contributors'})],zoom:10,center:leaflet_src.latLng(51.5074,.1278),attributionControl:!0},this.findMyLocationControl=new(leaflet_src.Control.extend({options:{position:"topleft"},onAdd:map=>{const container=leaflet_src.DomUtil.create("div","leaflet-bar");return container.innerHTML='<a href="javascript:void(0)" title="Locate Me" role="button" aria-label="Locate Me"><i class="fa fa-location-arrow"></i></a>',container.style.backgroundColor="white",container.style.width="34px",container.style.height="34px",container.style.lineHeight="30px",container.style.fontSize="16px",container.style.border="2px solid rgba(0, 0, 0, 0.2)",container.onclick=_=>{this.leafletMap.on("locationfound",event=>{const location=event.latlng,marker=leaflet_src.marker(location,{icon:leaflet_src.icon({iconSize:[25,41],iconAnchor:[13,41],iconUrl:"assets/marker-icon.png",shadowUrl:"assets/marker-shadow.png"})});this.layers.push(marker);const radius=event.accuracy/2;marker.bindPopup("You are within "+radius+" meters from this point").openPopup();const circle=leaflet_src.circle(location,radius);this.layers.push(circle)}),this.leafletMap.locate({setView:!0,watch:!1,maxZoom:12})},container}})),this.layers=[],this.onPlaybackEnd=()=>{this.playerService.setPlaybackEnded()},this.onLocationFound=event=>{this.currentPosition&&(this.leafletMap.removeLayer(this.currentPosition),delete this.currentPosition,this.leafletMap.removeLayer(this.currentAccuracy),delete this.currentAccuracy);const location=event.latlng,radius=event.accuracy/2,modalBodiesArray=document.getElementsByClassName("modal-body");void 0!==this.data.area&&(this.data.area.contains(location)?(modalBodiesArray.length>0&&(modalBodiesArray[0].style.backgroundColor="greenyellow"),this.data.autoProceed?this.playerService.setPlaybackEnded():this.selectedAreaLayer.setStyle({color:"green"})):modalBodiesArray.length>0&&(modalBodiesArray[0].style.backgroundColor="crimson")),this.accuracy=radius,this.lastUpdate=new Date,this.currentPosition=leaflet_src.marker(location,{icon:leaflet_src.icon({iconSize:[25,41],iconAnchor:[13,41],iconUrl:"assets/marker-icon.png",shadowUrl:"assets/marker-shadow.png"})}),this.currentPosition.bindPopup("You are within "+radius+" meters from this point").openPopup(),this.currentPosition.addTo(this.leafletMap),this.currentAccuracy=leaflet_src.circle(location,radius),this.currentAccuracy.addTo(this.leafletMap),this.layers.push(this.currentAccuracy)},this.onLocationError=e=>{console.error(e.message)}}ngOnInit(){this.originalPlayerState=this.playerService.getPlayerState(),this.playerService.setPlayerState(PlayerState.DISABLED)}ngAfterViewInit(){if(this.leafletMap.invalidateSize(),this.data.area){let layer;const shapeOptions={color:"#97009c",weight:2,fillOpacity:.5};if("rectangle"===this.data.area.type){const bounds=this.data.area.latlngs.map(latlng=>[latlng.lat,latlng.lng]);layer=leaflet_src.rectangle(bounds,shapeOptions)}else if("polygon"===this.data.area.type){const bounds=this.data.area.latlngs.map(latlng=>[latlng.lat,latlng.lng]);layer=leaflet_src.polygon(bounds,shapeOptions)}else if("circle"===this.data.area.type){const circle=this.data.area;layer=leaflet_src.circle(circle.center,Object.assign({radius:circle.radius},shapeOptions))}this.selectedAreaLayer=layer,this.layers.push(layer)}}contains(point){return!!this.data.area&&this.data.area.contains(point)}onMapReady(leafletMap){this.leafletMap=leafletMap,this.data.area&&(this.leafletMap.panTo([this.data.area.center.lat,this.data.area.center.lng]),this.leafletMap.setZoom(19)),this.leafletMap.on("locationfound",this.onLocationFound),this.leafletMap.on("locationerror",this.onLocationError),this.leafletMap.locate({setView:!1,maxZoom:18,watch:!0,enableHighAccuracy:!0})}ngOnDestroy(){this.leafletMap&&(this.leafletMap.stopLocate(),this.leafletMap.off("locationfound",this.onLocationFound),this.leafletMap.off("locationerror",this.onLocationError)),this.playerService.setPlayerState(this.originalPlayerState)}};return GuideMeComponent=tslib_es6.a([RegisterPreviewComponent(templates.GuideMeScreen)],GuideMeComponent),GuideMeComponent})();var RenderType_GuideMeComponent=core.ob({encapsulation:0,styles:[[""]],data:{}});function View_GuideMeComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,4,"div",[["class","guideme-prompt prompt w-100 d-flex align-items-center p-lg-2 p-1"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,1,"div",[["class","d-flex flex-shrink px-4 h2 my-auto"]],null,null,null,null,null)),(_l()(),core.qb(2,0,null,null,0,"i",[["class","fa fa-info-circle"]],null,null,null,null,null)),(_l()(),core.qb(3,0,null,null,1,"div",[["class","small"]],null,null,null,null,null)),(_l()(),core.Jb(4,null,["",""]))],null,(function(_ck,_v){_ck(_v,4,0,_v.component.data.prompt)}))}function View_GuideMeComponent_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,5,"div",[["class","h-100 w-100 guide-me-screen-template-preview d-flex flex-column position-relative"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_GuideMeComponent_1)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(3,0,null,null,2,"div",[["class","h-100 w-100"],["leaflet",""]],null,[[null,"leafletMapReady"],["window","resize"]],(function(_v,en,$event){var ad=!0,_co=_v.component;return"window:resize"===en&&(ad=!1!==core.Cb(_v,4).onResize()&&ad),"leafletMapReady"===en&&(ad=!1!==_co.onMapReady($event)&&ad),ad}),null,null)),core.pb(4,606208,null,0,leaflet_directive_LeafletDirective,[core.k,core.y],{options:[0,"options"]},{mapReady:"leafletMapReady"}),core.pb(5,475136,null,0,leaflet_layers_directive_LeafletLayersDirective,[leaflet_directive_LeafletDirective,core.r,core.y],{layers:[0,"layers"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,2,0,_co.data.prompt),_ck(_v,4,0,_co.leafletOptions),_ck(_v,5,0,_co.layers)}),null)}function View_GuideMeComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-screen-guide-me",[],null,null,null,View_GuideMeComponent_0,RenderType_GuideMeComponent)),core.pb(1,4440064,null,0,guide_me_component_GuideMeComponent,[player_service_PlayerService],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var GuideMeComponentNgFactory=core.mb("app-screen-guide-me",guide_me_component_GuideMeComponent,View_GuideMeComponent_Host_0,{data:"data"},{},[]),angular_font_awesome=__webpack_require__("z16Y"),RenderType_AngularFontAwesomeComponent=core.ob({encapsulation:0,styles:[""],data:{}});function View_AngularFontAwesomeComponent_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,2,"i",[["aria-hidden","true"]],null,null,null,null,null)),core.Gb(512,null,common.C,common.D,[core.r,core.s,core.k,core.C]),core.pb(2,278528,null,0,common.j,[common.C],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,2,0,core.ub(1,"fa fa-",_co.name,""),_co.optionalClasses)}),null)}var image_map_highlighter_css_ngstyle_styles=[".map-container{background-size:contain;position:absolute;background-position:center;background-repeat:no-repeat}.map-container canvas{position:absolute}.map-container+img{opacity:0}area:hover{cursor:pointer}"];class ScalePipe{transform(coords,ratio){return coords.map(point=>`${Math.round(point.x*ratio)}, ${Math.round(point.y*ratio)}`).join()}}var hotspot_editor=__webpack_require__("i+YC"),image_map_highlighter=__webpack_require__("tSBN");class interactive_image_component_Area{constructor(pointOfInterest){this.shape="poly";const poly=pointOfInterest.polygon;try{this.centroid=poly.getCentroid()}catch(e){const factory=new hotspot_editor.c,boundingBox=pointOfInterest.polygon.boundingBox;factory.add(boundingBox.lowerBound),factory.add(new hotspot_editor.a(boundingBox.upperBound.x,boundingBox.lowerBound.y)),factory.add(boundingBox.upperBound),factory.add(new hotspot_editor.a(boundingBox.lowerBound.x,boundingBox.upperBound.y)),this.centroid=factory.build().getCentroid()}const sides=poly.sides;this.coords=[sides[0].start].concat(sides.map(side=>side.end)),this.title=pointOfInterest.title,this.text=pointOfInterest.text,this.audio=pointOfInterest.audio}}let interactive_image_component_InteractiveImageComponent=(()=>{let InteractiveImageComponent=class{constructor(assetManager,changeDetectorRef,playerService){this.assetManager=assetManager,this.changeDetectorRef=changeDetectorRef,this.playerService=playerService,this.onLoad=()=>{const imageElement=this.imageRef.nativeElement;this.ratio=imageElement.width/imageElement.naturalWidth,this.data.pointsOfInterest&&(this.areas=this.data.pointsOfInterest.map(pointOfInterest=>new interactive_image_component_Area(pointOfInterest)),this.changeDetectorRef.detectChanges(),this.highlighter=new image_map_highlighter(imageElement,{fill:!0,fillColor:"007bff",fillOpacity:.2,strokeColor:"dc3545",strokeOpacity:1,alwaysOn:!0}),this.highlighter.init())},this.onEnded=()=>{this.playerService.setPlayerState(PlayerState.PAUSED)},this.togglePlayback=playerState=>{switch(playerState){case PlayerState.PLAYING:this.audioRef&&this.audioRef.nativeElement.play().then(()=>{this.playerService.setMediaAutoplayIsBlocked(!1),this.playerService.setMediaIsLoading(!1)}).catch(e=>{this.playerService.setMediaAutoplayIsBlocked(!0),this.playerService.setMediaIsLoading(!1),this.playerService.setPlayerState(PlayerState.PAUSED)});break;case PlayerState.PAUSED:this.audioRef&&this.audioRef.nativeElement.pause()}}}set _imageRef(imageRef){this.imageElementMutationObserver&&(this.imageElementMutationObserver.disconnect(),delete this.imageElementMutationObserver),this.imageRef=imageRef,this.imageRef?(this.imageRef.nativeElement.addEventListener("load",this.onLoad),this.imageElementMutationObserver=new MutationObserver(mutations=>{mutations.forEach(mutation=>{"src"===mutation.attributeName&&(this.imageWasLoaded=!1,this.highlighter&&this.highlighter.destroy(),this.setArea())})}),this.imageElementMutationObserver.observe(this.imageRef.nativeElement,{attributes:!0})):(this.setArea(),this.changeDetectorRef.detectChanges())}set _audioRef(audioRef){this.audioElementMutationObserver&&(this.audioElementMutationObserver.disconnect(),delete this.audioElementMutationObserver),this.audioRef=audioRef,this.audioRef?(this.audioElementMutationObserver=new MutationObserver(mutations=>{mutations.forEach(mutation=>{"src"===mutation.attributeName&&(this.playerService.getPlayerState()!==PlayerState.PLAYING?this.playerService.setPlayerState(PlayerState.PLAYING):this.togglePlayback(PlayerState.PLAYING))})}),this.audioElementMutationObserver.observe(this.audioRef.nativeElement,{attributes:!0}),this.audioRef.nativeElement.addEventListener("ended",this.onEnded),this.playerService.setPlayerState(PlayerState.PLAYING)):this.playerService.getPlayerState()!==PlayerState.DISABLED&&this.playerService.setPlayerState(PlayerState.DISABLED)}ngOnInit(){this.originalPlayerState=this.playerService.getPlayerState(),this.playerService.setPlayerState(PlayerState.DISABLED)}ngAfterViewInit(){this.subscription=this.playerService.playbackChanged.subscribe(this.togglePlayback)}imageLoaded(){this.imageWasLoaded=!0}setArea(area){if(this.area=area,this.area){this.area.audio&&this.playerService.setMediaIsLoading(!0);const imageElement=this.imageRef.nativeElement;this.popoverStyle={top:imageElement.offsetTop+Math.round(this.area.centroid.y*this.ratio)+"px",left:imageElement.offsetLeft+Math.round(this.area.centroid.x*this.ratio)-10+"px"}}}onResize(event){const imageElement=this.imageRef.nativeElement;this.ratio=imageElement.width/imageElement.naturalWidth,this.popoverStyle&&(this.popoverStyle={top:imageElement.offsetTop+Math.round(this.area.centroid.y*this.ratio)+"px",left:imageElement.offsetLeft+Math.round(this.area.centroid.x*this.ratio)-10+"px"}),this.changeDetectorRef.detectChanges(),this.highlighter.reDrawCanvas()}ngOnDestroy(){this.audioElementMutationObserver&&this.audioElementMutationObserver.disconnect(),this.imageElementMutationObserver&&this.imageElementMutationObserver.disconnect(),this.audioRef&&this.audioRef.nativeElement.removeEventListener("ended",this.onEnded),this.imageRef&&this.imageRef.nativeElement.removeEventListener("load",this.onLoad),this.subscription.unsubscribe(),this.playerService.setPlayerState(this.originalPlayerState)}};return InteractiveImageComponent=tslib_es6.a([RegisterPreviewComponent(templates.InteractiveImageScreen)],InteractiveImageComponent),InteractiveImageComponent})();var RenderType_InteractiveImageComponent=core.ob({encapsulation:2,styles:[[".image-wrapper{max-width:100%;width:-webkit-max-content;width:-moz-max-content;width:max-content;height:auto;margin:0 auto}.popover{border-radius:0;min-width:100px}.popover .close{margin:3px 6px 0;font-size:1.3rem}.popover .arrow::after{border-bottom-color:#f7f7f7}.popover .popover-header{padding:.4rem;font-size:14px;font-weight:500;border-radius:0}.popover .popover-body{padding:.4rem;margin:.2rem;font-size:13px;max-height:250px;overflow:auto}.not-set{color:#dd810b;font-size:14px}.not-set fa{margin-right:5px}.wrapped-img{max-height:100%;max-width:100%;-o-object-fit:contain;object-fit:contain}"],image_map_highlighter_css_ngstyle_styles],data:{}});function View_InteractiveImageComponent_2(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,0,"div",[["class","spinner-border d-flex align-self-center position-absolute"],["role","status"],["style","width: 3rem; height: 3rem;"]],null,null,null,null,null))],null,null)}function View_InteractiveImageComponent_3(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"area",[],[[1,"id",0],[1,"shape",0],[1,"alt",0],[8,"coords",0]],[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.setArea(_v.context.$implicit)&&ad),ad}),null,null)),core.Fb(1,2)],null,(function(_ck,_v){var _co=_v.component,currVal_0="area"+_v.context.index,currVal_1=_v.context.$implicit.shape,currVal_2=_v.context.$implicit.title,currVal_3=core.ub(1,"",core.Kb(_v,0,3,_ck(_v,1,0,core.Cb(_v.parent.parent,1),_v.context.$implicit.coords,_co.ratio)),"");_ck(_v,0,0,currVal_0,currVal_1,currVal_2,currVal_3)}))}function View_InteractiveImageComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,8,"div",[["class","h-100 w-100 d-flex justify-content-center align-items-center"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_InteractiveImageComponent_2)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(3,0,[[1,0],["imageRef",1]],null,2,"img",[["class","wrapped-img"],["usemap","#map"]],[[1,"src",4]],[[null,"load"]],(function(_v,en,$event){var ad=!0;return"load"===en&&(ad=!1!==_v.component.imageLoaded()&&ad),ad}),null,null)),core.Fb(4,1),core.Db(131072,common.b,[core.h]),(_l()(),core.qb(6,0,null,null,2,"map",[["name","map"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_InteractiveImageComponent_3)),core.pb(8,278528,null,0,common.k,[core.N,core.K,core.r],{ngForOf:[0,"ngForOf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,2,0,!_co.imageWasLoaded),_ck(_v,8,0,_co.areas)}),(function(_ck,_v){var _co=_v.component,currVal_1=core.Kb(_v,3,0,core.Cb(_v,5).transform(core.Kb(_v,3,0,_ck(_v,4,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.image)))));_ck(_v,3,0,currVal_1)}))}function View_InteractiveImageComponent_4(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"span",[["class","not-set"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,1,"fa",[["name","exclamation-triangle"]],null,null,null,View_AngularFontAwesomeComponent_0,RenderType_AngularFontAwesomeComponent)),core.pb(2,114688,null,0,angular_font_awesome.a,[],{name:[0,"name"]},null),(_l()(),core.Jb(-1,null,["No image has been set. "]))],(function(_ck,_v){_ck(_v,2,0,"exclamation-triangle")}),null)}function View_InteractiveImageComponent_6(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"div",[["class","popover-body"]],null,null,null,null,null)),(_l()(),core.Jb(1,null,["",""]))],null,(function(_ck,_v){_ck(_v,1,0,_v.component.area.text)}))}function View_InteractiveImageComponent_5(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,10,"div",[["class","popover fade bs-popover-bottom show"]],null,null,null,null,null)),core.Gb(512,null,common.E,common.F,[core.k,core.s,core.C]),core.pb(2,278528,null,0,common.o,[common.E],{ngStyle:[0,"ngStyle"]},null),(_l()(),core.qb(3,0,null,null,0,"div",[["class","arrow"]],null,null,null,null,null)),(_l()(),core.qb(4,0,null,null,2,"button",[["class","close float-right"],["type","button"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.setArea()&&ad),ad}),null,null)),(_l()(),core.qb(5,0,null,null,1,"span",[],null,null,null,null,null)),(_l()(),core.Jb(-1,null,["\xd7"])),(_l()(),core.qb(7,0,null,null,1,"div",[["class","popover-header clearfix"]],null,null,null,null,null)),(_l()(),core.Jb(8,null,["",""])),(_l()(),core.fb(16777216,null,null,1,null,View_InteractiveImageComponent_6)),core.pb(10,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,2,0,_co.popoverStyle),_ck(_v,10,0,_co.area.text)}),(function(_ck,_v){_ck(_v,8,0,_v.component.area.title||"")}))}function View_InteractiveImageComponent_7(_l){return core.Lb(0,[(_l()(),core.qb(0,0,[[2,0],["audioRef",1]],null,3,"audio",[["autoplay",""],["controls",""],["hidden",""],["preload","auto"]],[[1,"src",4]],null,null,null,null)),core.Fb(1,1),core.Db(131072,common.b,[core.h]),(_l()(),core.Jb(-1,null,[" Sorry, your browser does not support HTML5 audio.\n"]))],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,0,0,core.Cb(_v,2).transform(core.Kb(_v,0,0,_ck(_v,1,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.area.audio)))));_ck(_v,0,0,currVal_0)}))}function View_InteractiveImageComponent_0(_l){return core.Lb(0,[core.Db(0,secure_img_src_pipe_SecureImgSrcPipe,[http.c,platform_browser.b,couch_api_service.a]),core.Db(0,ScalePipe,[]),core.Hb(671088640,1,{_imageRef:0}),core.Hb(671088640,2,{_audioRef:0}),(_l()(),core.qb(4,0,null,null,6,"div",[["class","h-100 w-100"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_InteractiveImageComponent_1)),core.pb(6,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_InteractiveImageComponent_4)),core.pb(8,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_InteractiveImageComponent_5)),core.pb(10,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_InteractiveImageComponent_7)),core.pb(12,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,6,0,_co.data.image),_ck(_v,8,0,!_co.data.image),_ck(_v,10,0,_co.area),_ck(_v,12,0,_co.area&&_co.area.audio)}),null)}function View_InteractiveImageComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-screen-interactive-image",[],null,[["window","resize"]],(function(_v,en,$event){var ad=!0;return"window:resize"===en&&(ad=!1!==core.Cb(_v,1).onResize($event)&&ad),ad}),View_InteractiveImageComponent_0,RenderType_InteractiveImageComponent)),core.pb(1,4440064,null,0,interactive_image_component_InteractiveImageComponent,[asset_manager_service.a,core.h,player_service_PlayerService],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var InteractiveImageComponentNgFactory=core.mb("app-screen-interactive-image",interactive_image_component_InteractiveImageComponent,View_InteractiveImageComponent_Host_0,{data:"data"},{},[]);let interactive_book_component_InteractiveBookComponent=(()=>{let InteractiveBookComponent=class{constructor(assetManager,playerService,toastService){this.assetManager=assetManager,this.playerService=playerService,this.toastService=toastService,this.defaultTouch={x:0,y:0,time:0}}set _intImgDiv(intImgDiv){this.intImgDiv=intImgDiv,this.intImgDiv&&(this.intImgDiv.nativeElement.addEventListener("touchstart",event=>{let touch=event.touches[0]||event.changedTouches[0];this.defaultTouch.x=touch.pageX,this.defaultTouch.y=touch.pageY,this.defaultTouch.time=event.timeStamp}),this.intImgDiv.nativeElement.addEventListener("touchend",event=>{let deltaX=(event.touches[0]||event.changedTouches[0]).pageX-this.defaultTouch.x;event.timeStamp-this.defaultTouch.time<500&&Math.abs(deltaX)>60&&(deltaX>0?this.previousPage():this.nextPage()),this.defaultTouch={x:0,y:0,time:0}}))}ngOnInit(){this.originalPlayerState=this.playerService.getPlayerState(),this.toastService.info("Tap to open!"),this.closeBook()}imageLoaded(){this.imageWasLoaded=!0}previousPage(){this.currentPageIndex=((this.currentPageIndex>0?this.currentPageIndex:this.data.pages.length)-1)%this.data.pages.length}nextPage(){this.currentPageIndex=(this.currentPageIndex+1)%this.data.pages.length}jumpToPage(pIndex){this.currentPageIndex=pIndex}openBook(){const pages=this.data.pages;this.isOpen=!!pages&&pages.length>0}closeBook(){this.isOpen=!1,this.currentPageIndex=0,this.playerService.getPlayerState()!==PlayerState.DISABLED&&this.playerService.setPlayerState(PlayerState.DISABLED)}ngOnDestroy(){this.playerService.setPlayerState(this.originalPlayerState)}};return InteractiveBookComponent=tslib_es6.a([RegisterPreviewComponent(templates.InteractiveBookScreen)],InteractiveBookComponent),InteractiveBookComponent})();var ngx_toastr=__webpack_require__("EApP"),RenderType_InteractiveBookComponent=core.ob({encapsulation:0,styles:[["@media (min-width:200px){.int-book-container[_ngcontent-%COMP%]{height:unset}.btn-next[_ngcontent-%COMP%], .btn-previous[_ngcontent-%COMP%]{display:none}}@media (min-width:768px){.int-book-container[_ngcontent-%COMP%]{height:100%}.btn-next[_ngcontent-%COMP%], .btn-previous[_ngcontent-%COMP%]{display:block}}@media (min-width:992px){.custom-h[_ngcontent-%COMP%]{height:100%}}.book-cover[_ngcontent-%COMP%]{text-align:center;padding:10px}.book-cover[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{box-shadow:3px 3px 15px #333;opacity:.8}.book-cover[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{cursor:pointer;opacity:1;transition:all linear .2s}.book-content[_ngcontent-%COMP%]   .controls-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-items:stretch;width:100%;overflow-x:auto}.book-content[_ngcontent-%COMP%]   .controls-wrapper[_ngcontent-%COMP%]   .interactive-image-wrapper[_ngcontent-%COMP%]{position:relative;min-width:0;flex:1 1 0px}.book-content[_ngcontent-%COMP%]   .controls-wrapper[_ngcontent-%COMP%]   .interactive-image-wrapper[_ngcontent-%COMP%]   .page-indicator[_ngcontent-%COMP%]{position:absolute;z-index:100;bottom:10px;right:10px;color:#fafafa;background-color:rgba(0,0,0,.2);padding:4px 6px;font-size:10px}.book-content[_ngcontent-%COMP%]   .controls-wrapper[_ngcontent-%COMP%]   .interactive-image-wrapper[_ngcontent-%COMP%]   .page-indicator[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.4)}.book-content[_ngcontent-%COMP%]   .controls-wrapper[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{top:0;bottom:0;width:5%;min-width:25px;padding:0;color:#9f9d9d;border-radius:0;font-size:x-large}.book-content[_ngcontent-%COMP%]   .controls-wrapper[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover:not(:disabled){color:#666;cursor:pointer}.book-content[_ngcontent-%COMP%]   .controls-wrapper[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover:disabled{cursor:not-allowed}.book-content[_ngcontent-%COMP%]   .controls-wrapper[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:focus{box-shadow:none}.wrapped-img[_ngcontent-%COMP%]{max-height:100%;max-width:100%;-o-object-fit:contain;object-fit:contain}.btn-gallery[_ngcontent-%COMP%]{padding:.375rem .3rem!important}"]],data:{}});function View_InteractiveBookComponent_2(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,null,null,null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,2,"div",[],null,null,null,null,null)),(_l()(),core.qb(2,0,null,null,1,"h5",[["class","my-auto"]],null,null,null,null,null)),(_l()(),core.Jb(3,null,["",""]))],null,(function(_ck,_v){_ck(_v,3,0,_v.component.data.cover.title)}))}function View_InteractiveBookComponent_3(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,0,"div",[["class","spinner-border d-flex align-self-center position-absolute"],["role","status"],["style","width: 3rem; height: 3rem;"]],null,null,null,null,null))],null,null)}function View_InteractiveBookComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,9,"div",[["class","h-100 w-100 m-0 p-4 book-cover d-flex flex-column text-center"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_InteractiveBookComponent_2)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(3,0,null,null,6,"div",[["class","h-100 w-100 m-0 p-0"]],null,null,null,null,null)),(_l()(),core.qb(4,0,null,null,5,"div",[["class","h-100 w-100 p-3 d-flex justify-content-center align-items-center"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_InteractiveBookComponent_3)),core.pb(6,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(7,0,null,null,2,"img",[["alt","Click to open!"],["class","wrapped-img"],["title","Click to open!"]],[[1,"src",4]],[[null,"click"],[null,"load"]],(function(_v,en,$event){var ad=!0,_co=_v.component;return"click"===en&&(ad=!1!==_co.openBook()&&ad),"load"===en&&(ad=!1!==_co.imageLoaded()&&ad),ad}),null,null)),core.Fb(8,1),core.Db(131072,common.b,[core.h])],(function(_ck,_v){var _co=_v.component;_ck(_v,2,0,_co.data.cover&&_co.data.cover.title),_ck(_v,6,0,!_co.imageWasLoaded)}),(function(_ck,_v){var _co=_v.component,currVal_2=_co.data.cover&&_co.data.cover.image?core.Kb(_v,7,0,core.Cb(_v,9).transform(core.Kb(_v,7,0,_ck(_v,8,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.cover.image))))):"assets/images/open-book.png";_ck(_v,7,0,currVal_2)}))}function View_InteractiveBookComponent_6(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,4,"div",[],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,3,":svg:svg",[[":xml:space","preserve"],[":xmlns:xlink","http://www.w3.org/1999/xlink"],["enable-background","new 0 0 27.503 27.502"],["height","15"],["id","Layer_1"],["version","1.1"],["viewBox","0 0 27.503 27.502"],["width","15"],["x","0px"],["xmlns","http://www.w3.org/2000/svg"],["y","0px"]],null,null,null,null,null)),(_l()(),core.qb(2,0,null,null,2,":svg:g",[],null,null,null,null,null)),(_l()(),core.qb(3,0,null,null,0,":svg:path",[["d","M13.753,0C6.169,0,0,6.168,0,13.75c0,7.583,6.169,13.752,13.753,13.752c7.582,0,13.75-6.169,13.75-13.752\n                        C27.503,6.168,21.335,0,13.753,0z M13.753,24.846c-6.118,0-11.097-4.978-11.097-11.096c0-6.117,4.979-11.094,11.097-11.094\n                        c6.117,0,11.094,4.977,11.094,11.094C24.847,19.868,19.87,24.846,13.753,24.846z"],["fill","currentFill"]],null,null,null,null,null)),(_l()(),core.qb(4,0,null,null,0,":svg:path",[["d","M13.753,7.105c-3.673,0-6.646,2.975-6.646,6.645c0,3.668,2.974,6.645,6.646,6.645\n                        c3.666,0,6.643-2.977,6.643-6.645C20.396,10.08,17.419,7.105,13.753,7.105z"],["fill","currentFill"]],null,null,null,null,null))],null,null)}function View_InteractiveBookComponent_7(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,":svg:svg",[[":xml:space","preserve"],[":xmlns:xlink","http://www.w3.org/1999/xlink"],["enable-background","new 0 0 27.503 27.5"],["height","15"],["id","Layer_1"],["version","1.1"],["viewBox","0 0 27.503 27.5"],["width","15"],["x","0px"],["xmlns","http://www.w3.org/2000/svg"],["y","0px"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,0,":svg:path",[["d","M13.753,0C6.169,0,0,6.168,0,13.75S6.169,27.5,13.753,27.5c7.582,0,13.75-6.168,13.75-13.75\n                        S21.335,0,13.753,0z M13.753,24.844c-6.118,0-11.097-4.977-11.097-11.094S7.635,2.656,13.753,2.656\n                        c6.117,0,11.094,4.977,11.094,11.094S19.87,24.844,13.753,24.844z"],["fill","currentFill"]],null,null,null,null,null))],null,null)}function View_InteractiveBookComponent_5(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","btn btn-link btn-gallery"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.jumpToPage(_v.context.index)&&ad),ad}),null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_InteractiveBookComponent_6)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(_l()(),core.fb(0,[["notSelected",2]],null,0,null,View_InteractiveBookComponent_7))],(function(_ck,_v){_ck(_v,2,0,_v.component.currentPageIndex===_v.context.index,core.Cb(_v,3))}),null)}function View_InteractiveBookComponent_4(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,21,"div",[["class","h-100 w-100 m-0 p-4 book-content d-flex flex-column"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,4,"div",[["class","d-flex mb-3"]],null,null,null,null,null)),(_l()(),core.qb(2,0,null,null,3,"div",[["class","d-flex flex-shrink"]],null,null,null,null,null)),(_l()(),core.qb(3,0,null,null,2,"button",[["class","btn btn-sm btn-danger ml-auto"],["type","button"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.closeBook()&&ad),ad}),null,null)),(_l()(),core.qb(4,0,null,null,1,":svg:svg",[[":xml:space","preserve"],[":xmlns:xlink","http://www.w3.org/1999/xlink"],["enable-background","new 0 0 42.123 42.124"],["height","15"],["id","Layer_1"],["version","1.1"],["viewBox","0 0 42.123 42.124"],["width","15"],["x","0px"],["xmlns","http://www.w3.org/2000/svg"],["y","0px"]],null,null,null,null,null)),(_l()(),core.qb(5,0,null,null,0,":svg:path",[["d","M41.115,35.121l-14.061-14.06L41.118,6.999c1.339-1.344,1.339-3.527-0.003-4.873l-1.122-1.119\n                      c-1.339-1.342-3.526-1.342-4.869,0L21.062,15.069L6.999,1.006C5.657-0.335,3.47-0.335,2.125,1.008L1.007,2.129\n                      c-1.341,1.342-1.341,3.525,0,4.869l14.062,14.063l-14.06,14.06c-1.343,1.348-1.347,3.533-0.002,4.875l1.118,1.121\n                      c1.345,1.344,3.532,1.342,4.877-0.004l14.061-14.059l14.059,14.059c1.346,1.346,3.533,1.348,4.875,0.004l1.122-1.121\n                      C42.459,38.654,42.457,36.469,41.115,35.121z"],["fill","currentColor"]],null,null,null,null,null)),(_l()(),core.qb(6,0,null,null,2,"div",[["class","d-flex flex-fill justify-content-center mb-2"]],null,null,null,null,null)),(_l()(),core.qb(7,0,null,null,1,"span",[],null,null,null,null,null)),(_l()(),core.Jb(8,null,["",""])),(_l()(),core.qb(9,0,null,null,9,"div",[["class","h-100 controls-wrapper"]],null,null,null,null,null)),(_l()(),core.qb(10,0,null,null,2,"button",[["class","btn btn-previous"],["type","button"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.previousPage()&&ad),ad}),null,null)),(_l()(),core.qb(11,0,null,null,1,"fa",[["name","chevron-left"]],null,null,null,View_AngularFontAwesomeComponent_0,RenderType_AngularFontAwesomeComponent)),core.pb(12,114688,null,0,angular_font_awesome.a,[],{name:[0,"name"]},null),(_l()(),core.qb(13,0,[[1,0],["intImgDiv",1]],null,2,"div",[["class","interactive-image-wrapper"]],null,null,null,null,null)),(_l()(),core.qb(14,0,null,null,1,"app-screen-interactive-image",[],null,[["window","resize"]],(function(_v,en,$event){var ad=!0;return"window:resize"===en&&(ad=!1!==core.Cb(_v,15).onResize($event)&&ad),ad}),View_InteractiveImageComponent_0,RenderType_InteractiveImageComponent)),core.pb(15,4440064,null,0,interactive_image_component_InteractiveImageComponent,[asset_manager_service.a,core.h,player_service_PlayerService],{data:[0,"data"]},null),(_l()(),core.qb(16,0,null,null,2,"button",[["class","btn btn-next"],["type","button"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.nextPage()&&ad),ad}),null,null)),(_l()(),core.qb(17,0,null,null,1,"fa",[["name","chevron-right"]],null,null,null,View_AngularFontAwesomeComponent_0,RenderType_AngularFontAwesomeComponent)),core.pb(18,114688,null,0,angular_font_awesome.a,[],{name:[0,"name"]},null),(_l()(),core.qb(19,0,null,null,2,"div",[["class","my-2 text-center"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_InteractiveBookComponent_5)),core.pb(21,278528,null,0,common.k,[core.N,core.K,core.r],{ngForOf:[0,"ngForOf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,12,0,"chevron-left"),_ck(_v,15,0,_co.data.pages[_co.currentPageIndex]),_ck(_v,18,0,"chevron-right"),_ck(_v,21,0,_co.data.pages)}),(function(_ck,_v){var _co=_v.component;_ck(_v,8,0,_co.data.pages[_co.currentPageIndex].title)}))}function View_InteractiveBookComponent_0(_l){return core.Lb(0,[core.Db(0,secure_img_src_pipe_SecureImgSrcPipe,[http.c,platform_browser.b,couch_api_service.a]),core.Hb(671088640,1,{_intImgDiv:0}),(_l()(),core.qb(2,0,null,null,6,"div",[["class","int-book-container w-100 m-0 p-0 d-flex justify-content-around align-items-center"]],null,null,null,null,null)),(_l()(),core.qb(3,0,null,null,5,null,null,null,null,null,null,null)),core.pb(4,16384,null,0,common.p,[],{ngSwitch:[0,"ngSwitch"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_InteractiveBookComponent_1)),core.pb(6,278528,null,0,common.q,[core.N,core.K,common.p],{ngSwitchCase:[0,"ngSwitchCase"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_InteractiveBookComponent_4)),core.pb(8,278528,null,0,common.q,[core.N,core.K,common.p],{ngSwitchCase:[0,"ngSwitchCase"]},null)],(function(_ck,_v){_ck(_v,4,0,_v.component.isOpen),_ck(_v,6,0,!1),_ck(_v,8,0,!0)}),null)}function View_InteractiveBookComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-screen-interactive-book",[],null,null,null,View_InteractiveBookComponent_0,RenderType_InteractiveBookComponent)),core.pb(1,245760,null,0,interactive_book_component_InteractiveBookComponent,[asset_manager_service.a,player_service_PlayerService,ngx_toastr.j],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var InteractiveBookComponentNgFactory=core.mb("app-screen-interactive-book",interactive_book_component_InteractiveBookComponent,View_InteractiveBookComponent_Host_0,{data:"data"},{},[]);let nfc_reader_component_NfcReaderComponent=(()=>{let NfcReaderComponent=class{constructor(playerService){this.playerService=playerService}ngOnInit(){this.originalPlayerState=this.playerService.getPlayerState(),this.playerService.setPlayerState(PlayerState.DISABLED)}ngOnDestroy(){this.playerService.setPlayerState(this.originalPlayerState)}};return NfcReaderComponent=tslib_es6.a([RegisterPreviewComponent(templates.NfcReaderScreen)],NfcReaderComponent),NfcReaderComponent})();var RenderType_NfcReaderComponent=core.ob({encapsulation:0,styles:[[".image-wrapper[_ngcontent-%COMP%]{text-align:center;margin-bottom:10px}.image-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:100px}.hint[_ngcontent-%COMP%]{color:#555;font-size:13px}.hint[_ngcontent-%COMP%]   i.fa[_ngcontent-%COMP%]{color:#8bc34a}.prompt[_ngcontent-%COMP%]{margin-bottom:0}"]],data:{}});function View_NfcReaderComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,2,"p",[["class","hint"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,0,"i",[["class","fa fa-info"]],null,null,null,null,null)),(_l()(),core.Jb(2,null,[" ","\n"]))],null,(function(_ck,_v){_ck(_v,2,0,_v.component.data.hint)}))}function View_NfcReaderComponent_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"div",[["class","image-wrapper"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,0,"img",[["class","img-fluid"],["src","assets/images/nfc.png"]],null,null,null,null,null)),(_l()(),core.qb(2,0,null,null,1,"p",[["class","prompt"]],null,null,null,null,null)),(_l()(),core.Jb(3,null,["",""])),(_l()(),core.fb(16777216,null,null,1,null,View_NfcReaderComponent_1)),core.pb(5,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(6,0,null,null,1,"button",[["class","btn btn-block btn-dark"],["type","button"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=0!=(_v.component.showRescanPrompt=!0)&&ad),ad}),null,null)),(_l()(),core.Jb(7,null,[" ","\n"]))],(function(_ck,_v){_ck(_v,5,0,_v.component.data.hint)}),(function(_ck,_v){var _co=_v.component;_ck(_v,3,0,_co.showRescanPrompt?_co.data.rescanPrompt:_co.data.prompt),_ck(_v,7,0,"Scan"+(_co.showRescanPrompt?" Again":""))}))}function View_NfcReaderComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-screen-nfc-reader",[],null,null,null,View_NfcReaderComponent_0,RenderType_NfcReaderComponent)),core.pb(1,245760,null,0,nfc_reader_component_NfcReaderComponent,[player_service_PlayerService],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var NfcReaderComponentNgFactory=core.mb("app-screen-nfc-reader",nfc_reader_component_NfcReaderComponent,View_NfcReaderComponent_Host_0,{data:"data"},{},[]);let question_component_QuestionComponent=(()=>{let QuestionComponent=class{constructor(assetManager,playerService){this.assetManager=assetManager,this.playerService=playerService,this.isOtherOptionChecked=!1,this.otherOptionValue=""}ngOnInit(){this.playerState=this.playerService.getPlayerState(),this.playerService.setPlayerState(PlayerState.DISABLED)}ngAfterViewChecked(){this.qWrapper&&this.qWrapper.nativeElement.offsetHeight<this.qWrapper.nativeElement.scrollHeight&&(this.qWrapper.nativeElement.classList.remove("d-flex"),this.qWrapper.nativeElement.classList.remove("justify-content-center"),this.qWrapper.nativeElement.classList.add("inner-shadow-on-bottom-effect")),this.checkIfOverflown()}checkIfOverflown(){if(this.templateWrapper){const parent=this.templateWrapper.nativeElement.parentElement.parentElement;this.playerService.setScreenWrapperIsOverflown(parent.scrollHeight>parent.offsetHeight)}}imageLoaded(){this.imageWasLoaded=!0,this.checkIfOverflown()}setCheckedAnswer(answer,i){this.isOtherOptionChecked=!1,this.otherOptionValue="",this.data.answers&&this.data.answers.forEach(other=>{other.checked=!1}),answer&&(answer.checked=!0)}setCheckedFreeText(text){this.isOtherOptionChecked=!0,this.otherOptionValue=text,this.data.answers&&this.data.answers.forEach(other=>{other.checked=!1})}ngOnDestroy(){this.data.answers&&this.data.answers.forEach(answer=>{answer.checked=!1}),this.playerService.setPlayerState(this.playerState)}};return QuestionComponent=tslib_es6.a([RegisterPreviewComponent(templates.QuestionScreen)],QuestionComponent),QuestionComponent})();var RenderType_QuestionComponent=core.ob({encapsulation:0,styles:[["@media (min-width:200px){.text-size[_ngcontent-%COMP%]{font-size:1.1rem}.custom-p[_ngcontent-%COMP%]{padding:10px}.wrapped-img[_ngcontent-%COMP%]{height:auto;width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;max-height:50vh;-o-object-fit:contain;object-fit:contain}}@media (min-width:768px){.text-size[_ngcontent-%COMP%]{font-size:1.2rem}.custom-p[_ngcontent-%COMP%]{padding:45px}}@media (min-width:992px){.custom-h[_ngcontent-%COMP%]{height:100%}.wrapped-img[_ngcontent-%COMP%]{height:auto;width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;max-height:100%;-o-object-fit:contain;object-fit:contain}}.image-wrapper[_ngcontent-%COMP%]{text-align:center}.image-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:500px}.answers-wrapper[_ngcontent-%COMP%]   .answer[_ngcontent-%COMP%]{border-radius:3px;min-height:60px;min-width:50%;max-width:90%}.answers-wrapper[_ngcontent-%COMP%]   .answer[_ngcontent-%COMP%]:first-child{margin-top:10px}.answers-wrapper[_ngcontent-%COMP%]   .answer.free-text[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{margin-top:.55rem}.answers-wrapper[_ngcontent-%COMP%]   .answer.free-text[_ngcontent-%COMP%]   .form-check-label[_ngcontent-%COMP%]{width:100%}.answers-wrapper[_ngcontent-%COMP%]   .answer[_ngcontent-%COMP%]:not(.free-text)   .form-check-input[_ngcontent-%COMP%]{margin-top:.4rem}.answers-wrapper[_ngcontent-%COMP%]   .answer[_ngcontent-%COMP%]:hover{cursor:pointer}.not-set[_ngcontent-%COMP%]{color:#dd810b;font-size:14px}.not-set[_ngcontent-%COMP%]   fa[_ngcontent-%COMP%]{margin-right:5px}.inner-shadow-on-bottom-effect[_ngcontent-%COMP%]{box-shadow:inset 0 -20px 20px -20px rgba(0,0,0,.4)}"]],data:{}});function View_QuestionComponent_2(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,0,"div",[["class","spinner-border d-flex align-self-center position-absolute"],["role","status"],["style","width: 3rem; height: 3rem;"]],null,null,null,null,null))],null,null)}function View_QuestionComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,5,"div",[["class","h-100 w-100 p-0 d-flex justify-content-around align-self-center"],["style","min-height: 50px;"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_QuestionComponent_2)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(3,0,null,null,2,"img",[["class","wrapped-img"]],[[1,"src",4]],[[null,"load"]],(function(_v,en,$event){var ad=!0;return"load"===en&&(ad=!1!==_v.component.imageLoaded()&&ad),ad}),null,null)),core.Fb(4,1),core.Db(131072,common.b,[core.h])],(function(_ck,_v){_ck(_v,2,0,!_v.component.imageWasLoaded)}),(function(_ck,_v){var _co=_v.component,currVal_1=core.Kb(_v,3,0,core.Cb(_v,5).transform(core.Kb(_v,3,0,_ck(_v,4,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.image)))));_ck(_v,3,0,currVal_1)}))}function View_QuestionComponent_3(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,2,"div",[["class","justify-content-center align-items-center p-3"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,1,"div",[["class","text-size"]],null,null,null,null,null)),(_l()(),core.Jb(2,null,["",""]))],null,(function(_ck,_v){_ck(_v,2,0,_v.component.data.prompt)}))}function View_QuestionComponent_4(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,7,"div",[["class","answer m-2 px-3 d-flex align-items-center row"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.setCheckedAnswer(_v.context.$implicit,_v.context.index)&&ad),ad}),null,null)),core.Gb(512,null,common.C,common.D,[core.r,core.s,core.k,core.C]),core.pb(2,278528,null,0,common.j,[common.C],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),core.Eb(3,{checked:0}),(_l()(),core.qb(4,0,null,null,3,"div",[["class","col m-0 form-check"]],null,null,null,null,null)),(_l()(),core.qb(5,0,null,null,0,"input",[["class","form-check-input"],["name","inlineRadioOptions"],["type","radio"]],[[8,"id",0],[8,"checked",0]],null,null,null,null)),(_l()(),core.qb(6,0,null,null,1,"label",[["class","form-check-label"]],[[8,"htmlFor",0]],null,null,null,null)),(_l()(),core.Jb(7,null,["",""]))],(function(_ck,_v){var currVal_1=_ck(_v,3,0,_v.context.$implicit.checked);_ck(_v,2,0,"answer m-2 px-3 d-flex align-items-center row",currVal_1)}),(function(_ck,_v){_ck(_v,5,0,core.ub(1,"answerOption-",_v.context.index,""),_v.context.$implicit.checked),_ck(_v,6,0,core.ub(1,"answerOption-",_v.context.index,"")),_ck(_v,7,0,_v.context.$implicit.text)}))}function View_QuestionComponent_5(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,7,"div",[["class","answer m-2 px-3 d-flex align-items-center row"]],null,null,null,null,null)),core.Gb(512,null,common.C,common.D,[core.r,core.s,core.k,core.C]),core.pb(2,278528,null,0,common.j,[common.C],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),core.Eb(3,{checked:0}),(_l()(),core.qb(4,0,null,null,3,"div",[["class","m-0 form-check w-100"]],null,null,null,null,null)),(_l()(),core.qb(5,0,null,null,2,"label",[["class","my-auto d-flex align-items-center"],["for","answerRadioOther"]],null,null,null,null,null)),(_l()(),core.qb(6,0,null,null,0,"input",[["class","form-check-input my-auto"],["id","otherAnswerOption"],["name","inlineRadioOptions"],["type","radio"]],[[8,"checked",0]],null,null,null,null)),(_l()(),core.qb(7,0,[["answerRadioOther",1]],null,0,"input",[["aria-label","An answer applicable to the question"],["class","form-control rounded-0"],["id","answerRadioOther"],["placeholder","Type your answer"],["type","text"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.setCheckedFreeText(core.Cb(_v,7).value)&&ad),ad}),null,null))],(function(_ck,_v){var currVal_1=_ck(_v,3,0,_v.component.isOtherOptionChecked);_ck(_v,2,0,"answer m-2 px-3 d-flex align-items-center row",currVal_1)}),(function(_ck,_v){_ck(_v,6,0,_v.component.isOtherOptionChecked)}))}function View_QuestionComponent_6(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","not-set"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,1,"fa",[["name","exclamation-triangle"]],null,null,null,View_AngularFontAwesomeComponent_0,RenderType_AngularFontAwesomeComponent)),core.pb(2,114688,null,0,angular_font_awesome.a,[],{name:[0,"name"]},null),(_l()(),core.Jb(-1,null,["No answers have been set. "]))],(function(_ck,_v){_ck(_v,2,0,"exclamation-triangle")}),null)}function View_QuestionComponent_0(_l){return core.Lb(0,[core.Db(0,secure_img_src_pipe_SecureImgSrcPipe,[http.c,platform_browser.b,couch_api_service.a]),core.Hb(671088640,1,{qWrapper:0}),core.Hb(671088640,2,{templateWrapper:0}),(_l()(),core.qb(3,0,[[2,0],["templateWrapper",1]],null,14,"div",[["class","custom-h w-100 d-flex justify-content-around"]],null,null,null,null,null)),(_l()(),core.qb(4,0,null,null,13,"div",[["class","h-100 w-100 d-flex justify-content-around align-items-center row row-cols-lg-2 row-cols-md-1"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_QuestionComponent_1)),core.pb(6,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(7,0,[[1,0],["qWrapper",1]],null,8,"div",[["class","custom-p h-100 d-flex justify-content-center"],["style","overflow-y: auto;"]],null,null,null,null,null)),(_l()(),core.qb(8,0,null,null,7,"div",[["class","w-100 d-flex flex-column justify-content-center align-items-center"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_QuestionComponent_3)),core.pb(10,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(11,0,null,null,4,"div",[["class","answers-wrapper w-100 d-flex justify-content-center row row-cols-1"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_QuestionComponent_4)),core.pb(13,278528,null,0,common.k,[core.N,core.K,core.r],{ngForOf:[0,"ngForOf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_QuestionComponent_5)),core.pb(15,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_QuestionComponent_6)),core.pb(17,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,6,0,_co.data.image),_ck(_v,10,0,_co.data.prompt),_ck(_v,13,0,_co.data.answers),_ck(_v,15,0,_co.data.hasFreeTextOption),_ck(_v,17,0,!_co.data.answers&&!_co.data.hasFreeTextOption)}),null)}function View_QuestionComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-screen-question",[],null,null,null,View_QuestionComponent_0,RenderType_QuestionComponent)),core.pb(1,8634368,null,0,question_component_QuestionComponent,[asset_manager_service.a,player_service_PlayerService],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var QuestionComponentNgFactory=core.mb("app-screen-question",question_component_QuestionComponent,View_QuestionComponent_Host_0,{data:"data"},{},[]);let quiz_component_QuizComponent=(()=>{let QuizComponent=class{constructor(assetManager,changeDetectorRef,playerService){this.assetManager=assetManager,this.changeDetectorRef=changeDetectorRef,this.playerService=playerService,this.togglePlayback=playerState=>{switch(playerState){case PlayerState.PLAYING:this.audioRef&&this.audioRef.nativeElement.play().then(()=>{this.playerService.setMediaAutoplayIsBlocked(!1),this.playerService.setMediaIsLoading(!1)}).catch(e=>{this.playerService.setMediaAutoplayIsBlocked(!0),this.playerService.setMediaIsLoading(!1),this.playerService.setPlayerState(PlayerState.PAUSED)});break;case PlayerState.PAUSED:this.audioRef&&this.audioRef.nativeElement.pause()}},this.onPlaybackEnd=()=>{this.playerService.setPlayerState(PlayerState.PAUSED)}}set _audioRef(audioRef){this.audioRef&&this.audioRef.nativeElement.removeEventListener("ended",this.onPlaybackEnd),this.audioRef=audioRef,this.audioRef?(this.audioRef.nativeElement.addEventListener("ended",this.onPlaybackEnd),this.playerService.setPlayerState(PlayerState.PLAYING)):this.playerService.getPlayerState()!==PlayerState.DISABLED&&this.playerService.setPlayerState(PlayerState.DISABLED)}ngOnInit(){this.originalPlayerState=this.playerService.getPlayerState(),this.playerService.setPlayerState(PlayerState.DISABLED)}ngAfterViewInit(){this.subscription=this.playerService.playbackChanged.subscribe(this.togglePlayback)}ngAfterViewChecked(){this.listWrapper&&this.listWrapper.nativeElement.offsetHeight<this.listWrapper.nativeElement.scrollHeight&&(this.listWrapper.nativeElement.classList.remove("d-flex"),this.listWrapper.nativeElement.classList.remove("justify-content-center"),this.listWrapper.nativeElement.classList.add("inner-shadow-on-bottom-effect")),this.checkIfOverflown()}checkIfOverflown(){if(this.templateWrapper){const parent=this.templateWrapper.nativeElement.parentElement.parentElement;this.playerService.setScreenWrapperIsOverflown(parent.scrollHeight>parent.offsetHeight)}}imageLoaded(){this.imageWasLoaded=!0,this.checkIfOverflown()}setAnswer(answer){void 0!==answer?(answer.audio&&this.playerService.setMediaIsLoading(!0),(this.selectedAnswer=answer).visited=!0):delete this.selectedAnswer,this.changeDetectorRef.detectChanges()}ngOnDestroy(){this.data.answers&&this.data.answers.forEach(answer=>{answer.visited=!1}),this.audioRef&&this.audioRef.nativeElement.removeEventListener("ended",this.onPlaybackEnd),this.subscription.unsubscribe(),this.playerService.setPlayerState(this.originalPlayerState)}};return QuizComponent=tslib_es6.a([RegisterPreviewComponent(templates.QuizScreen)],QuizComponent),QuizComponent})();var RenderType_QuizComponent=core.ob({encapsulation:0,styles:[["@media (min-width:200px){.text-size[_ngcontent-%COMP%]{font-size:1.1rem}.custom-p[_ngcontent-%COMP%]{padding:10px}.wrapped-img[_ngcontent-%COMP%]{height:auto;width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;max-height:50vh;-o-object-fit:contain;object-fit:contain}}@media (min-width:768px){.text-size[_ngcontent-%COMP%]{font-size:1.2rem}.custom-p[_ngcontent-%COMP%]{padding:45px}}@media (min-width:992px){.custom-h[_ngcontent-%COMP%]{height:100%}.wrapped-img[_ngcontent-%COMP%]{height:auto;width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;max-height:100%;-o-object-fit:contain;object-fit:contain}}.image-wrapper[_ngcontent-%COMP%]{text-align:center}.image-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:500px}.answers-wrapper[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto}.answer[_ngcontent-%COMP%]{border-radius:3px}.answer[_ngcontent-%COMP%]:hover{cursor:pointer}.answer.correct[_ngcontent-%COMP%]{border-color:#5cb85c}.answer.incorrect[_ngcontent-%COMP%]{border-color:#d9534f}.answer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{min-width:100%;min-height:100%;-o-object-fit:cover;object-fit:cover}.answer[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-auto[_ngcontent-%COMP%]{padding-right:0}.answer[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-auto[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px;-o-object-fit:cover;object-fit:cover}.answer[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-auto[_ngcontent-%COMP%] + .col[_ngcontent-%COMP%]{margin-left:-15px}.answer[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{min-height:60px;margin-left:-5px;display:flex}.answer[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:inline-block;color:#646464;padding:0 15px 5px 10px;word-wrap:break-word;font-size:14px;font-weight:300;flex-grow:1}.answer[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]   fa[_ngcontent-%COMP%]{width:50px;height:50px;text-align:center;padding-top:12px;padding-right:20px}.answer[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;right:15px;top:-5px}.answer[_ngcontent-%COMP%]   audio[_ngcontent-%COMP%]{display:none}.answer[_ngcontent-%COMP%]:first-child{margin-top:10px}.not-set[_ngcontent-%COMP%]{color:#dd810b;font-size:14px}.not-set[_ngcontent-%COMP%]   fa[_ngcontent-%COMP%]{margin-right:5px}.img-in-list-item[_ngcontent-%COMP%]{width:100px;height:100px}.inner-shadow-on-bottom-effect[_ngcontent-%COMP%]{box-shadow:inset 0 -20px 20px -20px rgba(0,0,0,.4)}"]],data:{}});function View_QuizComponent_2(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,0,"div",[["class","spinner-border d-flex align-self-center position-absolute"],["role","status"],["style","width: 3rem; height: 3rem;"]],null,null,null,null,null))],null,null)}function View_QuizComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,5,"div",[["class","h-100 w-100 p-0 d-flex justify-content-around align-self-center"],["style","min-height: 50px;"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_QuizComponent_2)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(3,0,null,null,2,"img",[["class","wrapped-img"]],[[1,"src",4]],[[null,"load"]],(function(_v,en,$event){var ad=!0;return"load"===en&&(ad=!1!==_v.component.imageLoaded()&&ad),ad}),null,null)),core.Fb(4,1),core.Db(131072,common.b,[core.h])],(function(_ck,_v){_ck(_v,2,0,!_v.component.imageWasLoaded)}),(function(_ck,_v){var _co=_v.component,currVal_1=core.Kb(_v,3,0,core.Cb(_v,5).transform(core.Kb(_v,3,0,_ck(_v,4,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.image)))));_ck(_v,3,0,currVal_1)}))}function View_QuizComponent_3(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,2,"div",[["class","justify-content-center align-items-center p-3"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,1,"div",[["class","text-size"]],null,null,null,null,null)),(_l()(),core.Jb(2,null,["",""]))],null,(function(_ck,_v){_ck(_v,2,0,_v.component.data.prompt)}))}function View_QuizComponent_6(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","m-0 p-0 d-flex align-items-center overflow-hidden img-in-list-item"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,2,"img",[["class","img-fluid rounded"]],[[1,"src",4]],null,null,null,null)),core.Fb(2,1),core.Db(131072,common.b,[core.h])],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,1,0,core.Cb(_v,3).transform(core.Kb(_v,1,0,_ck(_v,2,0,core.Cb(_v.parent.parent.parent,0),_co.assetManager.getAssetURL(_v.parent.context.$implicit.image)))));_ck(_v,1,0,currVal_0)}))}function View_QuizComponent_7(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,0,"div",[["class","quiz-answer-validation-overlay-div quiz-answer-icon"]],null,null,null,null,null))],null,null)}function View_QuizComponent_5(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,8,"div",[["class","answer m-2 position-relative"]],[[2,"quiz-correct-answer",null],[2,"quiz-wrong-answer",null]],[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.setAnswer(_v.context.$implicit)&&ad),ad}),null,null)),(_l()(),core.qb(1,0,null,null,7,"a",[["class","d-flex align-items-center row m-0 p-1"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_QuizComponent_6)),core.pb(3,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(4,0,null,null,2,"div",[["class","col m-0 d-flex align-items-center"]],null,null,null,null,null)),(_l()(),core.qb(5,0,null,null,1,"span",[],null,null,null,null,null)),(_l()(),core.Jb(6,null,["",""])),(_l()(),core.fb(16777216,null,null,1,null,View_QuizComponent_7)),core.pb(8,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){_ck(_v,3,0,_v.context.$implicit.image),_ck(_v,8,0,_v.context.$implicit.visited)}),(function(_ck,_v){_ck(_v,0,0,_v.context.$implicit.visited&&_v.context.$implicit.isCorrect,_v.context.$implicit.visited&&!_v.context.$implicit.isCorrect),_ck(_v,6,0,_v.context.$implicit.text)}))}function View_QuizComponent_4(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,2,"div",[["class","w-100 d-flex justify-content-center row row-cols-1"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_QuizComponent_5)),core.pb(2,278528,null,0,common.k,[core.N,core.K,core.r],{ngForOf:[0,"ngForOf"]},null)],(function(_ck,_v){_ck(_v,2,0,_v.component.data.answers)}),null)}function View_QuizComponent_9(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","m-0 p-0 d-flex align-items-center overflow-hidden img-in-list-item"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,2,"img",[["class","img-fluid rounded"]],[[1,"src",4]],null,null,null,null)),core.Fb(2,1),core.Db(131072,common.b,[core.h])],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,1,0,core.Cb(_v,3).transform(core.Kb(_v,1,0,_ck(_v,2,0,core.Cb(_v.parent.parent,0),_co.assetManager.getAssetURL(_co.selectedAnswer.image)))));_ck(_v,1,0,currVal_0)}))}function View_QuizComponent_8(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,11,"div",[["class","w-100 d-flex justify-content-center row row-cols-1"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,7,"div",[["class","answer m-2"]],[[2,"quiz-correct-answer",null],[2,"quiz-wrong-answer",null]],null,null,null,null)),(_l()(),core.qb(2,0,null,null,6,"div",[["class","d-flex align-items-center row m-0 p-1 position-relative"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_QuizComponent_9)),core.pb(4,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(5,0,null,null,2,"div",[["class","col m-0 d-flex align-items-center"]],null,null,null,null,null)),(_l()(),core.qb(6,0,null,null,1,"span",[],null,null,null,null,null)),(_l()(),core.Jb(7,null,["",""])),(_l()(),core.qb(8,0,null,null,0,"div",[["class","quiz-answer-validation-overlay-div quiz-answer-icon"]],null,null,null,null,null)),(_l()(),core.qb(9,0,null,null,2,"div",[["class","mt-2"]],null,null,null,null,null)),(_l()(),core.qb(10,0,null,null,1,"button",[["class","btn btn-outline-dark rounded-0 btn-lg w-100"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.setAnswer()&&ad),ad}),null,null)),(_l()(),core.Jb(11,null,[" ",""]))],(function(_ck,_v){_ck(_v,4,0,_v.component.selectedAnswer.image)}),(function(_ck,_v){var _co=_v.component;_ck(_v,1,0,_co.selectedAnswer.isCorrect,!_co.selectedAnswer.isCorrect),_ck(_v,7,0,_co.selectedAnswer.message),_ck(_v,11,0,_co.selectedAnswer.isCorrect?"Well done!":"Try again")}))}function View_QuizComponent_10(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","not-set"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,1,"fa",[["name","exclamation-triangle"]],null,null,null,View_AngularFontAwesomeComponent_0,RenderType_AngularFontAwesomeComponent)),core.pb(2,114688,null,0,angular_font_awesome.a,[],{name:[0,"name"]},null),(_l()(),core.Jb(-1,null,["No answers have been set. "]))],(function(_ck,_v){_ck(_v,2,0,"exclamation-triangle")}),null)}function View_QuizComponent_11(_l){return core.Lb(0,[(_l()(),core.qb(0,0,[[1,0],["audioRef",1]],null,3,"audio",[["autoplay",""],["controls",""],["hidden",""],["preload","auto"]],[[1,"src",4]],null,null,null,null)),core.Fb(1,1),core.Db(131072,common.b,[core.h]),(_l()(),core.Jb(-1,null,[" Sorry, your browser does not support HTML5 audio.\n"]))],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,0,0,core.Cb(_v,2).transform(core.Kb(_v,0,0,_ck(_v,1,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.selectedAnswer.audio)))));_ck(_v,0,0,currVal_0)}))}function View_QuizComponent_0(_l){return core.Lb(0,[core.Db(0,secure_img_src_pipe_SecureImgSrcPipe,[http.c,platform_browser.b,couch_api_service.a]),core.Hb(671088640,1,{_audioRef:0}),core.Hb(671088640,2,{listWrapper:0}),core.Hb(671088640,3,{templateWrapper:0}),(_l()(),core.qb(4,0,[[3,0],["templateWrapper",1]],null,13,"div",[["class","custom-h w-100 d-flex justify-content-around"]],null,null,null,null,null)),(_l()(),core.qb(5,0,null,null,12,"div",[["class","h-100 w-100 d-flex justify-content-around align-items-center row row-cols-lg-2 row-cols-md-1"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_QuizComponent_1)),core.pb(7,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(8,0,[[2,0],["listWrapper",1]],null,7,"div",[["class","custom-p h-100 d-flex justify-content-center"],["style","overflow-y: auto;"]],null,null,null,null,null)),(_l()(),core.qb(9,0,null,null,6,"div",[["class","w-100 d-flex flex-column justify-content-center align-items-center"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_QuizComponent_3)),core.pb(11,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_QuizComponent_4)),core.pb(13,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_QuizComponent_8)),core.pb(15,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_QuizComponent_10)),core.pb(17,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_QuizComponent_11)),core.pb(19,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,7,0,_co.data.image),_ck(_v,11,0,_co.data.prompt),_ck(_v,13,0,!_co.selectedAnswer),_ck(_v,15,0,_co.selectedAnswer),_ck(_v,17,0,!_co.data.answers),_ck(_v,19,0,_co.selectedAnswer&&_co.selectedAnswer.audio)}),null)}function View_QuizComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-screen-quiz",[],null,null,null,View_QuizComponent_0,RenderType_QuizComponent)),core.pb(1,12828672,null,0,quiz_component_QuizComponent,[asset_manager_service.a,core.h,player_service_PlayerService],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var QuizComponentNgFactory=core.mb("app-screen-quiz",quiz_component_QuizComponent,View_QuizComponent_Host_0,{data:"data"},{},[]);let video_component_VideoComponent=(()=>{let VideoComponent=class{constructor(assetManager,playerService){this.assetManager=assetManager,this.playerService=playerService,this.timeRemaining=3e3,this.togglePlayback=playerState=>{switch(playerState){case PlayerState.PLAYING:this.videoRef&&this.videoRef.nativeElement.play().then(()=>this.playerService.setMediaAutoplayIsBlocked(!1)).catch(e=>{this.playerService.setMediaAutoplayIsBlocked(!0),this.playerService.setPlayerState(PlayerState.PAUSED)});break;case PlayerState.PAUSED:this.videoRef&&this.videoRef.nativeElement.pause()}},this.onPlaybackEnd=()=>{this.playerService.setPlaybackEnded()}}set content(videoRef){this.videoRef=videoRef,this.videoRef?this.videoRef.nativeElement.addEventListener("ended",this.onPlaybackEnd):this.playerService.getPlayerState()!==PlayerState.DISABLED&&this.playerService.setPlayerState(PlayerState.DISABLED)}ngOnInit(){this.originalPlayerState=this.playerService.getPlayerState()}ngAfterViewInit(){this.subscription=this.playerService.playbackChanged.subscribe(this.togglePlayback)}videoLoaded(){this.videoWasLoaded=!0}ngOnDestroy(){this.videoRef&&this.videoRef.nativeElement.removeEventListener("ended",this.onPlaybackEnd),this.subscription.unsubscribe(),this.playerService.setPlayerState(this.originalPlayerState)}};return VideoComponent=tslib_es6.a([RegisterPreviewComponent(templates.VideoScreen)],VideoComponent),VideoComponent})();var RenderType_VideoComponent=core.ob({encapsulation:0,styles:[[".video-wrapper[_ngcontent-%COMP%]{max-width:100%;height:auto;width:-webkit-max-content;width:-moz-max-content;width:max-content}.video-wrapper[_ngcontent-%COMP%]   .not-set[_ngcontent-%COMP%]{color:#dd810b;font-size:14px}.video-wrapper[_ngcontent-%COMP%]   .not-set[_ngcontent-%COMP%]   fa[_ngcontent-%COMP%]{margin-right:5px}.wrapped-video[_ngcontent-%COMP%]{height:100%;width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;-o-object-fit:contain;object-fit:contain}@media (min-width:992px){.custom-h[_ngcontent-%COMP%]{height:100%}}"]],data:{}});function View_VideoComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,0,"div",[["class","spinner-border d-flex align-self-center position-absolute"],["role","status"],["style","width: 3rem; height: 3rem;"]],null,null,null,null,null))],null,null)}function View_VideoComponent_2(_l){return core.Lb(0,[(_l()(),core.qb(0,0,[[1,0],["videoRef",1]],null,3,"video",[["autoplay",""],["playsinline",""],["preload","auto"]],[[1,"src",4]],[[null,"load"]],(function(_v,en,$event){var ad=!0;return"load"===en&&(ad=!1!==_v.component.videoLoaded()&&ad),ad}),null,null)),core.Fb(1,1),core.Db(131072,common.b,[core.h]),(_l()(),core.Jb(-1,null,[" Sorry, your browser does not support HTML5 video. "]))],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,0,0,core.Cb(_v,2).transform(core.Kb(_v,0,0,_ck(_v,1,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.video)))));_ck(_v,0,0,currVal_0)}))}function View_VideoComponent_3(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"span",[["class","not-set"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,1,"fa",[["name","exclamation-triangle"]],null,null,null,View_AngularFontAwesomeComponent_0,RenderType_AngularFontAwesomeComponent)),core.pb(2,114688,null,0,angular_font_awesome.a,[],{name:[0,"name"]},null),(_l()(),core.Jb(-1,null,["No video has been set. "]))],(function(_ck,_v){_ck(_v,2,0,"exclamation-triangle")}),null)}function View_VideoComponent_0(_l){return core.Lb(0,[core.Db(0,secure_img_src_pipe_SecureImgSrcPipe,[http.c,platform_browser.b,couch_api_service.a]),core.Hb(671088640,1,{content:0}),(_l()(),core.qb(2,0,null,null,7,"div",[["class","h-100 w-100"]],null,null,null,null,null)),(_l()(),core.qb(3,0,null,null,6,"div",[["class","h-100 w-100 d-flex justify-content-center align-items-center embed-responsive embed-responsive-16by9"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_VideoComponent_1)),core.pb(5,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_VideoComponent_2)),core.pb(7,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_VideoComponent_3)),core.pb(9,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,5,0,!_co.videoWasLoaded),_ck(_v,7,0,_co.data.video),_ck(_v,9,0,!_co.data.video)}),null)}function View_VideoComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-screen-video",[],null,null,null,View_VideoComponent_0,RenderType_VideoComponent)),core.pb(1,4440064,null,0,video_component_VideoComponent,[asset_manager_service.a,player_service_PlayerService],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var VideoComponentNgFactory=core.mb("app-screen-video",video_component_VideoComponent,View_VideoComponent_Host_0,{data:"data"},{},[]);let simple_component_SimpleComponent=(()=>{let SimpleComponent=class{constructor(assetManager,playerService){this.assetManager=assetManager,this.playerService=playerService,this.togglePlayback=playerState=>{switch(playerState){case PlayerState.PLAYING:this.audioRef&&this.audioRef.nativeElement.play().then(()=>{this.playerService.setMediaAutoplayIsBlocked(!1),this.playerService.setMediaIsLoading(!1)}).catch(e=>{this.playerService.setMediaAutoplayIsBlocked(!0),this.playerService.setMediaIsLoading(!1),this.playerService.setPlayerState(PlayerState.PAUSED)});break;case PlayerState.PAUSED:this.audioRef&&this.audioRef.nativeElement.pause()}},this.onPlaybackEnd=()=>{this.playerService.setPlaybackEnded()}}set content(audioRef){this.audioRef=audioRef,this.audioRef?this.audioRef.nativeElement.addEventListener("ended",this.onPlaybackEnd):this.playerService.getPlayerState()!==PlayerState.DISABLED&&this.playerService.setPlayerState(PlayerState.DISABLED)}ngOnInit(){this.dominantElement=this.data.dominantElement,null==this.dominantElement&&(this.dominantElement=this.data.text&&this.data.text.trim()&&"<br>"!==this.data.text&&this.data.image?"both":this.data.image?"image":"text"),this.data.audio&&this.playerService.setMediaIsLoading(!0),this.originalPlayerState=this.playerService.getPlayerState()}ngAfterViewInit(){this.subscription=this.playerService.playbackChanged.subscribe(this.togglePlayback)}ngAfterViewChecked(){this.textWrapper&&this.textWrapper.nativeElement.offsetHeight<this.textWrapper.nativeElement.scrollHeight&&(this.textWrapper.nativeElement.classList.remove("d-flex"),this.textWrapper.nativeElement.classList.remove("justify-content-center"),this.textWrapper.nativeElement.classList.add("inner-shadow-on-bottom-effect")),this.checkIfOverflown()}checkIfOverflown(){if(this.templateWrapper){const parent=this.templateWrapper.nativeElement.parentElement.parentElement;this.playerService.setScreenWrapperIsOverflown(parent.scrollHeight>parent.offsetHeight)}}imageLoaded(){this.imageWasLoaded=!0,this.checkIfOverflown()}toggleDominantElement(){switch(this.dominantElement){case"text":this.dominantElement="image";break;case"image":this.dominantElement="text"}}ngOnDestroy(){this.audioRef&&this.audioRef.nativeElement.removeEventListener("ended",this.onPlaybackEnd),this.subscription.unsubscribe(),this.playerService.setPlayerState(this.originalPlayerState)}};return SimpleComponent=tslib_es6.a([RegisterPreviewComponent(templates.SimpleScreen)],SimpleComponent),SimpleComponent})();var RenderType_SimpleComponent=core.ob({encapsulation:0,styles:[["@media (min-width:200px){.dominant-element[_ngcontent-%COMP%]{position:unset}.inner-html-font[_ngcontent-%COMP%]{font-size:1.1rem}.custom-p[_ngcontent-%COMP%]{padding:10px}.wrapped-img[_ngcontent-%COMP%]{height:auto;width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;max-height:-webkit-max-content;max-height:-moz-max-content;max-height:max-content;-o-object-fit:contain;object-fit:contain}}@media (min-width:768px){.dominant-element[_ngcontent-%COMP%]{position:unset}.inner-html-font[_ngcontent-%COMP%]{font-size:1.2rem}.custom-p[_ngcontent-%COMP%]{padding:20px}}@media (min-width:992px){.dominant-element[_ngcontent-%COMP%]{position:unset}.custom-h[_ngcontent-%COMP%]{height:100%}.custom-p[_ngcontent-%COMP%]{padding:30px}.wrapped-img[_ngcontent-%COMP%]{height:auto;width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;max-height:100%;-o-object-fit:contain;object-fit:contain}}@media (min-width:1200px){.dominant-element[_ngcontent-%COMP%]{position:fixed}.custom-p[_ngcontent-%COMP%]{padding:45px}}.dominant-element-btn[_ngcontent-%COMP%]{margin:5px;border-color:#d0d0d0;opacity:.5}.dominant-element-btn[_ngcontent-%COMP%]:active, .dominant-element-btn[_ngcontent-%COMP%]:focus, .dominant-element-btn[_ngcontent-%COMP%]:hover{opacity:.7}.dominant-element-active[_ngcontent-%COMP%]{opacity:.9}.image-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;-o-object-fit:contain;object-fit:contain}.text-wrapper[_ngcontent-%COMP%]{overflow-y:auto;min-height:57px;margin-bottom:100px;background-color:#f8f9fa;border-radius:3px;padding:2px 8px}.inner-shadow-on-bottom-effect[_ngcontent-%COMP%]{box-shadow:inset 0 -20px 20px -20px rgba(0,0,0,.4)}"]],data:{}});function View_SimpleComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,6,"div",[["class","w-100 pl-3 dominant-element"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,2,"button",[["class","btn dominant-element-btn p-2 mx-0"],["type","button"]],[[2,"dominant-element-active",null],[8,"disabled",0]],[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.toggleDominantElement()&&ad),ad}),null,null)),(_l()(),core.qb(2,0,null,null,1,"fa",[["class","text-light"]],null,null,null,View_AngularFontAwesomeComponent_0,RenderType_AngularFontAwesomeComponent)),core.pb(3,114688,null,0,angular_font_awesome.a,[],{name:[0,"name"]},null),(_l()(),core.qb(4,0,null,null,2,"button",[["class","btn dominant-element-btn p-2 mx-0"],["type","button"]],[[2,"dominant-element-active",null],[8,"disabled",0]],[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.toggleDominantElement()&&ad),ad}),null,null)),(_l()(),core.qb(5,0,null,null,1,"fa",[["class","text-light"]],null,null,null,View_AngularFontAwesomeComponent_0,RenderType_AngularFontAwesomeComponent)),core.pb(6,114688,null,0,angular_font_awesome.a,[],{name:[0,"name"]},null)],(function(_ck,_v){_ck(_v,3,0,"image"),_ck(_v,6,0,"font")}),(function(_ck,_v){var _co=_v.component;_ck(_v,1,0,"image"===_co.dominantElement,"image"===_co.dominantElement),_ck(_v,4,0,"image"!==_co.dominantElement,"image"!==_co.dominantElement)}))}function View_SimpleComponent_3(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,0,"div",[["class","spinner-border d-flex align-self-center position-absolute"],["role","status"],["style","width: 3rem; height: 3rem;"]],null,null,null,null,null))],null,null)}function View_SimpleComponent_2(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,5,"div",[["class","h-100 w-100 p-0 d-flex justify-content-around align-self-center"],["style","min-height: 50px;"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_SimpleComponent_3)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(3,0,null,null,2,"img",[["alt",""],["class","wrapped-img"]],[[1,"src",4]],[[null,"load"]],(function(_v,en,$event){var ad=!0;return"load"===en&&(ad=!1!==_v.component.imageLoaded()&&ad),ad}),null,null)),core.Fb(4,1),core.Db(131072,common.b,[core.h])],(function(_ck,_v){_ck(_v,2,0,!_v.component.imageWasLoaded)}),(function(_ck,_v){var _co=_v.component,currVal_1=core.Kb(_v,3,0,core.Cb(_v,5).transform(core.Kb(_v,3,0,_ck(_v,4,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.image)))));_ck(_v,3,0,currVal_1)}))}function View_SimpleComponent_4(_l){return core.Lb(0,[(_l()(),core.qb(0,0,[[2,0],["textWrapper",1]],null,2,"div",[["class","custom-p h-100 d-flex justify-content-center"],["style","overflow-y: auto;"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,1,"div",[["class","d-flex flex-column justify-content-center align-items-center"]],null,null,null,null,null)),(_l()(),core.qb(2,0,null,null,0,"div",[["class","inner-html-font py-2"]],[[8,"innerHTML",1]],null,null,null,null))],null,(function(_ck,_v){_ck(_v,2,0,_v.component.data.text)}))}function View_SimpleComponent_5(_l){return core.Lb(0,[(_l()(),core.qb(0,0,[[1,0],["audioRef",1]],null,3,"audio",[["autoplay",""],["controls",""],["hidden",""],["preload","auto"]],[[1,"src",4]],null,null,null,null)),core.Fb(1,1),core.Db(131072,common.b,[core.h]),(_l()(),core.Jb(-1,null,[" Sorry, your browser does not support HTML5 audio.\n"]))],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,0,0,core.Cb(_v,2).transform(core.Kb(_v,0,0,_ck(_v,1,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.audio)))));_ck(_v,0,0,currVal_0)}))}function View_SimpleComponent_0(_l){return core.Lb(0,[core.Db(0,secure_img_src_pipe_SecureImgSrcPipe,[http.c,platform_browser.b,couch_api_service.a]),core.Hb(671088640,1,{content:0}),core.Hb(671088640,2,{textWrapper:0}),core.Hb(671088640,3,{screenWrapper:0}),core.Hb(671088640,4,{templateWrapper:0}),(_l()(),core.fb(16777216,null,null,1,null,View_SimpleComponent_1)),core.pb(6,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(7,0,[[4,0],["templateWrapper",1]],null,8,"div",[["class","custom-h w-100 d-flex justify-content-around"]],null,null,null,null,null)),(_l()(),core.qb(8,0,[[3,0],["screenWrapper",1]],null,7,"div",[["class","h-100 w-100 d-flex justify-content-around align-items-center row row-cols-md-1"]],null,null,null,null,null)),core.Gb(512,null,common.C,common.D,[core.r,core.s,core.k,core.C]),core.pb(10,278528,null,0,common.j,[common.C],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),core.Eb(11,{"row-cols-lg-2":0}),(_l()(),core.fb(16777216,null,null,1,null,View_SimpleComponent_2)),core.pb(13,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_SimpleComponent_4)),core.pb(15,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_SimpleComponent_5)),core.pb(17,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,6,0,_co.dominantElement&&"both"!==_co.dominantElement&&_co.data.image&&_co.data.text&&""!==_co.data.text&&"<br>"!==_co.data.text);var currVal_2=_ck(_v,11,0,"image"!==_co.dominantElement);_ck(_v,10,0,"h-100 w-100 d-flex justify-content-around align-items-center row row-cols-md-1",currVal_2),_ck(_v,13,0,_co.data.image&&"text"!==_co.dominantElement),_ck(_v,15,0,_co.data.text&&"image"!==_co.dominantElement),_ck(_v,17,0,_co.data.audio)}),null)}function View_SimpleComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-screen-simple",[],null,null,null,View_SimpleComponent_0,RenderType_SimpleComponent)),core.pb(1,12828672,null,0,simple_component_SimpleComponent,[asset_manager_service.a,player_service_PlayerService],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var SimpleComponentNgFactory=core.mb("app-screen-simple",simple_component_SimpleComponent,View_SimpleComponent_Host_0,{data:"data"},{},[]);class interactive_image_interactive_image_component_Area{constructor(branch){this.shape="poly";const poly=branch.polygon;try{this.centroid=poly.getCentroid()}catch(e){const factory=new hotspot_editor.c,boundingBox=poly.boundingBox;factory.add(boundingBox.lowerBound),factory.add(new hotspot_editor.a(boundingBox.upperBound.x,boundingBox.lowerBound.y)),factory.add(boundingBox.upperBound),factory.add(new hotspot_editor.a(boundingBox.lowerBound.x,boundingBox.upperBound.y)),this.centroid=factory.build().getCentroid()}const sides=poly.sides;this.coords=[sides[0].start].concat(sides.map(side=>side.end)),this.branch=branch}}let interactive_image_interactive_image_component_InteractiveImageComponent=(()=>{let InteractiveImageComponent=class{constructor(assetManager,changeDetectorRef,playerService){this.assetManager=assetManager,this.changeDetectorRef=changeDetectorRef,this.playerService=playerService,this.onLoad=()=>{const imageElement=this.imageRef.nativeElement;this.ratio=imageElement.width/imageElement.naturalWidth,imageElement.removeEventListener("load",this.onLoad),this.data.branchList&&(this.areas=this.data.branchList.map(branch=>new interactive_image_interactive_image_component_Area(branch)),this.changeDetectorRef.detectChanges(),this.highlighter=new image_map_highlighter(imageElement,{fill:!0,fillColor:"007bff",fillOpacity:.2,strokeColor:"dc3545",strokeOpacity:1,alwaysOn:!0,disabledAttributeName:"disabled",fillColorDisabled:"0055b1",fillOpacityDisabled:.2,strokeColorDisabled:"5c5b61",strokeOpacityDisabled:1}),this.highlighter.init())},this.togglePlayback=playerState=>{switch(playerState){case PlayerState.PLAYING:this.audioRef&&this.audioRef.nativeElement.play().then(()=>{this.playerService.setMediaAutoplayIsBlocked(!1),this.playerService.setMediaIsLoading(!1)}).catch(e=>{this.playerService.setMediaAutoplayIsBlocked(!0),this.playerService.setMediaIsLoading(!1),this.playerService.setPlayerState(PlayerState.PAUSED)});break;case PlayerState.PAUSED:this.audioRef&&this.audioRef.nativeElement.pause()}},this.onPlaybackEnd=()=>{this.playerService.setPlaybackEnded()}}set _imageRef(imageRef){this.imageRef=imageRef,this.imageRef&&this.imageRef.nativeElement.addEventListener("load",this.onLoad)}set content(audioRef){this.audioRef=audioRef,this.audioRef?this.audioRef.nativeElement.addEventListener("ended",this.onPlaybackEnd):this.playerService.getPlayerState()!==PlayerState.DISABLED&&this.playerService.setPlayerState(PlayerState.DISABLED)}ngOnInit(){this.data.audio&&this.playerService.setMediaIsLoading(!0),this.originalPlayerState=this.playerService.getPlayerState(),this.validBranches=this.playerService.validateBranchList(this.data.branchList)}ngAfterViewInit(){this.subscription=this.playerService.playbackChanged.subscribe(this.togglePlayback)}imageLoaded(){this.imageWasLoaded=!0}selectArea(area){this.playerService.setPlaybackEnded(area.branch)}onResize(event){const imageElement=this.imageRef.nativeElement;this.ratio=imageElement.width/imageElement.naturalWidth,this.changeDetectorRef.detectChanges(),this.highlighter.reDrawCanvas()}ngOnDestroy(){this.audioRef&&this.audioRef.nativeElement.removeEventListener("ended",this.onPlaybackEnd),this.subscription.unsubscribe(),this.playerService.setPlayerState(this.originalPlayerState)}};return InteractiveImageComponent=tslib_es6.a([RegisterPreviewComponent(templates.InteractiveImageBranchingPoint)],InteractiveImageComponent),InteractiveImageComponent})();var interactive_image_component_ngfactory_RenderType_InteractiveImageComponent=core.ob({encapsulation:2,styles:[[".image-wrapper{max-width:100%;height:auto;width:-webkit-max-content;width:-moz-max-content;width:max-content}.image-wrapper map area.disabled{cursor:no-drop!important}.not-set{color:#dd810b;font-size:14px}.not-set fa{margin-right:5px}.wrapped-img{max-height:100%;max-width:100%;-o-object-fit:contain;object-fit:contain}"],image_map_highlighter_css_ngstyle_styles],data:{}});function interactive_image_component_ngfactory_View_InteractiveImageComponent_2(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,0,"div",[["class","spinner-border d-flex align-self-center position-absolute"],["role","status"],["style","width: 3rem; height: 3rem;"]],null,null,null,null,null))],null,null)}function interactive_image_component_ngfactory_View_InteractiveImageComponent_4(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"area",[],[[1,"id",0],[1,"shape",0],[1,"alt",0],[2,"disabled",null],[1,"disabled",0],[8,"coords",0]],[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==(!!_v.context.ngIf.status&&_v.component.selectArea(_v.parent.context.$implicit))&&ad),ad}),null,null)),core.Fb(1,2)],null,(function(_ck,_v){var _co=_v.component,currVal_0="area"+_v.parent.context.index,currVal_1=_v.parent.context.$implicit.shape,currVal_2=_v.parent.context.$implicit.text,currVal_3=!_v.context.ngIf.status,currVal_4=_v.context.ngIf.status?"false":"true",currVal_5=core.ub(1,"",core.Kb(_v,0,5,_ck(_v,1,0,core.Cb(_v.parent.parent.parent,1),_v.parent.context.$implicit.coords,_co.ratio)),"");_ck(_v,0,0,currVal_0,currVal_1,currVal_2,currVal_3,currVal_4,currVal_5)}))}function interactive_image_component_ngfactory_View_InteractiveImageComponent_3(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,null,null,null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,2,null,interactive_image_component_ngfactory_View_InteractiveImageComponent_4)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),core.Eb(3,{status:0}),(_l()(),core.fb(0,null,null,0))],(function(_ck,_v){var currVal_0=_ck(_v,3,0,_v.component.validBranches.get(_v.context.$implicit.branch.target));_ck(_v,2,0,currVal_0)}),null)}function interactive_image_component_ngfactory_View_InteractiveImageComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,8,"div",[["class","h-100 w-100 d-flex justify-content-center align-items-center"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,interactive_image_component_ngfactory_View_InteractiveImageComponent_2)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(3,0,[[1,0],["imageRef",1]],null,2,"img",[["class","wrapped-img"],["usemap","#map"]],[[1,"src",4]],[[null,"load"]],(function(_v,en,$event){var ad=!0;return"load"===en&&(ad=!1!==_v.component.imageLoaded()&&ad),ad}),null,null)),core.Fb(4,1),core.Db(131072,common.b,[core.h]),(_l()(),core.qb(6,0,null,null,2,"map",[["name","map"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,interactive_image_component_ngfactory_View_InteractiveImageComponent_3)),core.pb(8,278528,null,0,common.k,[core.N,core.K,core.r],{ngForOf:[0,"ngForOf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,2,0,!_co.imageWasLoaded),_ck(_v,8,0,_co.areas)}),(function(_ck,_v){var _co=_v.component,currVal_1=core.Kb(_v,3,0,core.Cb(_v,5).transform(core.Kb(_v,3,0,_ck(_v,4,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.image)))));_ck(_v,3,0,currVal_1)}))}function interactive_image_component_ngfactory_View_InteractiveImageComponent_5(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","not-set"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,1,"fa",[["name","exclamation-triangle"]],null,null,null,View_AngularFontAwesomeComponent_0,RenderType_AngularFontAwesomeComponent)),core.pb(2,114688,null,0,angular_font_awesome.a,[],{name:[0,"name"]},null),(_l()(),core.Jb(-1,null,["No image has been set. "]))],(function(_ck,_v){_ck(_v,2,0,"exclamation-triangle")}),null)}function interactive_image_component_ngfactory_View_InteractiveImageComponent_6(_l){return core.Lb(0,[(_l()(),core.qb(0,0,[[2,0],["audioRef",1]],null,3,"audio",[["autoplay",""],["controls",""],["hidden",""],["preload","auto"]],[[1,"src",4]],null,null,null,null)),core.Fb(1,1),core.Db(131072,common.b,[core.h]),(_l()(),core.Jb(-1,null,[" Sorry, your browser does not support HTML5 audio.\n"]))],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,0,0,core.Cb(_v,2).transform(core.Kb(_v,0,0,_ck(_v,1,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.audio)))));_ck(_v,0,0,currVal_0)}))}function interactive_image_component_ngfactory_View_InteractiveImageComponent_0(_l){return core.Lb(0,[core.Db(0,secure_img_src_pipe_SecureImgSrcPipe,[http.c,platform_browser.b,couch_api_service.a]),core.Db(0,ScalePipe,[]),core.Hb(671088640,1,{_imageRef:0}),core.Hb(671088640,2,{content:0}),(_l()(),core.qb(4,0,null,null,4,"div",[["class","h-100 w-100"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,interactive_image_component_ngfactory_View_InteractiveImageComponent_1)),core.pb(6,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,interactive_image_component_ngfactory_View_InteractiveImageComponent_5)),core.pb(8,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,interactive_image_component_ngfactory_View_InteractiveImageComponent_6)),core.pb(10,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,6,0,_co.data.image),_ck(_v,8,0,!_co.data.image),_ck(_v,10,0,_co.data.audio)}),null)}function interactive_image_component_ngfactory_View_InteractiveImageComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-menu-interactive-image",[],null,[["window","resize"]],(function(_v,en,$event){var ad=!0;return"window:resize"===en&&(ad=!1!==core.Cb(_v,1).onResize($event)&&ad),ad}),interactive_image_component_ngfactory_View_InteractiveImageComponent_0,interactive_image_component_ngfactory_RenderType_InteractiveImageComponent)),core.pb(1,4440064,null,0,interactive_image_interactive_image_component_InteractiveImageComponent,[asset_manager_service.a,core.h,player_service_PlayerService],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var interactive_image_component_ngfactory_InteractiveImageComponentNgFactory=core.mb("app-menu-interactive-image",interactive_image_interactive_image_component_InteractiveImageComponent,interactive_image_component_ngfactory_View_InteractiveImageComponent_Host_0,{data:"data"},{},[]);class MapComponent{constructor(){}ngOnInit(){}}var RenderType_MapComponent=core.ob({encapsulation:0,styles:[[""]],data:{}});function View_MapComponent_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"p",[],null,null,null,null,null)),(_l()(),core.Jb(-1,null,["map works!"]))],null,null)}function View_MapComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-menu-map",[],null,null,null,View_MapComponent_0,RenderType_MapComponent)),core.pb(1,114688,null,0,MapComponent,[],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var MapComponentNgFactory=core.mb("app-menu-map",MapComponent,View_MapComponent_Host_0,{},{},[]);let nfc_component_NfcComponent=(()=>{let NfcComponent=class{constructor(assetManager,playerService){this.assetManager=assetManager,this.playerService=playerService,this.togglePlayback=playerState=>{switch(playerState){case PlayerState.PLAYING:this.audioRef&&this.audioRef.nativeElement.play().then(()=>this.playerService.setMediaAutoplayIsBlocked(!1)).catch(e=>{this.playerService.setMediaAutoplayIsBlocked(!0),this.playerService.setPlayerState(PlayerState.PAUSED)});break;case PlayerState.PAUSED:this.audioRef&&this.audioRef.nativeElement.pause()}},this.onPlaybackEnd=()=>{this.playerService.setPlaybackEnded()}}set content(audioRef){this.audioRef=audioRef,this.audioRef?this.audioRef.nativeElement.addEventListener("ended",this.onPlaybackEnd):this.playerService.getPlayerState()!==PlayerState.DISABLED&&this.playerService.setPlayerState(PlayerState.DISABLED)}ngOnInit(){this.originalPlayerState=this.playerService.getPlayerState(),this.validBranches=this.playerService.validateBranchList(this.data.branchList)}ngAfterViewInit(){this.subscription=this.playerService.playbackChanged.subscribe(this.togglePlayback)}selectBranch(branch){this.playerService.setPlaybackEnded(branch)}ngOnDestroy(){this.audioRef&&this.audioRef.nativeElement.removeEventListener("ended",this.onPlaybackEnd),this.subscription.unsubscribe(),this.playerService.setPlayerState(this.originalPlayerState)}};return NfcComponent=tslib_es6.a([RegisterPreviewComponent(templates.NfcBranchingPoint)],NfcComponent),NfcComponent})();var RenderType_NfcComponent=core.ob({encapsulation:0,styles:[[".tile-item[_ngcontent-%COMP%]{background-color:#fafafa;cursor:pointer;padding:6px;margin-bottom:6px;min-height:100px}.tile-item[_ngcontent-%COMP%]:hover{background-color:rgba(0,123,255,.1)}.container-fluid[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{cursor:no-drop!important;opacity:.4}"]],data:{}});function View_NfcComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["style","text-align: center;"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,2,"img",[["class","img-fluid img-thumbnail img-preview"]],[[1,"src",4]],null,null,null,null)),core.Fb(2,1),core.Db(131072,common.b,[core.h])],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,1,0,core.Cb(_v,3).transform(core.Kb(_v,1,0,_ck(_v,2,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.image)))));_ck(_v,1,0,currVal_0)}))}function View_NfcComponent_3(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,4,"div",[["class","tile-item bs-callout bs-callout-none"]],[[2,"disabled",null]],[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==(!!_v.context.ngIf.status&&_v.component.selectBranch(_v.parent.context.$implicit))&&ad),ad}),null,null)),(_l()(),core.qb(1,0,null,null,1,"div",[],null,null,null,null,null)),(_l()(),core.qb(2,0,null,null,0,"img",[["class","img-fluid"],["src","assets/images/nfc.png"]],null,null,null,null,null)),(_l()(),core.qb(3,0,null,null,1,"div",[["style","word-break: break-word;"]],null,null,null,null,null)),(_l()(),core.Jb(4,null,[" "," "]))],null,(function(_ck,_v){_ck(_v,0,0,!_v.context.ngIf.status),_ck(_v,4,0,_v.parent.context.$implicit.text)}))}function View_NfcComponent_2(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","col-sm-3"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,2,null,View_NfcComponent_3)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),core.Eb(3,{status:0})],(function(_ck,_v){var currVal_0=_ck(_v,3,0,_v.component.validBranches.get(_v.context.$implicit.target));_ck(_v,2,0,currVal_0)}),null)}function View_NfcComponent_4(_l){return core.Lb(0,[(_l()(),core.qb(0,0,[[1,0],["audioRef",1]],null,3,"audio",[["autoplay",""],["controls",""],["hidden",""],["preload","auto"]],[[1,"src",4]],null,null,null,null)),core.Fb(1,1),core.Db(131072,common.b,[core.h]),(_l()(),core.Jb(-1,null,[" Sorry, your browser does not support HTML5 audio.\n"]))],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,0,0,core.Cb(_v,2).transform(core.Kb(_v,0,0,_ck(_v,1,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.audio)))));_ck(_v,0,0,currVal_0)}))}function View_NfcComponent_0(_l){return core.Lb(0,[core.Db(0,secure_img_src_pipe_SecureImgSrcPipe,[http.c,platform_browser.b,couch_api_service.a]),core.Hb(671088640,1,{content:0}),(_l()(),core.fb(16777216,null,null,1,null,View_NfcComponent_1)),core.pb(3,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(4,0,null,null,3,"div",[["class","container-fluid"]],null,null,null,null,null)),(_l()(),core.qb(5,0,null,null,2,"div",[["class","row"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_NfcComponent_2)),core.pb(7,278528,null,0,common.k,[core.N,core.K,core.r],{ngForOf:[0,"ngForOf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_NfcComponent_4)),core.pb(9,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,3,0,_co.data.image),_ck(_v,7,0,_co.data.branchList),_ck(_v,9,0,_co.data.audio)}),null)}function View_NfcComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-menu-nfc",[],null,null,null,View_NfcComponent_0,RenderType_NfcComponent)),core.pb(1,4440064,null,0,nfc_component_NfcComponent,[asset_manager_service.a,player_service_PlayerService],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var NfcComponentNgFactory=core.mb("app-menu-nfc",nfc_component_NfcComponent,View_NfcComponent_Host_0,{data:"data"},{},[]);let QRCode,angularx_qrcode_component_QRCodeComponent=class{constructor(el,platformId){this.el=el,this.platformId=platformId,this.allowEmptyString=!1,this.colordark="#000000",this.colorlight="#ffffff",this.level="M",this.hidetitle=!1,this.qrdata="",this.size=256,this.usesvg=!1,this.isValidQrCodeText=data=>!1===this.allowEmptyString?!(void 0===data||""===data):!(void 0===data)}ngAfterViewInit(){if(!Object(common.B)(this.platformId)){QRCode||(QRCode=__webpack_require__("0ERz"));try{if(!this.isValidQrCodeText(this.qrdata))throw new Error("Empty QR Code data");this.qrcode=new QRCode(this.el.nativeElement,{colorDark:this.colordark,colorLight:this.colorlight,correctLevel:QRCode.CorrectLevel[this.level.toString()],height:this.size,text:this.qrdata||" ",useSVG:this.usesvg,width:this.size})}catch(e){console.error("Error generating QR Code: "+e.message)}}}ngOnChanges(changes){if(!this.qrcode)return;const qrData=changes.qrdata;qrData&&this.isValidQrCodeText(qrData.currentValue)&&(this.qrcode.clear(),this.qrcode.makeCode(qrData.currentValue))}};var RenderType_QRCodeComponent=core.ob({encapsulation:2,styles:[],data:{}});function View_QRCodeComponent_0(_l){return core.Lb(2,[],null,null)}let qr_code_component_QrCodeComponent=(()=>{let QrCodeComponent=class{constructor(assetManager,playerService){this.assetManager=assetManager,this.playerService=playerService,this.togglePlayback=playerState=>{switch(playerState){case PlayerState.PLAYING:this.audioRef&&this.audioRef.nativeElement.play().then(()=>{this.playerService.setMediaAutoplayIsBlocked(!1),this.playerService.setMediaIsLoading(!1)}).catch(e=>{this.playerService.setMediaAutoplayIsBlocked(!0),this.playerService.setMediaIsLoading(!1),this.playerService.setPlayerState(PlayerState.PAUSED)});break;case PlayerState.PAUSED:this.audioRef&&this.audioRef.nativeElement.pause()}},this.onPlaybackEnd=()=>{this.playerService.setPlaybackEnded()}}set content(audioRef){this.audioRef=audioRef,this.audioRef?this.audioRef.nativeElement.addEventListener("ended",this.onPlaybackEnd):this.playerService.getPlayerState()!==PlayerState.DISABLED&&this.playerService.setPlayerState(PlayerState.DISABLED)}ngOnInit(){this.data.audio&&this.playerService.setMediaIsLoading(!0),this.originalPlayerState=this.playerService.getPlayerState(),this.validBranches=this.playerService.validateBranchList(this.data.branchList)}ngAfterViewInit(){this.subscription=this.playerService.playbackChanged.subscribe(this.togglePlayback)}selectBranch(branch){this.playerService.setPlaybackEnded(branch)}ngOnDestroy(){this.audioRef&&this.audioRef.nativeElement.removeEventListener("ended",this.onPlaybackEnd),this.subscription.unsubscribe(),this.playerService.setPlayerState(this.originalPlayerState)}};return QrCodeComponent=tslib_es6.a([RegisterPreviewComponent(templates.QrCodeBranchingPoint)],QrCodeComponent),QrCodeComponent})();var RenderType_QrCodeComponent=core.ob({encapsulation:0,styles:[[".image-wrapper[_ngcontent-%COMP%]{text-align:center}.image-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:500px}.branch[_ngcontent-%COMP%]{margin:4px;padding:4px}.branch[_ngcontent-%COMP%]:first-child{margin-top:10px}.branch.disabled[_ngcontent-%COMP%]{cursor:no-drop!important;opacity:.4}.branch.tile-item[_ngcontent-%COMP%]{padding:4px;min-height:100px;margin-bottom:6px;font-size:14px}.branch.tile-item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{margin:10px 5px}.branch.tile-item[_ngcontent-%COMP%]  qrcode img{width:100%}.branch.tile-item[_ngcontent-%COMP%]:hover{background-color:rgba(0,123,255,.1)}.branch[_ngcontent-%COMP%]:hover{cursor:pointer}"]],data:{}});function View_QrCodeComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","image-wrapper"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,2,"img",[["class","img-fluid"]],[[1,"src",4]],null,null,null,null)),core.Fb(2,1),core.Db(131072,common.b,[core.h])],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,1,0,core.Cb(_v,3).transform(core.Kb(_v,1,0,_ck(_v,2,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.image)))));_ck(_v,1,0,currVal_0)}))}function View_QrCodeComponent_4(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"p",[["class","text"]],null,null,null,null,null)),(_l()(),core.Jb(1,null,[" "," "]))],null,(function(_ck,_v){_ck(_v,1,0,_v.parent.parent.context.$implicit.text)}))}function View_QrCodeComponent_3(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,4,"div",[["class","branch tile-item"]],[[2,"disabled",null]],[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==(!!_v.context.ngIf.status&&_v.component.selectBranch(_v.parent.context.$implicit))&&ad),ad}),null,null)),(_l()(),core.qb(1,0,null,null,1,"qrcode",[],[[1,"id",0]],null,null,View_QRCodeComponent_0,RenderType_QRCodeComponent)),core.pb(2,4767744,null,0,angularx_qrcode_component_QRCodeComponent,[core.k,core.A],{allowEmptyString:[0,"allowEmptyString"],level:[1,"level"],qrdata:[2,"qrdata"],size:[3,"size"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_QrCodeComponent_4)),core.pb(4,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){_ck(_v,2,0,!0,"M",_v.parent.context.$implicit.id,256),_ck(_v,4,0,_v.parent.context.$implicit.text)}),(function(_ck,_v){_ck(_v,0,0,!_v.context.ngIf.status),_ck(_v,1,0,"qrcode_"+_v.parent.context.index)}))}function View_QrCodeComponent_2(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","col-sm-3"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,2,null,View_QrCodeComponent_3)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),core.Eb(3,{status:0})],(function(_ck,_v){var currVal_0=_v.context.$implicit.target&&_ck(_v,3,0,_v.component.validBranches.get(_v.context.$implicit.target));_ck(_v,2,0,currVal_0)}),null)}function View_QrCodeComponent_5(_l){return core.Lb(0,[(_l()(),core.qb(0,0,[[1,0],["audioRef",1]],null,3,"audio",[["autoplay",""],["controls",""],["hidden",""],["preload","auto"]],[[1,"src",4]],null,null,null,null)),core.Fb(1,1),core.Db(131072,common.b,[core.h]),(_l()(),core.Jb(-1,null,[" Sorry, your browser does not support HTML5 audio.\n"]))],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,0,0,core.Cb(_v,2).transform(core.Kb(_v,0,0,_ck(_v,1,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.audio)))));_ck(_v,0,0,currVal_0)}))}function View_QrCodeComponent_0(_l){return core.Lb(0,[core.Db(0,secure_img_src_pipe_SecureImgSrcPipe,[http.c,platform_browser.b,couch_api_service.a]),core.Hb(671088640,1,{content:0}),(_l()(),core.fb(16777216,null,null,1,null,View_QrCodeComponent_1)),core.pb(3,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(4,0,null,null,3,"div",[["class","container"]],null,null,null,null,null)),(_l()(),core.qb(5,0,null,null,2,"div",[["class","row"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_QrCodeComponent_2)),core.pb(7,278528,null,0,common.k,[core.N,core.K,core.r],{ngForOf:[0,"ngForOf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_QrCodeComponent_5)),core.pb(9,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,3,0,_co.data.image),_ck(_v,7,0,_co.data.branchList),_ck(_v,9,0,_co.data.audio)}),null)}function View_QrCodeComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-menu-qr-code",[],null,null,null,View_QrCodeComponent_0,RenderType_QrCodeComponent)),core.pb(1,4440064,null,0,qr_code_component_QrCodeComponent,[asset_manager_service.a,player_service_PlayerService],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var QrCodeComponentNgFactory=core.mb("app-menu-qr-code",qr_code_component_QrCodeComponent,View_QrCodeComponent_Host_0,{data:"data"},{},[]);let simple_simple_component_SimpleComponent=(()=>{let SimpleComponent=class{constructor(assetManager,playerService){this.assetManager=assetManager,this.playerService=playerService,this.togglePlayback=playerState=>{switch(playerState){case PlayerState.PLAYING:this.audioRef&&this.audioRef.nativeElement.play().then(()=>{this.playerService.setMediaAutoplayIsBlocked(!1),this.playerService.setMediaIsLoading(!1)}).catch(e=>{this.playerService.setMediaAutoplayIsBlocked(!0),this.playerService.setMediaIsLoading(!1),this.playerService.setPlayerState(PlayerState.PAUSED)});break;case PlayerState.PAUSED:this.audioRef&&this.audioRef.nativeElement.pause()}},this.onPlaybackEnd=()=>{this.playerService.setPlaybackEnded()}}set content(audioRef){this.audioRef=audioRef,this.audioRef?this.audioRef.nativeElement.addEventListener("ended",this.onPlaybackEnd):this.playerService.getPlayerState()!==PlayerState.DISABLED&&this.playerService.setPlayerState(PlayerState.DISABLED)}ngOnInit(){this.data.audio&&this.playerService.setMediaIsLoading(!0),this.originalPlayerState=this.playerService.getPlayerState(),this.validBranches=this.playerService.validateBranchList(this.data.branchList)}ngAfterViewInit(){this.subscription=this.playerService.playbackChanged.subscribe(this.togglePlayback)}ngAfterViewChecked(){this.listWrapper&&this.listWrapper.nativeElement.offsetHeight<this.listWrapper.nativeElement.scrollHeight&&(this.listWrapper.nativeElement.classList.remove("d-flex"),this.listWrapper.nativeElement.classList.remove("justify-content-center"),this.listWrapper.nativeElement.classList.add("inner-shadow-on-bottom-effect")),this.checkIfOverflown()}checkIfOverflown(){if(this.templateWrapper){const parent=this.templateWrapper.nativeElement.parentElement.parentElement;this.playerService.setScreenWrapperIsOverflown(parent.scrollHeight>parent.offsetHeight)}}imageLoaded(){this.imageWasLoaded=!0,this.checkIfOverflown()}selectBranch(branch){this.playerService.setPlaybackEnded(branch)}ngOnDestroy(){this.audioRef&&this.audioRef.nativeElement.removeEventListener("ended",this.onPlaybackEnd),this.subscription.unsubscribe(),this.playerService.setPlayerState(this.originalPlayerState)}};return SimpleComponent=tslib_es6.a([RegisterPreviewComponent(templates.SimpleBranchingPoint)],SimpleComponent),SimpleComponent})();var simple_component_ngfactory_RenderType_SimpleComponent=core.ob({encapsulation:0,styles:[["@media (min-width:200px){.text-size[_ngcontent-%COMP%]{font-size:1.1rem}.custom-p[_ngcontent-%COMP%]{padding:10px}.wrapped-img[_ngcontent-%COMP%]{height:auto;width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;max-height:50vh;-o-object-fit:contain;object-fit:contain}}@media (min-width:768px){.text-size[_ngcontent-%COMP%]{font-size:1.2rem}.custom-p[_ngcontent-%COMP%]{padding:45px}}@media (min-width:992px){.custom-h[_ngcontent-%COMP%]{height:100%}.wrapped-img[_ngcontent-%COMP%]{height:auto;width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;max-height:100%;-o-object-fit:contain;object-fit:contain}}.image-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-width:-webkit-max-content;max-width:-moz-max-content;max-width:max-content;-o-object-fit:contain;object-fit:contain}.branch[_ngcontent-%COMP%]:first-child{margin-top:10px}.branch.disabled[_ngcontent-%COMP%]{cursor:no-drop!important;opacity:.4}.branch.list-item[_ngcontent-%COMP%]{min-height:60px;min-width:60%;max-width:90%;max-height:-webkit-max-content;max-height:-moz-max-content;max-height:max-content}.branch.list-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{min-width:100%;min-height:100%;-o-object-fit:cover;object-fit:cover}.branch.list-item[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{min-height:50px}.branch.list-item[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-auto[_ngcontent-%COMP%]{padding-right:0}.branch.list-item[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-auto[_ngcontent-%COMP%] + .col[_ngcontent-%COMP%]{margin-left:0}.branch.list-item[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{margin-left:10px;padding:18px 15px}.branch.list-item[_ngcontent-%COMP%], .branch.tile-item[_ngcontent-%COMP%]{font-size:16px}.branch.list-item[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%], .branch.tile-item[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{word-break:break-word}.branch[_ngcontent-%COMP%]:hover{cursor:pointer}.not-set[_ngcontent-%COMP%]{color:#dd810b;font-size:14px}.not-set[_ngcontent-%COMP%]   fa[_ngcontent-%COMP%]{margin-right:5px}.tile-item[_ngcontent-%COMP%]{padding:4px;min-height:50px;width:90%;max-width:200px}.tile-img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:contain;object-fit:contain;background:0 0;border:none}.img-in-list-item[_ngcontent-%COMP%]{width:100px;height:100px}.inner-shadow-on-bottom-effect[_ngcontent-%COMP%]{box-shadow:inset 0 -20px 20px -20px rgba(0,0,0,.4)}.tile-img-wrapper[_ngcontent-%COMP%]{width:100%;height:10vw}"]],data:{}});function simple_component_ngfactory_View_SimpleComponent_2(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,0,"div",[["class","spinner-border d-flex align-self-center position-absolute"],["role","status"],["style","width: 3rem; height: 3rem;"]],null,null,null,null,null))],null,null)}function simple_component_ngfactory_View_SimpleComponent_1(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,5,"div",[["class","h-100 w-100 p-0 d-flex justify-content-around align-self-center"],["style","min-height: 50px;"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,simple_component_ngfactory_View_SimpleComponent_2)),core.pb(2,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(3,0,null,null,2,"img",[["alt",""],["class","wrapped-img"]],[[1,"src",4]],[[null,"load"]],(function(_v,en,$event){var ad=!0;return"load"===en&&(ad=!1!==_v.component.imageLoaded()&&ad),ad}),null,null)),core.Fb(4,1),core.Db(131072,common.b,[core.h])],(function(_ck,_v){_ck(_v,2,0,!_v.component.imageWasLoaded)}),(function(_ck,_v){var _co=_v.component,currVal_1=core.Kb(_v,3,0,core.Cb(_v,5).transform(core.Kb(_v,3,0,_ck(_v,4,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.image)))));_ck(_v,3,0,currVal_1)}))}function simple_component_ngfactory_View_SimpleComponent_3(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,2,"div",[["class","justify-content-center align-items-center p-3"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,1,"div",[["class","text-size prompt"]],null,null,null,null,null)),(_l()(),core.Jb(2,null,["",""]))],null,(function(_ck,_v){_ck(_v,2,0,_v.component.data.prompt)}))}function View_SimpleComponent_6(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","m-0 p-0 d-flex align-items-center overflow-hidden img-in-list-item"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,2,"img",[["alt",""],["class","img-fluid rounded"]],[[1,"src",4]],null,null,null,null)),core.Fb(2,1),core.Db(131072,common.b,[core.h])],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,1,0,core.Cb(_v,3).transform(core.Kb(_v,1,0,_ck(_v,2,0,core.Cb(_v.parent.parent.parent,0),_co.assetManager.getAssetURL(_v.parent.context.$implicit.image)))));_ck(_v,1,0,currVal_0)}))}function simple_component_ngfactory_View_SimpleComponent_5(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,5,"div",[["class","branch list-item m-2"]],[[4,"display",null]],null,null,null,null)),(_l()(),core.qb(1,0,null,null,4,"a",[["class","d-flex align-items-center row m-0 p-1"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.selectBranch(_v.context.$implicit)&&ad),ad}),null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_SimpleComponent_6)),core.pb(3,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(4,0,null,null,1,"div",[["class","col m-0"]],null,null,null,null,null)),(_l()(),core.Jb(5,null,["",""]))],(function(_ck,_v){_ck(_v,3,0,_v.context.$implicit.image)}),(function(_ck,_v){_ck(_v,0,0,_v.component.validBranches.get(_v.context.$implicit.target)?"block":"none"),_ck(_v,5,0,_v.context.$implicit.text)}))}function simple_component_ngfactory_View_SimpleComponent_4(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,2,"div",[["class","w-100 d-flex justify-content-center row row-cols-1"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,simple_component_ngfactory_View_SimpleComponent_5)),core.pb(2,278528,null,0,common.k,[core.N,core.K,core.r],{ngForOf:[0,"ngForOf"]},null)],(function(_ck,_v){_ck(_v,2,0,_v.component.data.branchList)}),null)}function View_SimpleComponent_9(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","tile-img-wrapper mb-1"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,2,"img",[["class","img-fluid img-thumbnail tile-img"]],[[1,"src",4]],null,null,null,null)),core.Fb(2,1),core.Db(131072,common.b,[core.h])],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,1,0,core.Cb(_v,3).transform(core.Kb(_v,1,0,_ck(_v,2,0,core.Cb(_v.parent.parent.parent,0),_co.assetManager.getAssetURL(_v.parent.context.$implicit.image)))));_ck(_v,1,0,currVal_0)}))}function View_SimpleComponent_10(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,2,"div",[["class","card-body p-0 d-flex align-items-center justify-content-around text-center"],["style","min-height: 80px;"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,1,"div",[["class","card-text"]],null,null,null,null,null)),(_l()(),core.Jb(2,null,["",""]))],null,(function(_ck,_v){_ck(_v,2,0,_v.parent.context.$implicit.text)}))}function View_SimpleComponent_8(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,5,"div",[["class","w-100 d-flex justify-content-center align-self-stretch"]],[[4,"display",null]],null,null,null,null)),(_l()(),core.qb(1,0,null,null,4,"a",[["class","card w-100 p-2 m-2 btn btn-link text-decoration-none branch tile-item"]],null,[[null,"click"]],(function(_v,en,$event){var ad=!0;return"click"===en&&(ad=!1!==_v.component.selectBranch(_v.context.$implicit)&&ad),ad}),null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_SimpleComponent_9)),core.pb(3,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_SimpleComponent_10)),core.pb(5,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){_ck(_v,3,0,_v.context.$implicit.image),_ck(_v,5,0,_v.context.$implicit.text)}),(function(_ck,_v){_ck(_v,0,0,_v.component.validBranches.get(_v.context.$implicit.target)?"block":"none")}))}function View_SimpleComponent_7(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,2,"div",[["class","w-100 d-flex justify-content-around row row-cols-2 row-cols-md-4"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,View_SimpleComponent_8)),core.pb(2,278528,null,0,common.k,[core.N,core.K,core.r],{ngForOf:[0,"ngForOf"]},null)],(function(_ck,_v){_ck(_v,2,0,_v.component.data.branchList)}),null)}function View_SimpleComponent_11(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,3,"div",[["class","not-set"]],null,null,null,null,null)),(_l()(),core.qb(1,0,null,null,1,"fa",[["name","exclamation-triangle"]],null,null,null,View_AngularFontAwesomeComponent_0,RenderType_AngularFontAwesomeComponent)),core.pb(2,114688,null,0,angular_font_awesome.a,[],{name:[0,"name"]},null),(_l()(),core.Jb(-1,null,["No options have been set. "]))],(function(_ck,_v){_ck(_v,2,0,"exclamation-triangle")}),null)}function View_SimpleComponent_12(_l){return core.Lb(0,[(_l()(),core.qb(0,0,[[1,0],["audioRef",1]],null,3,"audio",[["autoplay",""],["controls",""],["hidden",""],["preload","auto"]],[[1,"src",4]],null,null,null,null)),core.Fb(1,1),core.Db(131072,common.b,[core.h]),(_l()(),core.Jb(-1,null,[" Sorry, your browser does not support HTML5 audio.\n"]))],null,(function(_ck,_v){var _co=_v.component,currVal_0=core.Kb(_v,0,0,core.Cb(_v,2).transform(core.Kb(_v,0,0,_ck(_v,1,0,core.Cb(_v.parent,0),_co.assetManager.getAssetURL(_co.data.audio)))));_ck(_v,0,0,currVal_0)}))}function simple_component_ngfactory_View_SimpleComponent_0(_l){return core.Lb(0,[core.Db(0,secure_img_src_pipe_SecureImgSrcPipe,[http.c,platform_browser.b,couch_api_service.a]),core.Hb(671088640,1,{content:0}),core.Hb(671088640,2,{listWrapper:0}),core.Hb(671088640,3,{templateWrapper:0}),(_l()(),core.qb(4,0,[[3,0],["templateWrapper",1]],null,12,"div",[["class","custom-h w-100 d-flex justify-content-around"]],null,null,null,null,null)),(_l()(),core.qb(5,0,null,null,11,"div",[["class","h-100 w-100 d-flex justify-content-around align-items-center row row-cols-lg-2 row-cols-md-1"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,simple_component_ngfactory_View_SimpleComponent_1)),core.pb(7,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.qb(8,0,[[2,0],["listWrapper",1]],null,6,"div",[["class","custom-p h-100 d-flex justify-content-center"],["style","overflow-y: auto;"]],null,null,null,null,null)),(_l()(),core.qb(9,0,null,null,5,"div",[["class","w-100 d-flex flex-column justify-content-center align-items-center"]],null,null,null,null,null)),(_l()(),core.fb(16777216,null,null,1,null,simple_component_ngfactory_View_SimpleComponent_3)),core.pb(11,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,simple_component_ngfactory_View_SimpleComponent_4)),core.pb(13,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(_l()(),core.fb(0,[["tilesMenu",2]],null,0,null,View_SimpleComponent_7)),(_l()(),core.fb(16777216,null,null,1,null,View_SimpleComponent_11)),core.pb(16,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null),(_l()(),core.fb(16777216,null,null,1,null,View_SimpleComponent_12)),core.pb(18,16384,null,0,common.l,[core.N,core.K],{ngIf:[0,"ngIf"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,7,0,_co.data.image),_ck(_v,11,0,_co.data.prompt),_ck(_v,13,0,"list"===_co.data.layout,core.Cb(_v,14)),_ck(_v,16,0,!_co.data.branchList),_ck(_v,18,0,_co.data.audio)}),null)}function simple_component_ngfactory_View_SimpleComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-menu-simple",[],null,null,null,simple_component_ngfactory_View_SimpleComponent_0,simple_component_ngfactory_RenderType_SimpleComponent)),core.pb(1,12828672,null,0,simple_simple_component_SimpleComponent,[asset_manager_service.a,player_service_PlayerService],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var simple_component_ngfactory_SimpleComponentNgFactory=core.mb("app-menu-simple",simple_simple_component_SimpleComponent,simple_component_ngfactory_View_SimpleComponent_Host_0,{data:"data"},{},[]);let jump_component_JumpComponent=(()=>{let JumpComponent=class{constructor(playerService){this.playerService=playerService}ngAfterViewInit(){console.log("@ngAfterViewInit jump=",this)}};return JumpComponent=tslib_es6.a([RegisterPreviewComponent(templates.UnconditionalJump)],JumpComponent),JumpComponent})();var RenderType_JumpComponent=core.ob({encapsulation:2,styles:[],data:{}});function View_JumpComponent_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"p",[],null,null,null,null,null)),(_l()(),core.Jb(1,null,["Jump to Part ",""]))],null,(function(_ck,_v){_ck(_v,1,0,_v.component.data.target)}))}function View_JumpComponent_Host_0(_l){return core.Lb(0,[(_l()(),core.qb(0,0,null,null,1,"app-screen-jump",[],null,null,null,View_JumpComponent_0,RenderType_JumpComponent)),core.pb(1,4243456,null,0,jump_component_JumpComponent,[player_service_PlayerService],null,null)],null,null)}var JumpComponentNgFactory=core.mb("app-screen-jump",jump_component_JumpComponent,View_JumpComponent_Host_0,{data:"data"},{},[]),router=__webpack_require__("iInd");class PlayerRoutingModule{}var LeafletModule=function(){function LeafletModule(){}var LeafletModule_1;return LeafletModule_1=LeafletModule,LeafletModule.forRoot=function(){return{ngModule:LeafletModule_1,providers:[]}},LeafletModule}(),LeafletDrawModule=(__webpack_require__("INa4"),function(){function LeafletDrawModule(){}var LeafletDrawModule_1;return LeafletDrawModule_1=LeafletDrawModule,LeafletDrawModule.forRoot=function(){return{ngModule:LeafletDrawModule_1,providers:[]}},LeafletDrawModule}());let QRCodeModule=class{};class SharedModule{}__webpack_require__.d(__webpack_exports__,"PlayerModuleNgFactory",(function(){return PlayerModuleNgFactory}));var PlayerModuleNgFactory=core.nb(PlayerModule,[],(function(_l){return core.zb([core.Ab(512,core.j,core.Y,[[8,[router_ngfactory.a,PlayerComponentNgFactory,ng_bootstrap_ngfactory.f,ng_bootstrap_ngfactory.g,DialogueComponentNgFactory,GuideMeComponentNgFactory,InteractiveBookComponentNgFactory,NfcReaderComponentNgFactory,QuestionComponentNgFactory,QuizComponentNgFactory,VideoComponentNgFactory,SimpleComponentNgFactory,InteractiveImageComponentNgFactory,interactive_image_component_ngfactory_InteractiveImageComponentNgFactory,MapComponentNgFactory,NfcComponentNgFactory,QrCodeComponentNgFactory,simple_component_ngfactory_SimpleComponentNgFactory,JumpComponentNgFactory]],[3,core.j],core.w]),core.Ab(4608,common.n,common.m,[core.t,[2,common.H]]),core.Ab(4608,angular_font_awesome.c,angular_font_awesome.c,[]),core.Ab(4608,ng_bootstrap.t,ng_bootstrap.t,[core.j,core.q,ng_bootstrap.hb,ng_bootstrap.u]),core.Ab(4608,http.h,http.n,[common.d,core.A,http.l]),core.Ab(4608,http.o,http.o,[http.h,http.m]),core.Ab(5120,http.a,(function(p0_0){return[p0_0]}),[http.o]),core.Ab(4608,http.k,http.k,[]),core.Ab(6144,http.i,null,[http.k]),core.Ab(4608,http.g,http.g,[http.i]),core.Ab(6144,http.b,null,[http.g]),core.Ab(4608,http.f,http.j,[http.b,core.q]),core.Ab(4608,http.c,http.c,[http.f]),core.Ab(1073742336,common.c,common.c,[]),core.Ab(1073742336,router.p,router.p,[[2,router.u],[2,router.o]]),core.Ab(1073742336,PlayerRoutingModule,PlayerRoutingModule,[]),core.Ab(1073742336,angular_font_awesome.b,angular_font_awesome.b,[]),core.Ab(1073742336,LeafletModule,LeafletModule,[]),core.Ab(1073742336,LeafletDrawModule,LeafletDrawModule,[]),core.Ab(1073742336,QRCodeModule,QRCodeModule,[]),core.Ab(1073742336,ng_bootstrap.v,ng_bootstrap.v,[]),core.Ab(1073742336,http.e,http.e,[]),core.Ab(1073742336,http.d,http.d,[]),core.Ab(1073742336,SharedModule,SharedModule,[]),core.Ab(1073742336,PlayerModule,PlayerModule,[]),core.Ab(1024,router.m,(function(){return[[{path:"",component:player_component_PlayerComponent}]]}),[]),core.Ab(256,http.l,"XSRF-TOKEN",[]),core.Ab(256,http.m,"X-XSRF-TOKEN",[])])}))},tSBN:function(module,exports,__webpack_require__){var factory;factory=function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var ImageMapHighlighter=function(){function ImageMapHighlighter(element){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,ImageMapHighlighter),this.element=element,this.options=Object.assign({},this._getDefaultOptions(),options)}return _createClass(ImageMapHighlighter,[{key:"init",value:function(){var _this=this,map=this._getAssociatedMap(this.element);this.mapInstance=map;var canvas=this._createCanvasFor(this.element);this.canvasInstance=canvas;var container=this._createContainerFor(this.element);if(this.containerInstance=container,this.element.parentNode.insertBefore(container,this.element),container.appendChild(canvas),this.options.alwaysOn)for(var i=0;i<map.areas.length;i++)this._drawHighlightByArea(canvas,map.areas[i]);else map.addEventListener("mouseover",(function(event){_this._clearHighlights(canvas),_this._drawHighlightByArea(canvas,event.target)})),map.addEventListener("mouseout",(function(event){_this._clearHighlights(canvas)}))}},{key:"_getDefaultOptions",value:function(){return{fill:!0,fillColor:"000000",fillOpacity:.2,stroke:!0,strokeColor:"ff0000",strokeOpacity:1,strokeWidth:1,alwaysOn:!1}}},{key:"_createContainerFor",value:function(element){var container=document.createElement("div");return container.classList.add("map-container"),container.style.backgroundImage="url("+element.src+")",container.style.height=element.height+"px",container.style.width=element.width+"px",container}},{key:"_createCanvasFor",value:function(element){var canvas=document.createElement("canvas");return canvas.height=element.height,canvas.width=element.width,canvas}},{key:"_getAssociatedMap",value:function(element){if(!element.useMap)throw new Error('The "useMap" attribute for this image element has not been set.');var map=document.querySelector("map[name="+element.useMap.substr(1)+"]");if(null===map)throw new Error('The requested map "'+element.useMap+'" could not be found.');return map}},{key:"_clearHighlights",value:function(canvas){canvas.getContext("2d").clearRect(0,0,canvas.width,canvas.height)}},{key:"_drawHighlightByArea",value:function(canvas,area){var coords=area.coords.split(",").map((function(coord){return parseInt(coord)})),shape=area.shape;this.options.disabledAttributeName&&"true"===area.getAttribute(this.options.disabledAttributeName)?this._drawHighlightDisabled(canvas,shape,coords):this._drawHighlight(canvas,shape,coords)}},{key:"_drawHighlight",value:function(canvas,shape,coords){var context=canvas.getContext("2d");switch(context.beginPath(),shape){case"circle":context.arc(coords[0],coords[1],coords[2],0,2*Math.PI,!1);break;case"poly":context.moveTo(coords[0],coords[1]);for(var i=2;i<coords.length;i+=2)context.lineTo(coords[i],coords[i+1]);break;case"rect":context.rect(coords[0],coords[1],coords[2]-coords[0],coords[3]-coords[1])}context.closePath(),this.options.fill&&(context.fillStyle=this.css3Colour(this.options.fillColor,this.options.fillOpacity),context.fill()),this.options.stroke&&(context.strokeStyle=this.css3Colour(this.options.strokeColor,this.options.strokeOpacity),context.lineWidth=this.options.strokeWidth),context.stroke(),context.globalCompositeOperation="destination-over"}},{key:"_drawHighlightDisabled",value:function(canvas,shape,coords){var context=canvas.getContext("2d");switch(context.beginPath(),shape){case"circle":context.arc(coords[0],coords[1],coords[2],0,2*Math.PI,!1);break;case"poly":context.moveTo(coords[0],coords[1]);for(var i=2;i<coords.length;i+=2)context.lineTo(coords[i],coords[i+1]);break;case"rect":context.rect(coords[0],coords[1],coords[2]-coords[0],coords[3]-coords[1])}context.closePath(),this.options.fill&&(context.fillStyle=this.css3Colour(this.options.fillColorDisabled,this.options.fillOpacityDisabled),context.fill()),this.options.stroke&&(context.strokeStyle=this.css3Colour(this.options.strokeColorDisabled,this.options.strokeOpacityDisabled),context.lineWidth=this.options.strokeWidth),context.stroke(),context.globalCompositeOperation="destination-over"}},{key:"reDrawCanvas",value:function(){if(console.log("reDrawCanvas"),this.containerInstance.style.height=this.element.height+"px",this.containerInstance.style.width=this.element.width+"px",this.canvasInstance.height=this.element.height,this.canvasInstance.width=this.element.width,this.options.alwaysOn)for(var i=0;i<this.mapInstance.areas.length;i++)this._drawHighlightByArea(this.canvasInstance,this.mapInstance.areas[i])}},{key:"destroy",value:function(){this.element.parentNode.removeChild(this.containerInstance)}},{key:"hexToDecimal",value:function(hex){return Math.max(0,Math.min(parseInt(hex,16),255))}},{key:"css3Colour",value:function(colour,opacity){return"rgba("+ +this.hexToDecimal(colour.substr(0,2))+", "+ +this.hexToDecimal(colour.substr(2,2))+", "+ +this.hexToDecimal(colour.substr(4,2))+", "+opacity+")"}}]),ImageMapHighlighter}();module.exports=ImageMapHighlighter}])},module.exports=factory()}}]);